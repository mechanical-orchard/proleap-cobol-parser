000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    SUKCS761.                                         00040001
000500 AUTHOR.        LYNN MCADAMS.                                     00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  AUGUST, 2003.                                     00070001
000800 DATE-COMPILED.                                                   00080001
000900                                                                  00090001
001000*---------------------------------------------------------------* 00100001
001100*    S761 - LISTING OF UNRESOLVED FREE-ASTRAYS.                 * 00110001
001200*                                                               * 00120001
001300*    THIS PROGRAM GENERATES A LIST OF UNRESOLVED FREE-ASTRAYS   * 00130001
001400*    FOR A GIVEN DC, BASED ON THE SCAC/TRAILER, TRIP, OR        * 00140001
001500*    PO/RECEIVER NUMBER THAT WAS SELECTED FROM THE PREVIOUS     * 00150001
001600*    LIST SCREEN OR THE CRIT SPEC SCREEN.                       * 00160001
001700*                                                               * 00170001
001400*----------------------------------------------------------------*00181099
001500*    CHANGES                                                     *00182099
      *    MADE BY: CHERI PARMLEY                                      *00183099
      *    DATE:    09/25/2014                                         *00184099
      *                                                                *00185099
      *    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00186099
      *    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/25/2014      *00187099
      *                                                                *00188099
001600*----------------------------------------------------------------*00189099
273427*    CHANGES                                                     *00189199
273427*    MADE BY: BARB SCHULTZ                CHG0273427             *00189299
273427*    DATE:    08/15/2022                                         *00189399
273427*                                                                *00189499
273427*    CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE *00189599
273427*    MAKING THE CALL DYNAMIC VS STATIC.                          *00189699
273427*                                                                *00189799
001130*                                                                 00189899
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00189999
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00190099
001600*----------------------------------------------------------------*00190199
001900 ENVIRONMENT DIVISION.                                            00191001
002000 DATA DIVISION.                                                   00200001
002100                                                                  00210003
002200 WORKING-STORAGE SECTION.                                         00220003
002300                                                                  00230003
002400 01  DK-DB2-KEYS.                                                 00240003
002500     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00250003
002600                                                    COMP.         00260003
002700     05  DK-FCLTY-ID                    PIC S9(04)  VALUE ZERO    00270003
002800                                                    COMP.         00280003
002900     05  DK-SCAC                        PIC  X(04)  VALUE SPACE.  00290008
003000     05  DK-TRLR-NBR                    PIC  X(10)  VALUE SPACE.  00300008
003100     05  DK-TRIP-ID                     PIC S9(09)  VALUE +0      00310003
003200                                                    COMP.         00320003
003300     05  DK-STATUS-CDE                  PIC  X(02)  VALUE SPACES. 00330003
003400     05  DK-PO-NBR                      PIC S9(09)  COMP.         00340003
003500     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP.         00350003
003600     05  DK-LIST-SEQ-IND                PIC  X(01)  VALUE SPACES. 00360016
003700     05  DK-CURR-DATE                   PIC  X(10)  VALUE SPACES. 00370024
003800     05  DK-FROM-DATE                   PIC  X(10)  VALUE SPACES. 00380063
003900     05  DK-TO-DATE                     PIC  X(10)  VALUE SPACES. 00390063
004000                                                                  00400003
004100 01  PC-PROGRAM-CONSTANTS.                                        00410003
004200     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00420003
004300                                                    'SU761A  '.   00430008
004400     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00440003
004500                                                    'SUKM761 '.   00450003
004600     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00460003
004700                                                    'SUKCS761'.   00470003
005000     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00500003
005100     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00510003
005200     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00520003
005300     05  PC-FROM-RCVGSMPL               PIC  X(01)  VALUE '2'.    00530003
005400     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +11     00540038
005500                                                    COMP SYNC.    00550003
005600     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00560003
005700                                                    COMP SYNC.    00570003
005800     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00580003
005900                                                    +1000000      00590003
006000                                                    COMP-3.       00600003
006100     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00610003
006200                                                    COMP SYNC.    00620003
006300     05  PC-DELETED-STATUS-CDE          PIC  X(02)  VALUE 'DE'.   00630003
006400     05  PC-A                           PIC  X(01)  VALUE  'A'.   00640003
006500     05  PC-D                      PIC  X(01)  VALUE  'D'.        00650099
006600     05  PC-I                           PIC  X(01)  VALUE  'I'.   00660099
006700     05  PC-S                      PIC  X(01)  VALUE  'S'.        00670099
006800     05  PC-U                           PIC  X(01)  VALUE  'U'.   00680003
006900     05  PC-49                          PIC  X(02)  VALUE  '49'.  00690003
007000     05  PC-EN                          PIC  X(02)  VALUE  'EN'.  00700003
007100     05  PC-ET                          PIC  X(02)  VALUE  'ET'.  00710003
007200     05  PC-ONE                         PIC  X(01)  VALUE  '1'.   00720003
007300*                                                                 00730003
007400     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00740003
007500     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00750003
007600     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00760003
007700     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00770003
007800     05  PC-UNKNWN-VND-NME         PIC  X(20)  VALUE              00780003
007900                               'UNKNOWN VENDOR NAME '.            00790003
008000     05  PC-UNKNWN-SEASET-NME      PIC  X(05)  VALUE              00800049
008100                               'UNKWN'.                           00810049
008200*                                                                 00820003
008300     05  PC-INNER-PREPACK          PIC X(01)   VALUE 'I'.         00830012
008400     05  PC-MULTI-SKU              PIC X(01)   VALUE 'M'.         00840012
008500     05  PC-SINGLE-SKU             PIC X(01)   VALUE 'S'.         00850012
008600     05  PC-CASEPACK               PIC X(01)   VALUE 'C'.         00860012
008700     05  PC-BULK                   PIC X(01)   VALUE 'B'.         00870012
008800     05  PC-PBS                    PIC X(01)   VALUE ' '.         00880099
008900     05  PC-FREE-ASTRAY            PIC X(01)   VALUE 'F'.         00890012
009000                                                                  00900003
009100*-----------------------------------------------------------      00910099
009200*  SYSTEM MESSAGES                                                00920099
009300*-----------------------------------------------------------      00930099
009400*   00005 = INVALID VALUE                                         00940099
009500*   00008 = MUST BE NUMERIC                                       00950099
009600*   00050 = NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED   00960099
009700*   00051 = NO END OF RANGE HAS BEEN SPECIFIED                    00970099
009800*   00052 = END OF RANGE PRECEDES START OF RANGE                  00980099
009900*   00053 = NO START OF RANGE HAS BEEN SPECIFIED                  00990099
010000*   00054 = ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED    01000099
010100*   00055 = ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED      01010099
010200*   00057 = A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        01020099
010300*   00069 = TOP OF LIST                                           01030099
010400*   00070 = BOTTOM OF LIST                                        01040099
010500*   00101 = VALUE MUST BE GREATER THAN ZERO AND LESS THAN 100,000,01050099
010600*   00279 = MORE ITEMS TO DISPLAY                                 01060099
010700*   00954 = PO/RECEIVER SEQUENCE NOT FOUND                        01070099
010800*   01803 = UNABLE TO PROCESS PACK-BY-STORE ORDERS                01080099
010900*   02479 = RECEIVER SEQUENCE NUMBER MUST BE GREATER THAN ZERO    01090099
011000*   03218 - TRIP HAS NO TRAILER # - CALL COC - ATTACH RECEIVER TO 01100099
011100*           TRAILER                                               01110099
011200                                                                  01120099
011300     05  PC-TSYMSG-NUMBERS.                                       01130099
011400         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01140003
011500         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01150003
011600         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01160003
011700         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01170003
011800         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01180003
011900         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01190003
012000         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01200003
012100         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01210003
012200         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01220003
012300         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01230003
012400         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01240003
012500         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01250003
012600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01260003
012700         10  PC-TSYMSG-00954            PIC  9(05)  VALUE 00954.  01270003
012800         10  PC-TSYMSG-01803            PIC  9(05)  VALUE 01803.  01280099
012900         10  PC-TSYMSG-02479            PIC  9(05)  VALUE 02479.  01290003
013000         10  PC-TSYMSG-03218            PIC  9(05)  VALUE 03218.  01300099
013100         10  PC-TSYMSG-03228            PIC  9(05)  VALUE 03228.  01310099
013200*                                                                 01320003
013300 01  PS-PROGRAM-SWITCHES.                                         01330003
013400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01340003
013500         88  PS-NO-ERROR                            VALUE 'Y'.    01350003
013600         88  PS-ERROR                               VALUE 'N'.    01360003
013700     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01370003
013800         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01380003
013900         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01390003
014000     05  PS-RECEIVER-EXISTS-SW          PIC  X(01)  VALUE 'Y'.    01400003
014100         88  PS-RECEIVER-EXISTS                     VALUE 'Y'.    01410003
014200         88  PS-RECEIVER-DOESNT-EXIST               VALUE 'N'.    01420003
014300     05  PS-END-OF-RECITM-CSR-SW  PIC  X(01)  VALUE 'N'.          01430003
014400         88  PS-END-OF-RECITM-CSR             VALUE 'Y'.          01440003
014500         88  PS-NOT-END-OF-RECITM-CSR         VALUE 'N'.          01450003
014600     05  PS-LIST-END-SW           PIC  X(01)  VALUE 'N'.          01460003
014700         88  PS-LIST-END                      VALUE 'Y'.          01470003
014800         88  PS-NO-LIST-END                   VALUE 'N'.          01480003
014900     05  PS-BLOCK-ERROR-SW        PIC  X(01)  VALUE 'Y'.          01490003
015000         88  PS-NO-BLOCK-ERROR                VALUE 'Y'.          01500003
015100         88  PS-BLOCK-ERROR                   VALUE 'N'.          01510003
015200     05  PS-FREE-ASTRAY-SW        PIC  X(01)  VALUE 'N'.          01520003
015300         88  PS-FREE-ASTRAY                   VALUE 'Y'.          01530003
015400         88  PS-NO-FREE-ASTRAY                VALUE 'N'.          01540003
015500     05  PS-VERIFIED-RECEIVER-SW  PIC  X(01)  VALUE 'N'.          01550003
015600         88  PS-VERIFIED-RECEIVER             VALUE 'Y'.          01560003
015700         88  PS-NO-VERIFIED-RECEIVER          VALUE 'N'.          01570003
015800     05  PS-NONTRANSCRIBED-SW       PIC X(01) VALUE 'N'.          01580099
015900         88  PS-NONTRANSCRIBED-RCVR           VALUE 'Y'.          01590099
016000         88  PS-TRANSCRIBED-RCVR              VALUE 'N'.          01600099
016100*                                                                 01610003
016200 01  DN-DB2-NULL-INDICATORS.                                      01620003
016300     05  DN-VEH-NBR                 PIC S9(04) COMP VALUE ZEROES. 01630003
016400*                                                                 01640003
016500 01  PV-PROGRAM-VARIABLES.                                        01650003
016600     05  PV-SEL-TERM-ID                  PIC  X(04).              01660003
016700     05  PV-SEL-TASK-NUMBER              PIC  9(05).              01670003
016800     05  PV-SEL-SEQ                      PIC  9(01).              01680003
016900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01690003
017000                                                     COMP SYNC.   01700003
017100     05  PV-SUB                         PIC S9(04)  VALUE +0      01710003
017200                                                    COMP SYNC.    01720003
017300     05  PV-CURRENT-DATE                PIC  9(06).               01730003
017400     05  PV-NUMBER-OF-UPDATES           PIC S9(04)  VALUE +0      01740003
017500                                                    COMP-3.       01750003
017600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01760003
017700                                                    COMP SYNC.    01770003
017800     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01780003
017900                                                    COMP-3.       01790003
018000     05  PV-COUNT                       PIC S9(09)  VALUE +0      01800003
018100                                                    COMP-3.       01810003
018200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01820003
018300                                                    COMP-3.       01830003
018400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01840003
018500                                                    COMP-3.       01850003
018600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01860003
018700                                                    COMP-3.       01870003
018800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01880003
018900                                                    COMP SYNC.    01890003
019000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01900003
019100                                                    COMP SYNC.    01910003
019200     05  PV-ITEM                        PIC S9(04)  VALUE +0      01920003
019300                                                    COMP SYNC.    01930003
019400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01940003
019500                                                    COMP SYNC.    01950003
019600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01960003
019700                                                    COMP SYNC.    01970003
019800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01980003
019900                                                    COMP SYNC.    01990003
020000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02000003
020100                                                    COMP SYNC.    02010003
020200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02020003
020300                                                    COMP SYNC.    02030003
020400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02040003
020500                                                    COMP SYNC.    02050003
020600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02060003
020700                                                    COMP SYNC.    02070003
020800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02080003
020900                                                    COMP SYNC.    02090003
021000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02100003
021100                                                    COMP SYNC.    02110003
021200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02120003
021300                                                    COMP SYNC.    02130003
021400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02140003
021500                                                    COMP SYNC.    02150003
021600     05  PV-DB2-COUNT                   PIC S9(04)  VALUE +0      02160003
021700                                                    COMP SYNC.    02170003
021800     05  PV-DB2-COUNT-ACTL-CTN          PIC S9(04)  VALUE +0      02180003
021900                                                    COMP.         02190003
022000     05  PV-PO-RECEIVER.                                          02200056
      *CLP 09/25/2014                                                   02201099
022100         10  PV-PO-NUMBER               PIC  9(08).               02210099
022200         10  FILLER                     PIC  X(01) VALUE '-'.     02220056
022300         10  PV-REC-SEQ-NBR             PIC  9(03).               02230056
022400     05  PV-TRLR-STATUS                 PIC  X(02).               02240032
022500     05  PV-RCVR-CRE-DATE.                                        02250045
022600         10  PV-CRE-MM                  PIC  9(02).               02260045
022700         10  FILLER                     PIC  X(01) VALUE '/'.     02270045
022800         10  PV-CRE-DD                  PIC  9(02).               02280045
022900                                                                  02290045
023000     05  PV-PACK-TYPE                 PIC X(01).                  02300044
023100         88  PV-PRE-PACK-ORDER            VALUE 'I', 'M'.         02310044
023200         88  PV-INNER-PREPK               VALUE 'I'.              02320044
023300         88  PV-MULTI-SKU-PREPK           VALUE 'M'.              02330044
023400         88  PV-SINGLE-SKU-PREPK          VALUE 'S'.              02340044
023500         88  PV-CASEPACK                  VALUE 'C'.              02350044
023600         88  PV-BULK-PACK                 VALUE 'B'.              02360044
023700         88  PV-PBS                       VALUE ' '.              02370044
023800                                                                  02380003
023900     05  PV-CURR-DATE.                                            02390024
024000         10  PV-CURR-YY                 PIC  X(04)  VALUE SPACES. 02400025
024100         10  PV-CURR-DASH1              PIC  X(01)  VALUE '-'.    02410060
024200         10  PV-CURR-MM                 PIC  X(02)  VALUE SPACES. 02420024
024300         10  PV-CURR-DASH2              PIC  X(01)  VALUE '-'.    02430060
024400         10  PV-CURR-DD                 PIC  X(02)  VALUE SPACES. 02440024
024500     05  PV-FROM-DATE.                                            02450060
024600         10  PV-FROM-YY                 PIC  X(04)  VALUE SPACES. 02460060
024700         10  PV-FROM-DASH1              PIC  X(01)  VALUE '-'.    02470060
024800         10  PV-FROM-MM                 PIC  X(02)  VALUE SPACES. 02480060
024900         10  PV-FROM-DASH2              PIC  X(01)  VALUE '-'.    02490060
025000         10  PV-FROM-DD                 PIC  X(02)  VALUE SPACES. 02500060
025100     05  PV-TO-DATE.                                              02510060
025200         10  PV-TO-YY                   PIC  X(04)  VALUE SPACES. 02520060
025300         10  PV-TO-DASH1                PIC  X(01)  VALUE '-'.    02530060
025400         10  PV-TO-MM                   PIC  X(02)  VALUE SPACES. 02540060
025500         10  PV-TO-DASH2                PIC  X(01)  VALUE '-'.    02550060
025600         10  PV-TO-DD                   PIC  X(02)  VALUE SPACES. 02560060
025700                                                                  02570024
025800*                                                                 02580003
025900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02590003
026000                                                    COMP-3.       02600003
026100     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      02610003
026200                                                    COMP SYNC.    02620003
026300     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       02630003
026400     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       02640003
026500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02650003
026600                                                    COMP-3.       02660003
026700     05  PV-ERROR-MSG.                                            02670001
026800         10  FILLER                     PIC X(4) VALUE 'PO= '.    02680001
026900         10  PV-ERROR-PO                PIC Z(8)9.                02690001
027000         10  FILLER                     PIC X(6) VALUE ' RCVR='.  02700001
027100         10  PV-ERROR-SEQ               PIC Z(8)9.                02710001
027200         10  FILLER                     PIC X(6) VALUE SPACES  .  02720001
027300         10  PV-ERROR-TEXT1             PIC X(20) VALUE SPACES.   02730099
027400         10  FILLER                     PIC X(1) VALUE SPACES.    02740001
027500         10  PV-ERROR-TEXT2             PIC X(20) VALUE SPACES.   02750099
027600         10  FILLER                     PIC X(9) VALUE SPACES.    02760001
027700                                                                  02770001
027800     05  PV-ERROR-MSG2.                                           02780099
027900         10  FILLER                     PIC X(4) VALUE 'PO= '.    02790001
028000         10  PV-ERROR-SCAC              PIC X(4) VALUE SPACES.    02800001
028100         10  FILLER                     PIC X(6) VALUE SPACES.    02810099
028200         10  PV-ERROR-TRLR              PIC Z(9) VALUE SPACES.    02820001
028300         10  FILLER                     PIC X(6) VALUE SPACES.    02830099
028400         10  PV-ERROR-OPER-UNT          PIC X(20) VALUE SPACES.   02840099
028500         10  FILLER                     PIC X(1) VALUE SPACES.    02850001
028600         10  PV-ERROR-MSG2-TEXT1        PIC X(20) VALUE SPACES.   02860099
028700         10  FILLER                     PIC X(9) VALUE SPACES.    02870001
028800                                                                  02880003
028900     05  PV-CICS-MSG-AREA          PIC X(100)  VALUE SPACES.      02890099
029000     05  PV-DISP-OPER              PIC 9(04)   VALUE ZEROES.      02900099
029100     05  PV-DISP-TRIP              PIC 9(09)   VALUE ZEROES.      02910099
      *CLP 09/25/2014                                                   02911099
029200     05  PV-DISP-PO                PIC 9(08)   VALUE ZEROES.      02920099
029300     05  PV-DISP-RCVR              PIC 9(04)   VALUE ZEROES.      02930099
029400                                                                  02940099
029500                                                                  02950003
029600                                                                  02960003
029700******************************************************************02970003
029800**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02980003
029900**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02990003
030000**  APPLICATION-SPECIFIC COMMAREA.                              **03000003
030100******************************************************************03010003
030200 01  LQW-LIST-QUEUE-WORK-AREA.                                    03020003
030300     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03030003
030400     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           03040038
030500                                        INDEXED BY LQW-IDX.       03050003
030600         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03060003
030700*                                                                 03070003
030800         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03080003
030900         10  LQW-SELECTED-SW            PIC  X(01).               03090003
031000             88  LQW-SELECT                         VALUE 'S'.    03100003
031100             88  LQW-DESELECT                       VALUE ' '.    03110003
031200         10  LQW-ACTION                 PIC  X(03).               03120003
031300         10  LQW-SCAC                   PIC  X(04).               03130009
031400         10  LQW-TRLR-NBR               PIC  X(07).               03140099
031500         10  LQW-TRIP-ID                PIC S9(09)                03150009
031600                                            COMP.                 03160009
031700         10  LQW-TRLR-STATUS            PIC X(02).                03170009
031800             88  LQW-STATUS-AR          VALUE 'AR'.               03180009
031900             88  LQW-STATUS-UG          VALUE 'UG'.               03190009
032000             88  LQW-STATUS-UN          VALUE 'UN'.               03200009
032100             88  LQW-STATUS-EN          VALUE 'EN'.               03210009
032200             88  LQW-STATUS-DP          VALUE 'DP'.               03220009
      *CLP 09/25/2014                                                   03221099
032300         10  LQW-PO-RECEIVER.                                     03230003
032400             15 LQW-PO-NBR              PIC  X(08).               03240099
032500             15 FILLER                  PIC  X(01).               03250003
032600             15 LQW-RECEIVER            PIC  X(03).               03260003
032700         10  LQW-PACK-TYPE              PIC  X(01).               03270009
032800         10  LQW-SEASET-NAME            PIC  X(05).               03280009
032900         10  LQW-VND-NME                PIC  X(14).               03290099
033000         10  LQW-ACTL-CART-COUNT        PIC  9(05).               03300009
033100         10  LQW-CREATE-DATE            PIC  X(05).               03310009
033200         10  LQW-CSR-IND                PIC  X(01).               03320003
033300         10  LQW-RED-IND                PIC  X(01).               03330099
033400                                                                  03340003
033500                                                                  03350099
033600*---------------------------------------------------------------* 03360003
033700*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 03370003
033800*---------------------------------------------------------------* 03380003
033900     COPY SUWS004.                                                03390099
034000     COPY RCWS013.                                                03400003
034100     COPY PCWS237.                                                03410003
034200     COPY RCWS816.                                                03420099
034300                                                                  03430099
034900/                                                                 03490003
035000*----------------------------------------------------------------*03500003
035100*  WORK AREA PASSED IN CALL TO DPKUT500                          *03510003
035200*----------------------------------------------------------------*03520003
035300     COPY DPWS500.                                                03530003
035400                                                                  03540003
035500*---------------------------------------------------------------* 03550003
035600*    MAP LAYOUT                                                 * 03560003
035700*---------------------------------------------------------------* 03570003
035800                                                                  03580003
035900     COPY SUKM761.                                                03590003
036000*                                                                 03600003
036100 01  MR-OCCURS-LAYOUT                   REDEFINES  SU761AO.       03610010
036200     05  FILLER                         PIC X(91).                03620039
036300     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          03630038
036400         10  MR-SELECTL                 PIC S9(04) COMP.          03640003
036500         10  MR-SELECTA                 PIC  X(01).               03650003
036600         10  MR-SELECTC                 PIC  X(01).               03660003
036700         10  MR-SELECTH                 PIC  X(01).               03670003
036800         10  MR-SELECTI                 PIC  X(01).               03680003
036900                                                                  03690003
037000         10  MR-ACTIONL                 PIC S9(04) COMP.          03700003
037100         10  MR-ACTIONA                 PIC  X(01).               03710003
037200         10  MR-ACTIONC                 PIC  X(01).               03720003
037300         10  MR-ACTIONH                 PIC  X(01).               03730003
037400         10  MR-ACTION                  PIC  X(03).               03740003
037500                                                                  03750003
037600         10  MR-SCACL                   PIC S9(04) COMP.          03760015
037700         10  MR-SCACA                   PIC  X(01).               03770015
037800         10  MR-SCACC                   PIC  X(01).               03780015
037900         10  MR-SCACH                   PIC  X(01).               03790015
038000         10  MR-SCAC                    PIC  X(04).               03800015
038100                                                                  03810005
038200         10  MR-TRLR-NBRL               PIC S9(04) COMP.          03820015
038300         10  MR-TRLR-NBRA               PIC  X(01).               03830015
038400         10  MR-TRLR-NBRC               PIC  X(01).               03840015
038500         10  MR-TRLR-NBRH               PIC  X(01).               03850015
038600         10  MR-TRLR-NBR                PIC  X(07).               03860040
038700                                                                  03870015
038800         10  MR-TRIP-IDL                PIC S9(04) COMP.          03880015
038900         10  MR-TRIP-IDA                PIC  X(01).               03890015
039000         10  MR-TRIP-IDC                PIC  X(01).               03900015
039100         10  MR-TRIP-IDH                PIC  X(01).               03910015
039200         10  MR-TRIP-ID                 PIC  X(09).               03920015
039300                                                                  03930005
039400         10  MR-TRLR-STATUSL            PIC S9(04) COMP.          03940015
039500         10  MR-TRLR-STATUSA            PIC  X(01).               03950015
039600         10  MR-TRLR-STATUSC            PIC  X(01).               03960015
039700         10  MR-TRLR-STATUSH            PIC  X(01).               03970015
039800         10  MR-TRLR-STATUS             PIC  X(02).               03980015
039900                                                                  03990003
040000         10  MR-PO-RCVRL                PIC S9(04) COMP.          04000015
040100         10  MR-PO-RCVRA                PIC  X(01).               04010015
040200         10  MR-PO-RCVRC                PIC  X(01).               04020015
040300         10  MR-PO-RCVRH                PIC  X(01).               04030015
040400         10  MR-PO-RCVR                 PIC  X(13).               04040015
040500                                                                  04050005
040600         10  MR-PACK-TYPEL              PIC S9(04) COMP.          04060015
040700         10  MR-PACK-TYPEA              PIC  X(01).               04070015
040800         10  MR-PACK-TYPEC              PIC  X(01).               04080015
040900         10  MR-PACK-TYPEH              PIC  X(01).               04090015
041000         10  MR-PACK-TYPE               PIC  X(01).               04100015
041100                                                                  04110008
041200         10  MR-SEASET-NAMEL            PIC S9(04) COMP.          04120015
041300         10  MR-SEASET-NAMEA            PIC  X(01).               04130015
041400         10  MR-SEASET-NAMEC            PIC  X(01).               04140015
041500         10  MR-SEASET-NAMEH            PIC  X(01).               04150015
041600         10  MR-SEASET-NAME             PIC  X(05).               04160015
041700                                                                  04170008
041800         10  MR-VND-NMEL                PIC S9(04) COMP.          04180015
041900         10  MR-VND-NMEA                PIC  X(01).               04190015
042000         10  MR-VND-NMEC                PIC  X(01).               04200015
042100         10  MR-VND-NMEH                PIC  X(01).               04210015
042200         10  MR-VND-NME                 PIC  X(14).               04220040
042300                                                                  04230008
042400         10  MR-ACTL-CART-COUNTL        PIC S9(04) COMP.          04240008
042500         10  MR-ACTL-CART-COUNTA        PIC  X(01).               04250008
042600         10  MR-ACTL-CART-COUNTC        PIC  X(01).               04260008
042700         10  MR-ACTL-CART-COUNTH        PIC  X(01).               04270008
042800         10  MR-ACTL-CART-COUNT-X.                                04280008
042900             15 MR-ACTL-CART-COUNT      PIC  ZZZ9.                04290008
043000                                                                  04300008
043100         10  MR-CREATE-DATEL            PIC S9(04) COMP.          04310008
043200         10  MR-CREATE-DATEA            PIC  X(01).               04320008
043300         10  MR-CREATE-DATEC            PIC  X(01).               04330008
043400         10  MR-CREATE-DATEH            PIC  X(01).               04340008
043500         10  MR-CREATE-DATE             PIC  X(05).               04350008
043600                                                                  04360008
043700     05  FILLER                         PIC  X(12).               04370003
043800                                                                  04380003
043900                                                                  04390003
044000*----------------------------------------------------------------*04400003
044100**  SECURITY SUBROUTINE PARAMETERS                                04410003
044200*----------------------------------------------------------------*04420003
044300     COPY DPWS008.                                                04430003
044400*---------------------------------------------------------------* 04440003
044500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04450003
044600*---------------------------------------------------------------* 04460003
044700                                                                  04470003
044800     COPY DPWS015.                                                04480003
044900                                                                  04490003
045000*---------------------------------------------------------------* 04500003
045100*    FUNCTION KEYS COPYBOOK.                                    * 04510003
045200*---------------------------------------------------------------* 04520003
045300                                                                  04530003
045400     COPY DPWS016.                                                04540003
045500                                                                  04550003
045600*---------------------------------------------------------------* 04560003
045700*    NUMERIC EDIT LAYOUT.                                       * 04570003
045800*---------------------------------------------------------------* 04580003
045900                                                                  04590003
046000     COPY DPWS010I.                                               04600003
046100                                                                  04610099
046200*---------------------------------------------------------------* 04620003
046300*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04630099
046400*---------------------------------------------------------------* 04640003
046500                                                                  04650003
046600     COPY DPWS030.                                                04660003
046600     COPY DPWS930.                                                04661099
046700                                                                  04670099
046800*---------------------------------------------------------------* 04680003
046900*    STANDARD COMMAREA.                                         * 04690003
047000*---------------------------------------------------------------* 04700003
047100                                                                  04710003
047200     COPY DPWS020.                                                04720003
047300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04730003
047400                                                                  04740003
047500*---------------------------------------------------------------* 04750003
047600* INTER-APPLICATION COMMAREA.                                   * 04760003
047700*   SUWS046 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04770003
047800*             SPEC SCREEN.                                      * 04780003
047900*   BELOW:  - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM      * 04790099
048000*             THE LIST OF FREE-ASTRAYS SCREEN.                  * 04800097
048100*---------------------------------------------------------------* 04810003
048200                                                                  04820003
048300         10  INTER-APPL-COMM-AREA       PIC X(200).               04830003
048400     COPY SUWS046.                                                04840003
048500     COPY SUWS003.                                                04850009
048600     COPY RCWS015.                                                04860009
048700     COPY RCWS815.                                                04870099
048800     COPY PCWS236.                                                04880009
048900*                                                                 04890009
049000*---------------------------------------------------------------* 04900009
049100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04910009
049200*---------------------------------------------------------------* 04920009
049300         10  ASC-SPECIFIC-COMMAREA.                               04930009
049400             15  ASC-LIST-KEYS.                                   04940009
049500                 20  ASC-OPER-UNT-ID                 PIC S9(04)   04950009
049600                                                           COMP.  04960009
049700                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   04970009
049800                                                           COMP.  04980009
049900                 20  ASC-FCLTY-ID                    PIC S9(04)   04990009
050000                                                           COMP.  05000009
050100                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   05010009
050200                                                           COMP.  05020009
050300                 20  ASC-FCLTY-NME                   PIC  X(25).  05030009
050400                 20  ASC-SCAC-ID                     PIC  X(04).  05040054
050500                 20  ASC-TRLR-NUMBER                 PIC  X(10).  05050054
050600                 20  ASC-TRIP-ID                     PIC S9(09).  05060058
      *CLP 09/25/2014                                                   05061099
050700                 20  ASC-PO-RCVR.                                 05070057
050800                     25  ASC-PO-NUMBER               PIC  9(08).  05080099
050900                     25  FILLER                      PIC  X(01).  05090056
051000                     25  ASC-REC-SEQ-NBR             PIC  9(03).  05100055
051100                 20  ASC-LIST-SEQ-IND                PIC  X(01).  05110093
051200                     88  ASC-SCAC-TRLR-SEQ           VALUE 'S'.   05120093
051300                     88  ASC-DATE-ASC-SEQ            VALUE 'A'.   05130093
051400                     88  ASC-DATE-DES-SEQ            VALUE 'D'.   05140093
051500                 20  ASC-CURR-DATE.                               05150053
051600                     25  ASC-CURR-YY                 PIC  X(04).  05160053
051700                     25  FILLER                      PIC  X(01).  05170099
051800                     25  ASC-CURR-MM                 PIC  X(02).  05180053
051900                     25  FILLER                      PIC  X(01).  05190099
052000                     25  ASC-CURR-DD                 PIC  X(02).  05200053
052100                 20  ASC-FROM-DATE.                               05210060
052200                     25  ASC-FROM-YY        PIC  X(04).           05220099
052300                     25  FILLER             PIC  X(01).           05230099
052400                     25  ASC-FROM-MM        PIC  X(02).           05240099
052500                     25  FILLER             PIC  X(01).           05250099
052600                     25  ASC-FROM-DD        PIC  X(02).           05260099
052700                 20  ASC-TO-DATE.                                 05270060
052800                     25  ASC-TO-YY           PIC  X(04).          05280099
052900                     25  FILLER              PIC  X(01).          05290099
053000                     25  ASC-TO-MM           PIC  X(02).          05300099
053100                     25  FILLER              PIC  X(01).          05310099
053200                     25  ASC-TO-DD           PIC  X(02).          05320099
053300                 20  ASC-DATE-SELECTED       PIC  X(01).          05330099
053400                                                                  05340009
053500             15  ASC-BLK-SUB                         PIC S9(04)   05350009
053600                                                    COMP  SYNC.   05360099
053700             15  ASC-ITEM-SUB                        PIC S9(04)   05370009
053800                                                     COMP SYNC.   05380099
053900             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05390009
054000                                                          COMP-3. 05400009
054100             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05410009
054200                                                          COMP-3. 05420009
054300             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05430009
054400                                                          COMP-3. 05440009
054500             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05450009
054600                                                          COMP-3. 05460009
054700             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05470009
054800                                                          COMP-3. 05480009
054900             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05490009
055000                                                          COMP    05500009
055100                                                          SYNC.   05510009
055200             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   05520009
055300                                                          COMP-3. 05530009
055400             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   05540009
055500                                                          COMP-3. 05550009
055600             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05560009
055700                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05570009
055800                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05580009
055900             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05590009
056000                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05600009
056100                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05610009
056200             15  ASC-LIST-QUEUE-NAME.                             05620009
056300                 20  ASC-LIST-TERM-ID                PIC  X(04).  05630009
056400                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05640009
056500                                                          COMP-3. 05650009
056600                 20  ASC-LIST-SEQ                    PIC  9(01).  05660009
056700             15  ASC-SEL-QUEUE-NAME.                              05670009
056800                 20  ASC-SEL-TERM-ID          PIC  X(04).         05680009
056900                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05690009
057000                 20  ASC-SEL-SEQ              PIC  9(01).         05700009
057100             15  ASC-SEL-QUEUE-NAME-IN.                           05710009
057200                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         05720009
057300                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  05730009
057400                 20  ASC-SEL-SEQ-IN           PIC  9(01).         05740009
057500                                                                  05750009
057600             15  ASC-START-ITEM-REQUEST.                          05760009
057700                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  05770009
057800*                                                                 05780009
057900             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05790009
058000             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05800009
058100             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05810009
058200                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05820009
058300             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05830009
058400                                                                  05840099
058500*THERE ARE 3 VERSIONS OF EACH CURSOR BECAUSE THE ASSOCIATES ARE   05850099
058600*ABLE TO CHOOSE THE ORDER THEY WANT THE INFORMATION TO APPEAR:    05860099
058700*BY SCAC/TRLR ('S')                                               05870099
058800*ASCENDING DATE ('A')                                             05880099
058900*DESCENDING DATE ('D')                                            05890099
059000             15  ASC-CURSOR-SW                PIC  X(02).         05900052
059100                 88  ASC-NO-CURSOR                   VALUE 'Z '.  05910052
059200                                                                  05920099
059300                 88  ASC-CURR-DTE-S-CSR              VALUE 'A '.  05930099
059400                 88  ASC-CURR-DTE-A-CSR              VALUE 'B '.  05940099
059500                 88  ASC-CURR-DTE-D-CSR              VALUE 'C '.  05950099
059600***                                                               05960099
059700                 88  ASC-DATE-RNGE-S-CSR             VALUE 'D '.  05970099
059800                 88  ASC-DATE-RNGE-A-CSR             VALUE 'E '.  05980099
059900                 88  ASC-DATE-RNGE-D-CSR             VALUE 'F '.  05990099
060000***                                                               06000099
060100                 88  ASC-SCAC-TRLR-S-CSR             VALUE 'G '.  06010099
060200                 88  ASC-SCAC-TRLR-A-CSR             VALUE 'H '.  06020099
060300                 88  ASC-SCAC-TRLR-D-CSR             VALUE 'I '.  06030099
060400***                                                               06040099
060500                 88  ASC-TRIP-ID-S-CSR               VALUE 'J '.  06050099
060600                 88  ASC-TRIP-ID-A-CSR               VALUE 'K '.  06060099
060700                 88  ASC-TRIP-ID-D-CSR               VALUE 'L '.  06070099
060800***                                                               06080099
060900                 88  ASC-PO-CURR-DTE-S-CSR           VALUE 'M '.  06090099
061000                 88  ASC-PO-CURR-DTE-A-CSR           VALUE 'N '.  06100099
061100                 88  ASC-PO-CURR-DTE-D-CSR           VALUE 'O '.  06110099
061200***                                                               06120099
061300                 88  ASC-PO-DTE-RNGE-S-CSR           VALUE 'P '.  06130099
061400                 88  ASC-PO-DTE-RNGE-A-CSR           VALUE 'Q '.  06140099
061500                 88  ASC-PO-DTE-RNGE-D-CSR           VALUE 'R '.  06150099
061600***                                                               06160099
061700                 88  ASC-PO-RCVR-S-CSR               VALUE 'S '.  06170099
061800                 88  ASC-PO-RCVR-A-CSR               VALUE 'T '.  06180099
061900                 88  ASC-PO-RCVR-D-CSR               VALUE 'U '.  06190099
062000***                                                               06200099
062100             15  ASC-LIST-VALID-ENTRY        PIC  X(01).          06210099
062200                 88  ASC-LIST-SEQ-VALID      VALUE 'X'.           06220099
062300                 88  ASC-LIST-SEQ-NOT-VALID  VALUE 'Y'.           06230099
062400                                                                  06240099
062500             15  ASC-FUNC01-RETURN-FLAG       PIC  X(1).          06250099
062600                 88  ASC-FUNC01-RETURN-NO   VALUE 'N'.            06260099
062700                 88  ASC-FUNC01-RETURN-YES  VALUE 'Y'.            06270099
062800                                                                  06280099
062900             15  ASC-FUNC02-RETURN-FLAG       PIC  X(1).          06290099
063000                 88  ASC-FUNC02-RETURN-NO   VALUE 'N'.            06300099
063100                 88  ASC-FUNC02-RETURN-YES  VALUE 'Y'.            06310099
063200                                                                  06320099
063300             15  ASC-FUNC03-RETURN-FLAG       PIC  X(1).          06330099
063400                 88  ASC-FUNC03-RETURN-NO   VALUE 'N'.            06340099
063500                 88  ASC-FUNC03-RETURN-YES  VALUE 'Y'.            06350099
063600                                                                  06360099
063700             15  ASC-FUNC04-RETURN-FLAG       PIC  X(1).          06370099
063800                 88  ASC-FUNC04-RETURN-NO   VALUE 'N'.            06380099
063900                 88  ASC-FUNC04-RETURN-YES  VALUE 'Y'.            06390099
064000                                                                  06400099
064100             15  ASC-FUNC05-RETURN-FLAG       PIC  X(1).          06410099
064200                 88  ASC-FUNC05-RETURN-NO   VALUE 'N'.            06420099
064300                 88  ASC-FUNC05-RETURN-YES  VALUE 'Y'.            06430099
064400                                                                  06440099
064500             15  ASC-FUNC06-RETURN-FLAG       PIC  X(1).          06450099
064600                 88  ASC-FUNC06-RETURN-NO   VALUE 'N'.            06460099
064700                 88  ASC-FUNC06-RETURN-YES  VALUE 'Y'.            06470099
064800                                                                  06480099
064900             15  ASC-FUNC07-RETURN-FLAG       PIC  X(1).          06490099
065000                 88  ASC-FUNC07-RETURN-NO   VALUE 'N'.            06500099
065100                 88  ASC-FUNC07-RETURN-YES  VALUE 'Y'.            06510099
065200                                                                  06520099
065300             15  ASC-FUNC08-RETURN-FLAG       PIC  X(1).          06530099
065400                 88  ASC-FUNC08-RETURN-NO   VALUE 'N'.            06540099
065500                 88  ASC-FUNC08-RETURN-YES  VALUE 'Y'.            06550099
065600                                                                  06560099
065700             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06570099
065800                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06580099
065900                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06590099
066000                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06600099
066100                                                                  06610099
066200                 20  ASC-ITEM-ARRAY.                              06620099
066300                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        06630099
066400                         30  ASC-LIST-ITEM-NUMBER                 06640099
066500                                                     PIC S9(09)   06650099
066600                                                     COMP-3.      06660099
066700                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06670099
066800                             88  ASC-VALID-SELECT    VALUE ' '    06680099
066900                                                           'S'    06690099
067000                                                           'B'    06700099
067100                                                           'E'.   06710099
067200                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06720099
067300                             88  ASC-TEMP-SELECT     VALUE 'S'.   06730099
067400                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06740099
067500                             88  ASC-TEMP-END        VALUE 'E'.   06750099
067600                         30  ASC-SELECTED-SW         PIC  X(01).  06760099
067700                             88  ASC-NO-SELECT       VALUE ' '.   06770099
067800                             88  ASC-SELECT          VALUE 'S'.   06780099
067900                             88  ASC-BEGIN           VALUE 'B'.   06790099
068000                             88  ASC-END             VALUE 'E'.   06800099
068100                         30  ASC-ACTION             PIC  X(03).   06810099
068200                         30  ASC-SCAC               PIC  X(04).   06820099
068300                         30  ASC-TRLR-NBR           PIC  X(07).   06830099
068400                         30  ASC-TRIP               PIC S9(09)    06840099
068500                                                        COMP.     06850099
068600                         30  ASC-TRLR-LN-STATUS     PIC X(02).    06860099
068700                             88  ASC-LN-STATUS-AR   VALUE 'AR'.   06870099
068800                             88  ASC-LN-STATUS-UG   VALUE 'UG'.   06880099
068900                             88  ASC-LN-STATUS-UN   VALUE 'UN'.   06890099
069000                             88  ASC-LN-STATUS-EN   VALUE 'EN'.   06900099
069100                             88  ASC-LN-STATUS-DP   VALUE 'DP'.   06910099
069200                         30  ASC-PO-RECEIVER.                     06920099
      *CLP 09/25/2014                                                   06921099
069300                             35 ASC-PO-NBR          PIC  X(08).   06930099
069400                             35 FILLER              PIC  X(01).   06940099
069500                             35 ASC-RECEIVER        PIC  X(03).   06950099
069600                         30  ASC-PACK-TYPE          PIC  X(01).   06960099
069700                         30  ASC-SEASET-NAME        PIC  X(05).   06970099
069800                         30  ASC-VND-NME            PIC  X(14).   06980099
069900                         30  ASC-ACTL-CART-COUNT    PIC  9(05).   06990099
070000                         30  ASC-CREATE-DATE        PIC  X(05).   07000099
070100                         30  ASC-CSR-IND            PIC  X(01).   07010099
070200                         30  ASC-RED-IND            PIC  X(01).   07020099
070300                                                                  07030099
070400*---------------------------------------------------------------* 07040099
070500*    ABEND PROCESSING COPYBOOK.                                 * 07050099
070600*---------------------------------------------------------------* 07060099
070700     COPY DPWS013.                                                07070099
070800                                                                  07080099
070900*----------------------------------------------------------------*07090099
071000*    DB2 DCLGEN FOR THE PURCHASE ORDER  TABLE                     07100099
071100*----------------------------------------------------------------*07110099
071200     EXEC SQL                                                     07120099
071300          INCLUDE TPURCHS                                         07130099
071400     END-EXEC.                                                    07140099
071500                                                                  07150099
071600*----------------------------------------------------------------*07160099
071700*    DB2 DCLGEN FOR THE EXTERNAL ENTITY NAME TABLE                07170099
071800*----------------------------------------------------------------*07180099
071900     EXEC SQL                                                     07190099
072000          INCLUDE TENTNME                                         07200099
072100     END-EXEC.                                                    07210099
072200                                                                  07220099
072300*---------------------------------------------------------------* 07230099
072400*    DB2 AREA FOR SHIPMENT TABLE                                * 07240099
072500*---------------------------------------------------------------* 07250099
072600     EXEC SQL                                                     07260099
072700          INCLUDE TSHIPMT                                         07270099
072800     END-EXEC.                                                    07280099
072900*---------------------------------------------------------------* 07290099
073000*    DB2 AREA FOR SHIPMENT PO TABLE                             * 07300099
073100*---------------------------------------------------------------* 07310099
073200     EXEC SQL                                                     07320099
073300          INCLUDE TSHPTPO                                         07330099
073400     END-EXEC.                                                    07340099
073500*---------------------------------------------------------------* 07350099
073600*    DB2 AREA FOR TRIP STATUS TABLE                             * 07360099
073700*---------------------------------------------------------------* 07370099
073800     EXEC SQL                                                     07380099
073900          INCLUDE TTRSTYP                                         07390099
074000     END-EXEC.                                                    07400099
074100*---------------------------------------------------------------* 07410099
074200*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 07420099
074300*---------------------------------------------------------------* 07430099
074400     EXEC SQL                                                     07440099
074500          INCLUDE TVHTRIP                                         07450099
074600     END-EXEC.                                                    07460099
074700*---------------------------------------------------------------* 07470099
074800*    DB2 AREA FOR RECEIVER TABLE                                * 07480099
074900*---------------------------------------------------------------* 07490099
075000     EXEC SQL                                                     07500099
075100          INCLUDE TRECEIV                                         07510099
075200     END-EXEC.                                                    07520099
075300*---------------------------------------------------------------* 07530099
075400*    DB2 AREA FOR TRIP STATUS TABLE                             * 07540099
075500*---------------------------------------------------------------* 07550099
075600     EXEC SQL                                                     07560099
075700          INCLUDE TTRIPST                                         07570099
075800     END-EXEC.                                                    07580099
075900*---------------------------------------------------------------* 07590099
076000*    DB2 AREA FOR SU-INBOUND EDI PACKLIST/VENDOR SHIPMENT         07600099
076100*    UNIT ASSOCIATION TABLE                                       07610099
076200*---------------------------------------------------------------* 07620099
076300     EXEC SQL                                                     07630099
076400          INCLUDE TINPKSU                                         07640099
076500     END-EXEC.                                                    07650099
076600*---------------------------------------------------------------* 07660099
076700*    DB2 AREA FOR THE PACKSLIP TABLE                            * 07670099
076800*---------------------------------------------------------------* 07680099
076900     EXEC SQL                                                     07690099
077000          INCLUDE TPKSLIP                                         07700099
077100     END-EXEC.                                                    07710099
077200*---------------------------------------------------------------* 07720099
077300*    DB2 AREA FOR THE SHIP UNIT TABLE                           * 07730099
077400*---------------------------------------------------------------* 07740099
077500     EXEC SQL                                                     07750099
077600          INCLUDE TSHUNLO                                         07760099
077700     END-EXEC.                                                    07770099
077800*-----------------------------------------------------------------07780099
077900*  PARM TABLE                                                     07790099
078000*-----------------------------------------------------------------07800099
078100     EXEC SQL                                                     07810099
078200          INCLUDE TKRPRPM                                         07820099
078300     END-EXEC.                                                    07830099
078400                                                                  07840099
078500*-----------------------------------------------------------------07850099
078600*  TROUBLE TABLE                                                  07860099
078700*-----------------------------------------------------------------07870099
078800     EXEC SQL                                                     07880099
078900          INCLUDE TTRBNTF                                         07890099
079000     END-EXEC.                                                    07900099
079100                                                                  07910099
079200*-----------------------------------------------------------------07920099
079300*  TROUBLE REASON TABLE                                           07930099
079400*-----------------------------------------------------------------07940099
079500     EXEC SQL                                                     07950099
079600          INCLUDE TTRBRSN                                         07960099
079700     END-EXEC.                                                    07970099
079800                                                                  07980099
079900*---------------------------------------------------------------* 07990099
080000*    DB2 AREA FOR COMMUNICATIONS                                * 08000099
080100*---------------------------------------------------------------* 08010099
080200     EXEC SQL                                                     08020099
080300          INCLUDE SQLCA                                           08030099
080400     END-EXEC.                                                    08040099
080500                                                                  08050099
080600******************************************************************08060099
080700*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         08070099
080800*  WITH OPER ID AND CURRENT DATE -                                08080099
080900*  WILL BRING BACK LIST OF RECEIVERS.                             08090099
081000*  ORDER BY SCAC/TRLR                                             08100099
081100******************************************************************08110099
081200     EXEC SQL                                                     08120099
081300          DECLARE CURR-DTE-S-CSR CURSOR FOR                       08130099
081400       SELECT A.TRIP_ID                                           08140099
081500             ,A.OWNER_SCAC_ID                                     08150099
081600             ,A.VEH_NBR                                           08160099
081700             ,B.SHIPT_ID                                          08170099
081800             ,D.ORD_NBR                                           08180099
081900             ,D.REC_SEQ_NBR                                       08190099
082000             ,D.CRE_TMST                                          08200099
082100             ,D.PKGNG_CDE                                         08210099
082200         FROM TVHTRIP A                                           08220099
082300             ,TSHIPMT B                                           08230099
082400             ,TSHPTPO C                                           08240099
082500             ,TRECEIV D                                           08250099
082600        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                08260099
082700          AND A.TRIP_ID          = B.TRIP_ID                      08270099
082800          AND B.SHIPT_ID         = C.SHIPT_ID                     08280099
082900          AND C.PRIM_SHIPT_IND   = 'Y'                            08290099
083000          AND C.PO_NBR           = D.ORD_NBR                      08300099
083100          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  08310099
083200          AND D.FRE_ASTRA_IND    = 'Y'                            08320099
083300          AND D.STATUS_CDE       <> 'VE'                          08330099
083400          AND DATE(D.CRE_TMST)   = :DK-CURR-DATE                  08340099
083500          ORDER BY A.OWNER_SCAC_ID                                08350099
083600                  ,A.VEH_NBR                                      08360099
083700     WITH UR                                                      08370099
083800     END-EXEC.                                                    08380099
083900                                                                  08390099
084000******************************************************************08400099
084100*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         08410099
084200*  WITH OPER ID AND CURRENT DATE -                                08420099
084300*  WILL BRING BACK LIST OF RECEIVERS.                             08430099
084400*  ORDER BY ASCENDING DATE (CRE TMST)                             08440099
084500******************************************************************08450099
084600                                                                  08460099
084700     EXEC SQL                                                     08470099
084800          DECLARE CURR-DTE-A-CSR CURSOR FOR                       08480099
084900       SELECT A.TRIP_ID                                           08490099
085000             ,A.OWNER_SCAC_ID                                     08500099
085100             ,A.VEH_NBR                                           08510099
085200             ,B.SHIPT_ID                                          08520099
085300             ,D.ORD_NBR                                           08530099
085400             ,D.REC_SEQ_NBR                                       08540099
085500             ,D.CRE_TMST                                          08550099
085600             ,D.PKGNG_CDE                                         08560099
085700         FROM TVHTRIP A                                           08570099
085800             ,TSHIPMT B                                           08580099
085900             ,TSHPTPO C                                           08590099
086000             ,TRECEIV D                                           08600099
086100        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                08610099
086200          AND A.TRIP_ID          = B.TRIP_ID                      08620099
086300          AND B.SHIPT_ID         = C.SHIPT_ID                     08630099
086400          AND C.PRIM_SHIPT_IND   = 'Y'                            08640099
086500          AND C.PO_NBR           = D.ORD_NBR                      08650099
086600          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  08660099
086700          AND D.FRE_ASTRA_IND    = 'Y'                            08670099
086800          AND D.STATUS_CDE       <> 'VE'                          08680099
086900          AND DATE(D.CRE_TMST)   = :DK-CURR-DATE                  08690099
087000          ORDER BY D.CRE_TMST ASC                                 08700099
087100     WITH UR                                                      08710099
087200     END-EXEC.                                                    08720099
087300                                                                  08730099
087400******************************************************************08740099
087500*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         08750099
087600*  WITH OPER ID AND CURRENT DATE -                                08760099
087700*  WILL BRING BACK LIST OF RECEIVERS.                             08770099
087800*  ORDER BY DESCENDING DATE (CRE TMST)                            08780099
087900******************************************************************08790099
088000                                                                  08800099
088100     EXEC SQL                                                     08810099
088200          DECLARE CURR-DTE-D-CSR CURSOR FOR                       08820099
088300       SELECT A.TRIP_ID                                           08830099
088400             ,A.OWNER_SCAC_ID                                     08840099
088500             ,A.VEH_NBR                                           08850099
088600             ,B.SHIPT_ID                                          08860099
088700             ,D.ORD_NBR                                           08870099
088800             ,D.REC_SEQ_NBR                                       08880099
088900             ,D.CRE_TMST                                          08890099
089000             ,D.PKGNG_CDE                                         08900099
089100         FROM TVHTRIP A                                           08910099
089200             ,TSHIPMT B                                           08920099
089300             ,TSHPTPO C                                           08930099
089400             ,TRECEIV D                                           08940099
089500        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                08950099
089600          AND A.TRIP_ID          = B.TRIP_ID                      08960099
089700          AND B.SHIPT_ID         = C.SHIPT_ID                     08970099
089800          AND C.PRIM_SHIPT_IND   = 'Y'                            08980099
089900          AND C.PO_NBR           = D.ORD_NBR                      08990099
090000          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  09000099
090100          AND D.FRE_ASTRA_IND    = 'Y'                            09010099
090200          AND D.STATUS_CDE       <> 'VE'                          09020099
090300          AND DATE(D.CRE_TMST)   = :DK-CURR-DATE                  09030099
090400          ORDER BY D.CRE_TMST DESC                                09040099
090500     WITH UR                                                      09050099
090600     END-EXEC.                                                    09060099
090700                                                                  09070099
090800******************************************************************09080099
090900*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         09090099
091000*  WITH OPER ID AND DATE RANGE -                                  09100099
091100*  WILL BRING BACK LIST OF RECEIVERS.                             09110099
091200*  ORDER BY SCAC/TRLR                                             09120099
091300******************************************************************09130099
091400                                                                  09140099
091500     EXEC SQL                                                     09150099
091600          DECLARE DATE-RNGE-S-CSR CURSOR FOR                      09160099
091700       SELECT A.TRIP_ID                                           09170099
091800             ,A.OWNER_SCAC_ID                                     09180099
091900             ,A.VEH_NBR                                           09190099
092000             ,B.SHIPT_ID                                          09200099
092100             ,D.ORD_NBR                                           09210099
092200             ,D.REC_SEQ_NBR                                       09220099
092300             ,D.CRE_TMST                                          09230099
092400             ,D.PKGNG_CDE                                         09240099
092500         FROM TVHTRIP A                                           09250099
092600             ,TSHIPMT B                                           09260099
092700             ,TSHPTPO C                                           09270099
092800             ,TRECEIV D                                           09280099
092900        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                09290099
093000          AND A.TRIP_ID          = B.TRIP_ID                      09300099
093100          AND B.SHIPT_ID         = C.SHIPT_ID                     09310099
093200          AND C.PRIM_SHIPT_IND   = 'Y'                            09320099
093300          AND C.PO_NBR           = D.ORD_NBR                      09330099
093400          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  09340099
093500          AND D.FRE_ASTRA_IND    = 'Y'                            09350099
093600          AND D.STATUS_CDE       <> 'VE'                          09360099
093700          AND DATE(D.CRE_TMST)   >= :DK-FROM-DATE                 09370099
093800          AND DATE(D.CRE_TMST)   <= :DK-TO-DATE                   09380099
093900          ORDER BY A.OWNER_SCAC_ID                                09390099
094000                  ,A.VEH_NBR                                      09400099
094100     WITH UR                                                      09410099
094200     END-EXEC.                                                    09420099
094300                                                                  09430099
094400******************************************************************09440099
094500*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         09450099
094600*  WITH OPER ID AND DATE RANGE -                                  09460099
094700*  WILL BRING BACK LIST OF RECEIVERS.                             09470099
094800*  ORDER BY ASCENDING DATE (CRE TMST)                             09480099
094900******************************************************************09490099
095000                                                                  09500099
095100     EXEC SQL                                                     09510099
095200          DECLARE DATE-RNGE-A-CSR CURSOR FOR                      09520099
095300       SELECT A.TRIP_ID                                           09530099
095400             ,A.OWNER_SCAC_ID                                     09540099
095500             ,A.VEH_NBR                                           09550099
095600             ,B.SHIPT_ID                                          09560099
095700             ,D.ORD_NBR                                           09570099
095800             ,D.REC_SEQ_NBR                                       09580099
095900             ,D.CRE_TMST                                          09590099
096000             ,D.PKGNG_CDE                                         09600099
096100         FROM TVHTRIP A                                           09610099
096200             ,TSHIPMT B                                           09620099
096300             ,TSHPTPO C                                           09630099
096400             ,TRECEIV D                                           09640099
096500        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                09650099
096600          AND A.TRIP_ID          = B.TRIP_ID                      09660099
096700          AND B.SHIPT_ID         = C.SHIPT_ID                     09670099
096800          AND C.PRIM_SHIPT_IND   = 'Y'                            09680099
096900          AND C.PO_NBR           = D.ORD_NBR                      09690099
097000          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  09700099
097100          AND D.FRE_ASTRA_IND    = 'Y'                            09710099
097200          AND D.STATUS_CDE       <> 'VE'                          09720099
097300          AND DATE(D.CRE_TMST)   >= :DK-FROM-DATE                 09730099
097400          AND DATE(D.CRE_TMST)   <= :DK-TO-DATE                   09740099
097500          ORDER BY D.CRE_TMST ASC                                 09750099
097600     WITH UR                                                      09760099
097700     END-EXEC.                                                    09770099
097800                                                                  09780099
097900******************************************************************09790099
098000*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         09800099
098100*  WITH OPER ID AND DATE RANGE -                                  09810099
098200*  WILL BRING BACK LIST OF RECEIVERS.                             09820099
098300*  ORDER BY DESCENDING DATE (CRE TMST)                            09830099
098400******************************************************************09840099
098500                                                                  09850099
098600     EXEC SQL                                                     09860099
098700          DECLARE DATE-RNGE-D-CSR CURSOR FOR                      09870099
098800       SELECT A.TRIP_ID                                           09880099
098900             ,A.OWNER_SCAC_ID                                     09890099
099000             ,A.VEH_NBR                                           09900099
099100             ,B.SHIPT_ID                                          09910099
099200             ,D.ORD_NBR                                           09920099
099300             ,D.REC_SEQ_NBR                                       09930099
099400             ,D.CRE_TMST                                          09940099
099500             ,D.PKGNG_CDE                                         09950099
099600         FROM TVHTRIP A                                           09960099
099700             ,TSHIPMT B                                           09970099
099800             ,TSHPTPO C                                           09980099
099900             ,TRECEIV D                                           09990099
100000        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                10000099
100100          AND A.TRIP_ID          = B.TRIP_ID                      10010099
100200          AND B.SHIPT_ID         = C.SHIPT_ID                     10020099
100300          AND C.PRIM_SHIPT_IND   = 'Y'                            10030099
100400          AND C.PO_NBR           = D.ORD_NBR                      10040099
100500          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  10050099
100600          AND D.FRE_ASTRA_IND    = 'Y'                            10060099
100700          AND D.STATUS_CDE       <> 'VE'                          10070099
100800          AND DATE(D.CRE_TMST)   >= :DK-FROM-DATE                 10080099
100900          AND DATE(D.CRE_TMST)   <= :DK-TO-DATE                   10090099
101000          ORDER BY D.CRE_TMST DESC                                10100099
101100     WITH UR                                                      10110099
101200     END-EXEC.                                                    10120099
101300                                                                  10130099
101400                                                                  10140099
101500******************************************************************10150099
101600*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         10160099
101700*  WITH OPER ID, SCAC AND TRAILER -                               10170099
101800*  WILL BRING BACK LIST OF RECEIVERS.                             10180099
101900*  ORDER BY SCAC/TRLR                                             10190099
102000******************************************************************10200099
102100                                                                  10210099
102200     EXEC SQL                                                     10220099
102300          DECLARE SCAC-TRLR-S-CSR CURSOR FOR                      10230099
102400       SELECT A.TRIP_ID                                           10240099
102500             ,A.OWNER_SCAC_ID                                     10250099
102600             ,A.VEH_NBR                                           10260099
102700             ,B.SHIPT_ID                                          10270099
102800             ,D.ORD_NBR                                           10280099
102900             ,D.REC_SEQ_NBR                                       10290099
103000             ,D.CRE_TMST                                          10300099
103100             ,D.PKGNG_CDE                                         10310099
103200         FROM TVHTRIP A                                           10320099
103300             ,TSHIPMT B                                           10330099
103400             ,TSHPTPO C                                           10340099
103500             ,TRECEIV D                                           10350099
103600        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                10360099
103700          AND A.OWNER_SCAC_ID    = :DK-SCAC                       10370099
103800          AND A.VEH_NBR          = :DK-TRLR-NBR                   10380099
103900          AND A.TRIP_ID          = B.TRIP_ID                      10390099
104000          AND B.SHIPT_ID         = C.SHIPT_ID                     10400099
104100          AND C.PRIM_SHIPT_IND   = 'Y'                            10410099
104200          AND C.PO_NBR           = D.ORD_NBR                      10420099
104300          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  10430099
104400          AND D.FRE_ASTRA_IND    = 'Y'                            10440099
104500          AND D.STATUS_CDE       <> 'VE'                          10450099
104600          ORDER BY A.OWNER_SCAC_ID                                10460099
104700                  ,A.VEH_NBR                                      10470099
104800     WITH UR                                                      10480099
104900     END-EXEC.                                                    10490099
105000                                                                  10500099
105100******************************************************************10510099
105200*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         10520099
105300*  WITH OPER ID, SCAC AND TRAILER -                               10530099
105400*  WILL BRING BACK LIST OF RECEIVERS.                             10540099
105500*  ORDER BY ASCENDING DATE (CRE TMST)                             10550099
105600******************************************************************10560099
105700                                                                  10570099
105800     EXEC SQL                                                     10580099
105900          DECLARE SCAC-TRLR-A-CSR CURSOR FOR                      10590099
106000       SELECT A.TRIP_ID                                           10600099
106100             ,A.OWNER_SCAC_ID                                     10610099
106200             ,A.VEH_NBR                                           10620099
106300             ,B.SHIPT_ID                                          10630099
106400             ,D.ORD_NBR                                           10640099
106500             ,D.REC_SEQ_NBR                                       10650099
106600             ,D.CRE_TMST                                          10660099
106700             ,D.PKGNG_CDE                                         10670099
106800         FROM TVHTRIP A                                           10680099
106900             ,TSHIPMT B                                           10690099
107000             ,TSHPTPO C                                           10700099
107100             ,TRECEIV D                                           10710099
107200        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                10720099
107300          AND A.OWNER_SCAC_ID    = :DK-SCAC                       10730099
107400          AND A.VEH_NBR          = :DK-TRLR-NBR                   10740099
107500          AND A.TRIP_ID          = B.TRIP_ID                      10750099
107600          AND B.SHIPT_ID         = C.SHIPT_ID                     10760099
107700          AND C.PRIM_SHIPT_IND   = 'Y'                            10770099
107800          AND C.PO_NBR           = D.ORD_NBR                      10780099
107900          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  10790099
108000          AND D.FRE_ASTRA_IND    = 'Y'                            10800099
108100          AND D.STATUS_CDE       <> 'VE'                          10810099
108200          ORDER BY D.CRE_TMST ASC                                 10820099
108300     WITH UR                                                      10830099
108400     END-EXEC.                                                    10840099
108500                                                                  10850099
108600******************************************************************10860099
108700*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         10870099
108800*  WITH OPER ID, SCAC AND TRAILER -                               10880099
108900*  WILL BRING BACK LIST OF RECEIVERS.                             10890099
109000*  ORDER BY DESCENDING DATE (CRE TMST)                            10900099
109100******************************************************************10910099
109200                                                                  10920099
109300     EXEC SQL                                                     10930099
109400          DECLARE SCAC-TRLR-D-CSR CURSOR FOR                      10940099
109500       SELECT A.TRIP_ID                                           10950099
109600             ,A.OWNER_SCAC_ID                                     10960099
109700             ,A.VEH_NBR                                           10970099
109800             ,B.SHIPT_ID                                          10980099
109900             ,D.ORD_NBR                                           10990099
110000             ,D.REC_SEQ_NBR                                       11000099
110100             ,D.CRE_TMST                                          11010099
110200             ,D.PKGNG_CDE                                         11020099
110300         FROM TVHTRIP A                                           11030099
110400             ,TSHIPMT B                                           11040099
110500             ,TSHPTPO C                                           11050099
110600             ,TRECEIV D                                           11060099
110700        WHERE D.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                11070099
110800          AND A.OWNER_SCAC_ID    = :DK-SCAC                       11080099
110900          AND A.VEH_NBR          = :DK-TRLR-NBR                   11090099
111000          AND A.TRIP_ID          = B.TRIP_ID                      11100099
111100          AND B.SHIPT_ID         = C.SHIPT_ID                     11110099
111200          AND C.PRIM_SHIPT_IND   = 'Y'                            11120099
111300          AND C.PO_NBR           = D.ORD_NBR                      11130099
111400          AND C.REC_SEQ_NBR      = D.REC_SEQ_NBR                  11140099
111500          AND D.FRE_ASTRA_IND    = 'Y'                            11150099
111600          AND D.STATUS_CDE       <> 'VE'                          11160099
111700          ORDER BY D.CRE_TMST DESC                                11170099
111800     WITH UR                                                      11180099
111900     END-EXEC.                                                    11190099
112000                                                                  11200099
112100******************************************************************11210099
112200*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         11220099
112300*  WITH TRIP ID -                                                 11230099
112400*  (OPER UNT ID DOESN'T MATTER)                                   11240099
112500*  WILL BRING BACK LIST OF RECEIVERS.                             11250099
112600*  ORDER BY SCAC/TRLR                                             11260099
112700******************************************************************11270099
112800                                                                  11280099
112900     EXEC SQL                                                     11290099
113000          DECLARE TRIP-ID-S-CSR CURSOR FOR                        11300099
113100       SELECT A.SHIPT_ID                                          11310099
113200             ,C.ORD_NBR                                           11320099
113300             ,C.REC_SEQ_NBR                                       11330099
113400             ,C.CRE_TMST                                          11340099
113500             ,C.PKGNG_CDE                                         11350099
113600             ,D.OWNER_SCAC_ID                                     11360099
113700             ,D.VEH_NBR                                           11370099
113800         FROM TSHIPMT A                                           11380099
113900             ,TSHPTPO B                                           11390099
114000             ,TRECEIV C                                           11400099
114100             ,TVHTRIP D                                           11410099
114200        WHERE A.TRIP_ID          = :DK-TRIP-ID                    11420099
114300          AND A.SHIPT_ID         = B.SHIPT_ID                     11430099
114400          AND B.PRIM_SHIPT_IND   = 'Y'                            11440099
114500          AND B.PO_NBR           = C.ORD_NBR                      11450099
114600          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  11460099
114700          AND C.FRE_ASTRA_IND    = 'Y'                            11470099
114800          AND C.STATUS_CDE       <> 'VE'                          11480099
114900          AND A.TRIP_ID          = D.TRIP_ID                      11490099
115000          ORDER BY D.OWNER_SCAC_ID                                11500099
115100                  ,D.VEH_NBR                                      11510099
115200     WITH UR                                                      11520099
115300     END-EXEC.                                                    11530099
115400                                                                  11540099
115500******************************************************************11550099
115600*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         11560099
115700*  WITH TRIP ID -                                                 11570099
115800*  (OPER UNT ID DOESN'T MATTER)                                   11580099
115900*  WILL BRING BACK LIST OF RECEIVERS.                             11590099
116000*  ORDER BY ASCENDING DATE (CRE TMST)                             11600099
116100******************************************************************11610099
116200                                                                  11620099
116300     EXEC SQL                                                     11630099
116400          DECLARE TRIP-ID-A-CSR CURSOR FOR                        11640099
116500       SELECT A.SHIPT_ID                                          11650099
116600             ,C.ORD_NBR                                           11660099
116700             ,C.REC_SEQ_NBR                                       11670099
116800             ,C.CRE_TMST                                          11680099
116900             ,C.PKGNG_CDE                                         11690099
117000             ,D.OWNER_SCAC_ID                                     11700099
117100             ,D.VEH_NBR                                           11710099
117200         FROM TSHIPMT A                                           11720099
117300             ,TSHPTPO B                                           11730099
117400             ,TRECEIV C                                           11740099
117500             ,TVHTRIP D                                           11750099
117600        WHERE A.TRIP_ID          = :DK-TRIP-ID                    11760099
117700          AND A.SHIPT_ID         = B.SHIPT_ID                     11770099
117800          AND B.PRIM_SHIPT_IND   = 'Y'                            11780099
117900          AND B.PO_NBR           = C.ORD_NBR                      11790099
118000          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  11800099
118100          AND C.FRE_ASTRA_IND    = 'Y'                            11810099
118200          AND C.STATUS_CDE       <> 'VE'                          11820099
118300          AND A.TRIP_ID          = D.TRIP_ID                      11830099
118400          ORDER BY C.CRE_TMST ASC                                 11840099
118500     WITH UR                                                      11850099
118600     END-EXEC.                                                    11860099
118700                                                                  11870099
118800******************************************************************11880099
118900*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         11890099
119000*  WITH TRIP ID -                                                 11900099
119100*  (OPER UNT ID DOESN'T MATTER)                                   11910099
119200*  WILL BRING BACK LIST OF RECEIVERS.                             11920099
119300*  ORDER BY DESCENDING DATE (CRE TMST)                            11930099
119400******************************************************************11940099
119500                                                                  11950099
119600     EXEC SQL                                                     11960099
119700          DECLARE TRIP-ID-D-CSR CURSOR FOR                        11970099
119800       SELECT A.SHIPT_ID                                          11980099
119900             ,C.ORD_NBR                                           11990099
120000             ,C.REC_SEQ_NBR                                       12000099
120100             ,C.CRE_TMST                                          12010099
120200             ,C.PKGNG_CDE                                         12020099
120300             ,D.OWNER_SCAC_ID                                     12030099
120400             ,D.VEH_NBR                                           12040099
120500         FROM TSHIPMT A                                           12050099
120600             ,TSHPTPO B                                           12060099
120700             ,TRECEIV C                                           12070099
120800             ,TVHTRIP D                                           12080099
120900        WHERE A.TRIP_ID          = :DK-TRIP-ID                    12090099
121000          AND A.SHIPT_ID         = B.SHIPT_ID                     12100099
121100          AND B.PRIM_SHIPT_IND   = 'Y'                            12110099
121200          AND B.PO_NBR           = C.ORD_NBR                      12120099
121300          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  12130099
121400          AND C.FRE_ASTRA_IND    = 'Y'                            12140099
121500          AND C.STATUS_CDE       <> 'VE'                          12150099
121600          AND A.TRIP_ID          = D.TRIP_ID                      12160099
121700          ORDER BY C.CRE_TMST DESC                                12170099
121800     WITH UR                                                      12180099
121900     END-EXEC.                                                    12190099
122000                                                                  12200099
122100******************************************************************12210099
122200*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         12220099
122300*  WITH OPER ID, PO AND CURRENT DATE -                            12230099
122400*  WILL BRING BACK LIST OF RECEIVERS.                             12240099
122500*  ORDER BY SCAC/TRLR                                             12250099
122600******************************************************************12260099
122700                                                                  12270099
122800     EXEC SQL                                                     12280099
122900          DECLARE PO-CURR-DTE-S-CSR CURSOR FOR                    12290099
123000       SELECT A.SHIPT_ID                                          12300099
123100             ,C.ORD_NBR                                           12310099
123200             ,C.REC_SEQ_NBR                                       12320099
123300             ,C.CRE_TMST                                          12330099
123400             ,A.TRIP_ID                                           12340099
123500             ,C.PKGNG_CDE                                         12350099
123600             ,D.OWNER_SCAC_ID                                     12360099
123700             ,D.VEH_NBR                                           12370099
123800         FROM TSHIPMT A                                           12380099
123900             ,TSHPTPO B                                           12390099
124000             ,TRECEIV C                                           12400099
124100             ,TVHTRIP D                                           12410099
124200        WHERE C.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                12420099
124300          AND C.ORD_NBR          = :DK-PO-NBR                     12430099
124400          AND A.SHIPT_ID         = B.SHIPT_ID                     12440099
124500          AND B.PRIM_SHIPT_IND   = 'Y'                            12450099
124600          AND B.PO_NBR           = C.ORD_NBR                      12460099
124700          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  12470099
124800          AND C.FRE_ASTRA_IND    = 'Y'                            12480099
124900          AND C.STATUS_CDE       <> 'VE'                          12490099
125000          AND DATE(C.CRE_TMST)   = :DK-CURR-DATE                  12500099
125100          AND A.TRIP_ID          = D.TRIP_ID                      12510099
125200          ORDER BY D.OWNER_SCAC_ID                                12520099
125300                  ,D.VEH_NBR                                      12530099
125400     WITH UR                                                      12540099
125500     END-EXEC.                                                    12550099
125600                                                                  12560099
125700******************************************************************12570099
125800*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         12580099
125900*  WITH OPER ID, PO AND CURRENT DATE -                            12590099
126000*  WILL BRING BACK LIST OF RECEIVERS.                             12600099
126100*  ORDER BY ASCENDING DATE (CRE TMST)                             12610099
126200******************************************************************12620099
126300                                                                  12630099
126400     EXEC SQL                                                     12640099
126500          DECLARE PO-CURR-DTE-A-CSR CURSOR FOR                    12650099
126600       SELECT A.SHIPT_ID                                          12660099
126700             ,C.ORD_NBR                                           12670099
126800             ,C.REC_SEQ_NBR                                       12680099
126900             ,C.CRE_TMST                                          12690099
127000             ,A.TRIP_ID                                           12700099
127100             ,C.PKGNG_CDE                                         12710099
127200             ,D.OWNER_SCAC_ID                                     12720099
127300             ,D.VEH_NBR                                           12730099
127400         FROM TSHIPMT A                                           12740099
127500             ,TSHPTPO B                                           12750099
127600             ,TRECEIV C                                           12760099
127700             ,TVHTRIP D                                           12770099
127800        WHERE C.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                12780099
127900          AND C.ORD_NBR          = :DK-PO-NBR                     12790099
128000          AND A.SHIPT_ID         = B.SHIPT_ID                     12800099
128100          AND B.PRIM_SHIPT_IND   = 'Y'                            12810099
128200          AND B.PO_NBR           = C.ORD_NBR                      12820099
128300          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  12830099
128400          AND C.FRE_ASTRA_IND    = 'Y'                            12840099
128500          AND C.STATUS_CDE       <> 'VE'                          12850099
128600          AND DATE(C.CRE_TMST)   = :DK-CURR-DATE                  12860099
128700          AND A.TRIP_ID          = D.TRIP_ID                      12870099
128800          ORDER BY C.CRE_TMST ASC                                 12880099
128900     WITH UR                                                      12890099
129000     END-EXEC.                                                    12900099
129100                                                                  12910099
129200******************************************************************12920099
129300*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         12930099
129400*  WITH OPER ID, PO AND CURRENT DATE -                            12940099
129500*  WILL BRING BACK LIST OF RECEIVERS.                             12950099
129600*  ORDER BY DESCENDING DATE (CRE TMST)                            12960099
129700******************************************************************12970099
129800                                                                  12980099
129900     EXEC SQL                                                     12990099
130000          DECLARE PO-CURR-DTE-D-CSR CURSOR FOR                    13000099
130100       SELECT A.SHIPT_ID                                          13010099
130200             ,C.ORD_NBR                                           13020099
130300             ,C.REC_SEQ_NBR                                       13030099
130400             ,C.CRE_TMST                                          13040099
130500             ,A.TRIP_ID                                           13050099
130600             ,C.PKGNG_CDE                                         13060099
130700             ,D.OWNER_SCAC_ID                                     13070099
130800             ,D.VEH_NBR                                           13080099
130900         FROM TSHIPMT A                                           13090099
131000             ,TSHPTPO B                                           13100099
131100             ,TRECEIV C                                           13110099
131200             ,TVHTRIP D                                           13120099
131300        WHERE C.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                13130099
131400          AND C.ORD_NBR          = :DK-PO-NBR                     13140099
131500          AND A.SHIPT_ID         = B.SHIPT_ID                     13150099
131600          AND B.PRIM_SHIPT_IND   = 'Y'                            13160099
131700          AND B.PO_NBR           = C.ORD_NBR                      13170099
131800          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  13180099
131900          AND C.FRE_ASTRA_IND    = 'Y'                            13190099
132000          AND C.STATUS_CDE       <> 'VE'                          13200099
132100          AND DATE(C.CRE_TMST)   = :DK-CURR-DATE                  13210099
132200          AND A.TRIP_ID          = D.TRIP_ID                      13220099
132300          ORDER BY C.CRE_TMST DESC                                13230099
132400     WITH UR                                                      13240099
132500     END-EXEC.                                                    13250099
132600                                                                  13260099
132700******************************************************************13270099
132800*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         13280099
132900*  WITH OPER ID, PO AND DATE RANGE -                              13290099
133000*  WILL BRING BACK LIST OF RECEIVERS.                             13300099
133100*  ORDER BY SCAC/TRLR                                             13310099
133200******************************************************************13320099
133300                                                                  13330099
133400     EXEC SQL                                                     13340099
133500          DECLARE PO-DATE-RNGE-S-CSR CURSOR FOR                   13350099
133600       SELECT A.SHIPT_ID                                          13360099
133700             ,C.ORD_NBR                                           13370099
133800             ,C.REC_SEQ_NBR                                       13380099
133900             ,C.CRE_TMST                                          13390099
134000             ,A.TRIP_ID                                           13400099
134100             ,C.PKGNG_CDE                                         13410099
134200             ,D.OWNER_SCAC_ID                                     13420099
134300             ,D.VEH_NBR                                           13430099
134400         FROM TSHIPMT A                                           13440099
134500             ,TSHPTPO B                                           13450099
134600             ,TRECEIV C                                           13460099
134700             ,TVHTRIP D                                           13470099
134800        WHERE C.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                13480099
134900          AND C.ORD_NBR          = :DK-PO-NBR                     13490099
135000          AND A.SHIPT_ID         = B.SHIPT_ID                     13500099
135100          AND B.PRIM_SHIPT_IND   = 'Y'                            13510099
135200          AND B.PO_NBR           = C.ORD_NBR                      13520099
135300          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  13530099
135400          AND C.FRE_ASTRA_IND    = 'Y'                            13540099
135500          AND C.STATUS_CDE       <> 'VE'                          13550099
135600          AND DATE(C.CRE_TMST)   >= :DK-FROM-DATE                 13560099
135700          AND DATE(C.CRE_TMST)   <= :DK-TO-DATE                   13570099
135800          AND A.TRIP_ID          = D.TRIP_ID                      13580099
135900          ORDER BY D.OWNER_SCAC_ID                                13590099
136000                  ,D.VEH_NBR                                      13600099
136100     WITH UR                                                      13610099
136200     END-EXEC.                                                    13620099
136300                                                                  13630099
136400******************************************************************13640099
136500*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         13650099
136600*  WITH OPER ID, PO AND DATE RANGE -                              13660099
136700*  WILL BRING BACK LIST OF RECEIVERS.                             13670099
136800*  ORDER BY ASCENDING DATE (CRE TMST)                             13680099
136900******************************************************************13690099
137000                                                                  13700099
137100     EXEC SQL                                                     13710099
137200          DECLARE PO-DATE-RNGE-A-CSR CURSOR FOR                   13720099
137300       SELECT A.SHIPT_ID                                          13730099
137400             ,C.ORD_NBR                                           13740099
137500             ,C.REC_SEQ_NBR                                       13750099
137600             ,C.CRE_TMST                                          13760099
137700             ,A.TRIP_ID                                           13770099
137800             ,C.PKGNG_CDE                                         13780099
137900             ,D.OWNER_SCAC_ID                                     13790099
138000             ,D.VEH_NBR                                           13800099
138100         FROM TSHIPMT A                                           13810099
138200             ,TSHPTPO B                                           13820099
138300             ,TRECEIV C                                           13830099
138400             ,TVHTRIP D                                           13840099
138500        WHERE C.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                13850099
138600          AND C.ORD_NBR          = :DK-PO-NBR                     13860099
138700          AND A.SHIPT_ID         = B.SHIPT_ID                     13870099
138800          AND B.PRIM_SHIPT_IND   = 'Y'                            13880099
138900          AND B.PO_NBR           = C.ORD_NBR                      13890099
139000          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  13900099
139100          AND C.FRE_ASTRA_IND    = 'Y'                            13910099
139200          AND C.STATUS_CDE       <> 'VE'                          13920099
139300          AND DATE(C.CRE_TMST)   >= :DK-FROM-DATE                 13930099
139400          AND DATE(C.CRE_TMST)   <= :DK-TO-DATE                   13940099
139500          AND A.TRIP_ID          = D.TRIP_ID                      13950099
139600          ORDER BY C.CRE_TMST ASC                                 13960099
139700     WITH UR                                                      13970099
139800     END-EXEC.                                                    13980099
139900                                                                  13990099
140000******************************************************************14000099
140100*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         14010099
140200*  WITH OPER ID, PO AND DATE RANGE -                              14020099
140300*  WILL BRING BACK LIST OF RECEIVERS.                             14030099
140400*  ORDER BY DESCENDING DATE (CRE TMST)                            14040099
140500******************************************************************14050099
140600                                                                  14060099
140700     EXEC SQL                                                     14070099
140800          DECLARE PO-DATE-RNGE-D-CSR CURSOR FOR                   14080099
140900       SELECT A.SHIPT_ID                                          14090099
141000             ,C.ORD_NBR                                           14100099
141100             ,C.REC_SEQ_NBR                                       14110099
141200             ,C.CRE_TMST                                          14120099
141300             ,A.TRIP_ID                                           14130099
141400             ,C.PKGNG_CDE                                         14140099
141500             ,D.OWNER_SCAC_ID                                     14150099
141600             ,D.VEH_NBR                                           14160099
141700         FROM TSHIPMT A                                           14170099
141800             ,TSHPTPO B                                           14180099
141900             ,TRECEIV C                                           14190099
142000             ,TVHTRIP D                                           14200099
142100        WHERE C.CURR_OPER_UNT_ID = :DK-OPER-UNT-ID                14210099
142200          AND C.ORD_NBR          = :DK-PO-NBR                     14220099
142300          AND A.SHIPT_ID         = B.SHIPT_ID                     14230099
142400          AND B.PRIM_SHIPT_IND   = 'Y'                            14240099
142500          AND B.PO_NBR           = C.ORD_NBR                      14250099
142600          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  14260099
142700          AND C.FRE_ASTRA_IND    = 'Y'                            14270099
142800          AND C.STATUS_CDE       <> 'VE'                          14280099
142900          AND DATE(C.CRE_TMST)   >= :DK-FROM-DATE                 14290099
143000          AND DATE(C.CRE_TMST)   <= :DK-TO-DATE                   14300099
143100          AND A.TRIP_ID          = D.TRIP_ID                      14310099
143200          ORDER BY C.CRE_TMST DESC                                14320099
143300     WITH UR                                                      14330099
143400     END-EXEC.                                                    14340099
143500                                                                  14350099
143600******************************************************************14360099
143700*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         14370099
143800*  WITH PO AND RECEIVER -                                         14380099
143900*  WILL BRING BACK LIST OF RECEIVERS.                             14390099
144000*  ORDER BY SCAC/TRLR                                             14400099
144100******************************************************************14410099
144200                                                                  14420099
144300     EXEC SQL                                                     14430099
144400          DECLARE PO-RCVR-S-CSR CURSOR FOR                        14440099
144500       SELECT A.SHIPT_ID                                          14450099
144600             ,C.ORD_NBR                                           14460099
144700             ,C.REC_SEQ_NBR                                       14470099
144800             ,C.CRE_TMST                                          14480099
144900             ,A.TRIP_ID                                           14490099
145000             ,C.PKGNG_CDE                                         14500099
145100             ,D.OWNER_SCAC_ID                                     14510099
145200             ,D.VEH_NBR                                           14520099
145300         FROM TSHIPMT A                                           14530099
145400             ,TSHPTPO B                                           14540099
145500             ,TRECEIV C                                           14550099
145600             ,TVHTRIP D                                           14560099
145700        WHERE C.ORD_NBR          = :DK-PO-NBR                     14570099
145800          AND C.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                14580099
145900          AND A.SHIPT_ID         = B.SHIPT_ID                     14590099
146000          AND B.PRIM_SHIPT_IND   = 'Y'                            14600099
146100          AND B.PO_NBR           = C.ORD_NBR                      14610099
146200          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  14620099
146300          AND C.FRE_ASTRA_IND    = 'Y'                            14630099
146400          AND C.STATUS_CDE       <> 'VE'                          14640099
146500          AND A.TRIP_ID          = D.TRIP_ID                      14650099
146600          ORDER BY D.OWNER_SCAC_ID                                14660099
146700                  ,D.VEH_NBR                                      14670099
146800     WITH UR                                                      14680099
146900     END-EXEC.                                                    14690099
147000                                                                  14700099
147100******************************************************************14710099
147200*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         14720099
147300*  WITH PO AND RECEIVER -                                         14730099
147400*  WILL BRING BACK LIST OF RECEIVERS.                             14740099
147500*  ORDER BY ASCENDING DATE (CRE TMST)                             14750099
147600******************************************************************14760099
147700                                                                  14770099
147800     EXEC SQL                                                     14780099
147900          DECLARE PO-RCVR-A-CSR CURSOR FOR                        14790099
148000       SELECT A.SHIPT_ID                                          14800099
148100             ,C.ORD_NBR                                           14810099
148200             ,C.REC_SEQ_NBR                                       14820099
148300             ,C.CRE_TMST                                          14830099
148400             ,A.TRIP_ID                                           14840099
148500             ,C.PKGNG_CDE                                         14850099
148600             ,D.OWNER_SCAC_ID                                     14860099
148700             ,D.VEH_NBR                                           14870099
148800         FROM TSHIPMT A                                           14880099
148900             ,TSHPTPO B                                           14890099
149000             ,TRECEIV C                                           14900099
149100             ,TVHTRIP D                                           14910099
149200        WHERE C.ORD_NBR          = :DK-PO-NBR                     14920099
149300          AND C.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                14930099
149400          AND A.SHIPT_ID         = B.SHIPT_ID                     14940099
149500          AND B.PRIM_SHIPT_IND   = 'Y'                            14950099
149600          AND B.PO_NBR           = C.ORD_NBR                      14960099
149700          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  14970099
149800          AND C.FRE_ASTRA_IND    = 'Y'                            14980099
149900          AND C.STATUS_CDE       <> 'VE'                          14990099
150000          AND A.TRIP_ID          = D.TRIP_ID                      15000099
150100          ORDER BY C.CRE_TMST ASC                                 15010099
150200     WITH UR                                                      15020099
150300     END-EXEC.                                                    15030099
150400                                                                  15040099
150500******************************************************************15050099
150600*  CURSOR WHEN COMING IN FROM CRIT SPEC -                         15060099
150700*  WITH PO AND RECEIVER -                                         15070099
150800*  WILL BRING BACK LIST OF RECEIVERS.                             15080099
150900*  ORDER BY DESCENDING DATE (CRE TMST)                            15090099
151000******************************************************************15100099
151100                                                                  15110099
151200     EXEC SQL                                                     15120099
151300          DECLARE PO-RCVR-D-CSR CURSOR FOR                        15130099
151400       SELECT A.SHIPT_ID                                          15140099
151500             ,C.ORD_NBR                                           15150099
151600             ,C.REC_SEQ_NBR                                       15160099
151700             ,C.CRE_TMST                                          15170099
151800             ,A.TRIP_ID                                           15180099
151900             ,C.PKGNG_CDE                                         15190099
152000             ,D.OWNER_SCAC_ID                                     15200099
152100             ,D.VEH_NBR                                           15210099
152200         FROM TSHIPMT A                                           15220099
152300             ,TSHPTPO B                                           15230099
152400             ,TRECEIV C                                           15240099
152500             ,TVHTRIP D                                           15250099
152600        WHERE C.ORD_NBR          = :DK-PO-NBR                     15260099
152700          AND C.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                15270099
152800          AND A.SHIPT_ID         = B.SHIPT_ID                     15280099
152900          AND B.PRIM_SHIPT_IND   = 'Y'                            15290099
153000          AND B.PO_NBR           = C.ORD_NBR                      15300099
153100          AND B.REC_SEQ_NBR      = C.REC_SEQ_NBR                  15310099
153200          AND C.FRE_ASTRA_IND    = 'Y'                            15320099
153300          AND C.STATUS_CDE       <> 'VE'                          15330099
153400          AND A.TRIP_ID          = D.TRIP_ID                      15340099
153500          ORDER BY C.CRE_TMST DESC                                15350099
153600     WITH UR                                                      15360099
153700     END-EXEC.                                                    15370099
153800                                                                  15380099
153900                                                                  15390099
154000 LINKAGE SECTION.                                                 15400099
154100                                                                  15410099
154200 01  DFHCOMMAREA.                                                 15420099
154300     05  FILLER                         OCCURS  1 TO 4072 TIMES   15430099
154400                                        DEPENDING ON EIBCALEN.    15440099
154500         10  FILLER                     PIC X.                    15450099
154600****************************************************************  15460099
154700 PROCEDURE DIVISION.                                              15470099
154800******************************************************************15480099
154900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **15490099
155000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **15500099
155100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **15510099
155200******************************************************************15520099
155300 0000-MAIN-MODULE.                                                15530099
155400     INITIALIZE DP030-CICS-API-FIELDS.                            15540099
155500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       15550099
155600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          15560099
155700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         15570099
155800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       15580099
155900     MOVE LENGTH OF SU761AI        TO DP030-MAP-LENGTH (1).       15590099
156000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     15600099
156100     PERFORM 0001-CALL-CICS-ARCH-API.                             15610099
156200                                                                  15620099
156300     PERFORM 1000-CONTROL-PROCESSING                              15630099
156400                                                                  15640099
156500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     15650099
156600     PERFORM 0001-CALL-CICS-ARCH-API.                             15660099
156700                                                                  15670099
156800******************************************************************15680099
156900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **15690099
157000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **15700099
157100******************************************************************15710099
157200 0001-CALL-CICS-ARCH-API.                                         15720099
157300*    CALL 'DPKCS030' USING DFHEIBLK                               15730099
157300     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      15731099
157400                           DFHCOMMAREA                            15740099
157500                           DP030-CICS-API-FIELDS                  15750099
157600                           DP020-STANDARD-COMMAREA                15760099
157700                           SU761AI.                               15770099
157800                                                                  15780099
157900     IF  DP030-RC-CALL-SUCCESSFUL                                 15790099
158000         CONTINUE                                                 15800099
158100     ELSE                                                         15810099
158200         SET DP013-NO-ROLLBACK                                    15820099
158300             DP013-XCTL-DISPLAY-RESTART                           15830099
158400             DP013-CICS-ABEND      TO TRUE                        15840099
158500         MOVE '0001-CALL-CICS-ARCH-API'                           15850099
158600                                   TO DP013-PARAGRAPH             15860099
158700*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX15870099
158800*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      15880099
158700         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O15881099
158800-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      15882099
158900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      15890099
159000         PERFORM DP013-0000-PROCESS-ABEND                         15900099
159100     END-IF.                                                      15910099
159200*----------------------------------------------------------------*15920099
159300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *15930099
159400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *15940099
159500*                                                                *15950099
159600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *15960099
159700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *15970099
159800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *15980099
159900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *15990099
160000*----------------------------------------------------------------*16000099
160100                                                                  16010099
160200 1000-CONTROL-PROCESSING.                                         16020099
160300                                                                  16030099
160400     EVALUATE TRUE                                                16040099
160500         WHEN DP020-NEXT-ACT-INITIAL                              16050099
160600             INITIALIZE ASC-SPECIFIC-COMMAREA                     16060099
160700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            16070099
160800                                      ASC-SEL-TERM-ID             16080099
160900             MOVE DP020-SRC-TASK-NUMBER                           16090099
161000                                   TO ASC-LIST-TASK-NUMBER        16100099
161100                                      ASC-SEL-TASK-NUMBER         16110099
161200             MOVE PC-LIST-QUEUE-SEQ                               16120099
161300                                   TO ASC-LIST-SEQ                16130099
161400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 16140099
161500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 16150099
161600             IF  PS-COMMAREA-NOT-VALID                            16160099
161700                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            16170099
161800             ELSE                                                 16180099
161900                 PERFORM 4000-BUILD-INITIAL-PANEL                 16190099
162000             END-IF                                               16200099
162100                                                                  16210099
162200         WHEN DP020-NEXT-ACT-READ-MAP                             16220099
162300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         16230099
162400             PERFORM 2000-PROCESS-PANEL                           16240099
162500                                                                  16250099
162600         WHEN DP020-NEXT-ACT-RETURN                               16260099
162700             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         16270099
162800             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                16280099
162900*            SET ASC-FUNC01-RETURN-YES TO TRUE                    16290099
163000             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 16300099
163100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16310099
163200                                                                  16320099
163300         WHEN OTHER                                               16330099
163400             SET DP013-LOGIC-ABEND TO TRUE                        16340099
163500             SET DP013-NO-ROLLBACK TO TRUE                        16350099
163600             MOVE '1000-CONTROL-PROCESSING'                       16360099
163700                                   TO DP013-PARAGRAPH             16370099
163800             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    16380099
163900                                   TO DP013-MESSAGE-TEXT(1)       16390099
164000             PERFORM DP013-0000-PROCESS-ABEND                     16400099
164100     END-EVALUATE.                                                16410099
164200                                                                  16420099
164300*----------------------------------------------------------------*16430099
164400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *16440099
164500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *16450099
164600*----------------------------------------------------------------*16460099
164700 1100-PROCESS-INTER-APPL-COMM.                                    16470099
164800                                                                  16480099
164900******COMING FROM SUWS046 CRIT SPEC                               16490099
165000     SET PS-COMMAREA-VALID          TO TRUE.                      16500099
165100     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    16510099
165200     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          16520099
165300         MOVE SU046-OPER-UNT-ID     TO ASC-OPER-UNT-ID            16530099
165400         MOVE SU046-FCLTY-ID        TO ASC-FCLTY-ID               16540099
165500         MOVE SU046-FCLTY-NME       TO ASC-FCLTY-NME              16550099
165600         MOVE SU046-SCAC            TO ASC-SCAC-ID                16560099
165700         MOVE SU046-TRLR-NBR        TO ASC-TRLR-NUMBER            16570099
165800         MOVE SU046-TRIP-ID         TO ASC-TRIP-ID                16580099
165900         MOVE SU046-PO-NBR          TO ASC-PO-NUMBER              16590099
166000                                       PV-PO-NUMBER               16600099
166100         MOVE SU046-REC-SEQ-NBR     TO ASC-REC-SEQ-NBR            16610099
166200                                       PV-REC-SEQ-NBR             16620099
166300         MOVE SU046-LIST-SEQ-IND    TO ASC-LIST-SEQ-IND           16630099
166400         MOVE SU046-DATE-SELECTED   TO ASC-DATE-SELECTED          16640099
166500                                                                  16650099
166600         IF ASC-DATE-SELECTED = 'C'                               16660099
166700            MOVE SU046-CURR-DATE(5:4)  TO ASC-CURR-YY             16670099
166800                                          PV-CURR-YY              16680099
166900            MOVE SU046-CURR-DATE(1:2)  TO ASC-CURR-MM             16690099
167000                                          PV-CURR-MM              16700099
167100            MOVE SU046-CURR-DATE(3:2)  TO ASC-CURR-DD             16710099
167200                                          PV-CURR-DD              16720099
167300         END-IF                                                   16730099
167400         IF ASC-DATE-SELECTED = 'R'                               16740099
167500            MOVE SU046-FROM-DATE(5:4)  TO ASC-FROM-YY             16750099
167600                                          PV-FROM-YY              16760099
167700            MOVE SU046-FROM-DATE(1:2)  TO ASC-FROM-MM             16770099
167800                                          PV-FROM-MM              16780099
167900            MOVE SU046-FROM-DATE(3:2)  TO ASC-FROM-DD             16790099
168000                                          PV-FROM-DD              16800099
168100            MOVE SU046-TO-DATE(5:4)    TO ASC-TO-YY               16810099
168200                                          PV-TO-YY                16820099
168300            MOVE SU046-TO-DATE(1:2)    TO ASC-TO-MM               16830099
168400                                          PV-TO-MM                16840099
168500            MOVE SU046-TO-DATE(3:2)    TO ASC-TO-DD               16850099
168600                                          PV-TO-DD                16860099
168700         END-IF                                                   16870099
168800     ELSE                                                         16880099
168900         IF  DP020-INT-APPL-FORMAT-IND =  PC-FROM-RCVGSMPL        16890099
169000             MOVE SU046-OPER-UNT-ID     TO ASC-OPER-UNT-ID        16900099
169100                                           DK-OPER-UNT-ID         16910099
169200             MOVE SU046-FCLTY-ID        TO ASC-FCLTY-ID           16920099
169300             MOVE SU046-FCLTY-NME       TO ASC-FCLTY-NME          16930099
169400             MOVE SU046-SCAC            TO ASC-SCAC-ID            16940099
169500             MOVE SU046-TRLR-NBR        TO ASC-TRLR-NUMBER        16950099
169600             MOVE SU046-TRIP-ID         TO ASC-TRIP-ID            16960099
169700             IF ASC-TRLR-NUMBER = SPACES                          16970099
169800                MOVE PC-TSYMSG-03218    TO DP020-MSG-NUMBER       16980099
169900                SET  PS-COMMAREA-NOT-VALID TO TRUE                16990099
170000             END-IF                                               17000099
170100*SELECT ON TKRPRPM TABLE                                          17010099
170200             PERFORM 3150-LIST-SEQUENCE                           17020099
170300             IF KRPRPM-FUNC-TXT = 'SCAC/TRLR'                     17030099
170400                MOVE PC-S                 TO ASC-LIST-SEQ-IND     17040099
170500             END-IF                                               17050099
170600             IF KRPRPM-FUNC-TXT = 'DATE ASC'                      17060099
170700                MOVE PC-A                 TO ASC-LIST-SEQ-IND     17070099
170800             END-IF                                               17080099
170900             IF KRPRPM-FUNC-TXT = 'DATE DESC'                     17090099
171000                MOVE PC-D                 TO ASC-LIST-SEQ-IND     17100099
171100             END-IF                                               17110099
171200       ELSE                                                       17120099
171300******COMING FROM LIST SCREEN                                     17130099
171400           IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                  17140099
171500               MOVE SU003-OPER-UNT-ID        TO ASC-OPER-UNT-ID   17150099
171600                                                DK-OPER-UNT-ID    17160099
171700               MOVE SU003-FCLTY-ID           TO ASC-FCLTY-ID      17170099
171800               MOVE SU003-FCLTY-NME          TO ASC-FCLTY-NME     17180099
171900               MOVE SU003-SCAC-CDE           TO ASC-SCAC-ID       17190099
172000               MOVE SU003-TRLR-NBR           TO ASC-TRLR-NUMBER   17200099
172100               MOVE SU003-TRIP-ID            TO ASC-TRIP-ID       17210099
172200               MOVE SU003-PO-NBR             TO ASC-PO-NUMBER     17220099
172300                                                PV-PO-NUMBER      17230099
172400               MOVE SU003-REC-SEQ-NBR        TO ASC-REC-SEQ-NBR   17240099
172500                                                PV-REC-SEQ-NBR    17250099
172600               SET ASC-USE-SELECTION-QUEUE   TO TRUE              17260099
172700               MOVE SU003-NUMBER-OF-TS-ITEMS TO                   17270099
172800                                            ASC-NUMBER-OF-TS-ITEMS17280099
172900               MOVE SU003-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME-IN 17290099
173000               PERFORM 1120-PREPARE-LIST-ENTRY                    17300099
173100           END-IF                                                 17310099
173200       END-IF                                                     17320099
173300     END-IF.                                                      17330099
173400                                                                  17340099
173500                                                                  17350099
173600******************************************************************17360099
173700 1120-PREPARE-LIST-ENTRY.                                         17370099
173800                                                                  17380099
173900     MOVE SU004-MAX-ITEMS          TO ASC-SEL-SUB.                17390099
174000     MOVE ZERO                     TO ASC-SEL-ITEM.               17400099
174100     PERFORM 1130-GET-NEXT-RECORD.                                17410099
174200                                                                  17420099
174300******************************************************************17430099
174400*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*17440099
174500******************************************************************17450099
174600 1130-GET-NEXT-RECORD.                                            17460099
174700                                                                  17470099
174800     ADD +1                       TO ASC-SEL-SUB.                 17480099
174900                                                                  17490099
175000     IF  ASC-SEL-SUB > SU004-MAX-ITEMS                            17500099
175100         ADD +1                   TO ASC-SEL-ITEM                 17510099
175200         MOVE +1                  TO ASC-SEL-SUB                  17520099
175300     END-IF.                                                      17530099
175400                                                                  17540099
175500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                17550099
175600         PERFORM 9100-READ-SEL-QUEUE                              17560099
175700         IF  SU004-ITEM (ASC-SEL-SUB) > ZERO                      17570099
175800             MOVE SU004-SCAC-CDE   (ASC-SEL-SUB)                  17580099
175900                                       TO ASC-SCAC-ID             17590099
176000             MOVE SU004-VEH-NBR     (ASC-SEL-SUB)                 17600099
176100                                       TO ASC-TRLR-NUMBER         17610099
176200             MOVE SU004-TRIP-ID   (ASC-SEL-SUB)                   17620099
176300                                       TO ASC-TRIP-ID             17630099
176400             MOVE SU004-PO-NBR    (ASC-SEL-SUB)                   17640099
176500                                       TO ASC-PO-NUMBER           17650099
176600             MOVE SU004-REC-SEQ-NBR (ASC-SEL-SUB)                 17660099
176700                                       TO ASC-REC-SEQ-NBR         17670099
176800             SET SU004-INQ (ASC-SEL-SUB)                          17680099
176900                                       TO TRUE                    17690099
177000             PERFORM 9200-REWRITE-SEL-QUEUE                       17700099
177100         ELSE                                                     17710099
177200             SUBTRACT +1 FROM ASC-SEL-SUB                         17720099
177300             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             17730099
177400             SET DP020-MSG-INFORMATIONAL                          17740099
177500                 PS-LIST-END             TO TRUE                  17750099
177600         END-IF                                                   17760099
177700     ELSE                                                         17770099
177800         SUBTRACT +1 FROM ASC-SEL-ITEM                            17780099
177900         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  17790099
178000         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             17800099
178100             SET DP020-MSG-INFORMATIONAL                          17810099
178200                 PS-LIST-END             TO TRUE                  17820099
178300     END-IF.                                                      17830099
178400                                                                  17840099
178500******************************************************************17850099
178600*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *17860099
178700*    PROCESSED.                                                  *17870099
178800******************************************************************17880099
178900 1140-GET-PREV-RECORD.                                            17890099
179000                                                                  17900099
179100     SUBTRACT +1 FROM ASC-SEL-SUB.                                17910099
179200                                                                  17920099
179300     IF  ASC-SEL-SUB < +1                                         17930099
179400         SUBTRACT +1 FROM ASC-SEL-ITEM                            17940099
179500         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  17950099
179600     END-IF.                                                      17960099
179700                                                                  17970099
179800     IF  ASC-SEL-ITEM > ZERO                                      17980099
179900         PERFORM 9100-READ-SEL-QUEUE                              17990099
180000         MOVE SU004-SCAC-CDE (ASC-SEL-SUB)    TO ASC-SCAC-ID      18000099
180100         MOVE SU004-VEH-NBR  (ASC-SEL-SUB)    TO ASC-TRLR-NUMBER  18010099
180200         MOVE SU004-TRIP-ID  (ASC-SEL-SUB)    TO ASC-TRIP-ID      18020099
180300         MOVE SU004-PO-NBR   (ASC-SEL-SUB)    TO ASC-PO-NUMBER    18030099
180400         MOVE SU004-REC-SEQ-NBR (ASC-SEL-SUB) TO ASC-REC-SEQ-NBR  18040099
180500         SET SU004-INQ (ASC-SEL-SUB)          TO TRUE             18050099
180600         PERFORM 9200-REWRITE-SEL-QUEUE                           18060099
180700     ELSE                                                         18070099
180800         MOVE +1                  TO ASC-SEL-ITEM                 18080099
180900                                     ASC-SEL-SUB                  18090099
181000         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             18100099
181100         SET DP020-MSG-INFORMATIONAL                              18110099
181200             PS-LIST-END             TO TRUE                      18120099
181300     END-IF.                                                      18130099
181400                                                                  18140099
181500*----------------------------------------------------------------*18150099
181600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *18160099
181700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *18170099
181800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *18180099
181900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *18190099
182000* FUNCTION KEYS CAN GET THIS FAR.                                *18200099
182100*----------------------------------------------------------------*18210099
182200 2000-PROCESS-PANEL.                                              18220099
182300     EVALUATE TRUE                                                18230099
182400         WHEN DP020-SRC-AID = DP016-CLEAR                         18240099
182500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    18250099
182600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18260099
182700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18270099
182800                                                                  18280099
182900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    18290099
183000             MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID             18300099
183100             MOVE ASC-FCLTY-ID      TO DK-FCLTY-ID                18310099
183200             MOVE ASC-LIST-SEQ-IND  TO DK-LIST-SEQ-IND            18320099
183300                                                                  18330099
183400             PERFORM 2050-DELETE-LIST-QUEUE                       18340099
183500             PERFORM 4000-BUILD-INITIAL-PANEL                     18350099
183600                                                                  18360099
183700         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    18370099
183800             PERFORM 2140-DESELECT-ALL-ITEMS                      18380099
183900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18390099
184000                                                                  18400099
184100         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  18410099
184200             PERFORM 2150-SELECT-ALL-ITEMS                        18420099
184300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18430099
184400                                                                  18440099
184500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             18450099
184600           IF  ASC-USE-SELECTION-QUEUE                            18460099
184700               PERFORM 1130-GET-NEXT-RECORD                       18470099
184800               IF PS-LIST-END                                     18480099
184900                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           18490099
185000                   SET PS-NO-LIST-END TO TRUE                     18500099
185100               ELSE                                               18510099
185200                   PERFORM 2050-DELETE-LIST-QUEUE                 18520099
185300                   PERFORM 3200-RESET-ATTRIBUTES                  18530099
185400                   PERFORM 4000-BUILD-INITIAL-PANEL               18540099
185500               END-IF                                             18550099
185600            ELSE                                                  18560099
185700               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               18570099
185800*              --- BOTTOM OF LIST ---                             18580099
185900               MOVE PC-TSYMSG-00070         TO DP020-MSG-NUMBER   18590099
186000               SET DP020-MSG-INFORMATIONAL  TO TRUE               18600099
186100           END-IF                                                 18610099
186200                                                                  18620099
186300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             18630099
186400           IF  ASC-USE-SELECTION-QUEUE                            18640099
186500               PERFORM 1140-GET-PREV-RECORD                       18650099
186600               IF PS-LIST-END                                     18660099
186700                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           18670099
186800                   SET PS-NO-LIST-END TO TRUE                     18680099
186900               ELSE                                               18690099
187000                   PERFORM 2050-DELETE-LIST-QUEUE                 18700099
187100                   PERFORM 3200-RESET-ATTRIBUTES                  18710099
187200                   PERFORM 4000-BUILD-INITIAL-PANEL               18720099
187300               END-IF                                             18730099
187400           ELSE                                                   18740099
187500               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               18750099
187600               MOVE PC-TSYMSG-00069        TO DP020-MSG-NUMBER    18760099
187700               SET DP020-MSG-INFORMATIONAL TO TRUE                18770099
187800           END-IF                                                 18780099
187900                                                                  18790099
188000         WHEN OTHER                                               18800099
188100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 18810099
188200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18820099
188300             IF  PS-NO-ERROR                                      18830099
188400                 SET DP030-CONTINUE-GO  TO TRUE                   18840099
188500                 PERFORM 2100-CHECK-FUNCTION-KEY                  18850099
188600             ELSE                                                 18860099
188700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18870099
188800                 SET DP030-OVERRIDE-GO  TO TRUE                   18880099
188900             END-IF                                               18890099
189000     END-EVALUATE.                                                18900099
189100                                                                  18910099
189200*----------------------------------------------------------------*18920099
189300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *18930099
189400*----------------------------------------------------------------*18940099
189500 2050-DELETE-LIST-QUEUE.                                          18950099
189600                                                                  18960099
189700     EXEC CICS                                                    18970099
189800         DELETEQ TS                                               18980099
189900             QUEUE (ASC-LIST-QUEUE-NAME)                          18990099
190000             RESP  (PV-CICS-RESP)                                 19000099
190100     END-EXEC.                                                    19010099
190200                                                                  19020099
190300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       19030099
190400        (PV-CICS-RESP = DFHRESP(QIDERR))                          19040099
190500         CONTINUE                                                 19050099
190600     ELSE                                                         19060099
190700         SET DP013-CICS-ABEND      TO TRUE                        19070099
190800         SET DP013-NO-ROLLBACK     TO TRUE                        19080099
190900                                                                  19090099
191000         MOVE '2050-DELETE-LIST-QUEUE'                            19100099
191100                                   TO DP013-PARAGRAPH             19110099
191200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    19120099
191300                                   TO DP013-MESSAGE-TEXT (1)      19130099
191400         PERFORM DP013-0000-PROCESS-ABEND                         19140099
191500     END-IF.                                                      19150099
191600                                                                  19160099
191700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  19170099
191800                                                                  19180099
191900*----------------------------------------------------------------*19190099
192000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*19200099
192100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *19210099
192200* CICS ARCHITECTURE API.                                         *19220099
192300*----------------------------------------------------------------*19230099
192400 2100-CHECK-FUNCTION-KEY.                                         19240099
192500     SET SU003-UPDATE-TSQ TO TRUE.                                19250099
192600     EVALUATE TRUE                                                19260099
192700                                                                  19270099
192800*** F13 **PBS SMOOTHING** (PCKCS709)                              19280099
192900         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              19290099
193000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              19300099
193100                 INITIALIZE PC236-INTER-APPL-COMMAREA             19310099
193200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                19320099
193300                                TO PC236-NUMBER-OF-SELECTED-ITEMS 19330099
193400                 MOVE ASC-OPER-UNT-ID  TO PC236-OPER-UNT-ID       19340099
193500                 MOVE ASC-FCLTY-ID     TO PC236-FCLTY-ID          19350099
193600                 PERFORM 5000-PREPARE-SEL-QUEUE                   19360099
193700                 SET ASC-FUNC04-RETURN-YES TO TRUE                19370099
193800                 IF PS-RECEIVER-DOESNT-EXIST                      19380099
193900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         19390099
194000                     SET DP030-OVERRIDE-GO  TO TRUE               19400099
194100                     MOVE PC-TSYMSG-02479   TO DP020-MSG-NUMBER   19410099
194200                     SET DP020-MSG-WARNING  TO TRUE               19420099
194300                 END-IF                                           19430099
194400             ELSE                                                 19440099
194500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19450099
194600                 SET DP030-OVERRIDE-GO  TO TRUE                   19460099
194700                 MOVE PC-TSYMSG-00057   TO DP020-MSG-NUMBER       19470099
194800                 SET DP020-MSG-WARNING  TO TRUE                   19480099
194900             END-IF                                               19490099
195000                                                                  19500099
195100*** F14 **RCVRING** (RCKCS223)                                    19510099
195200         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              19520099
195300             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              19530099
195400                 INITIALIZE RC015-INTER-APPL-COMMAREA             19540099
195500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                19550099
195600                                TO RC015-NUMBER-OF-SELECTED-ITEMS 19560099
195700                 MOVE ASC-OPER-UNT-ID  TO RC015-OPER-UNT-ID       19570099
195800                 MOVE ASC-FCLTY-ID     TO RC015-FCLTY-ID          19580099
195900                                                                  19590099
196000                 PERFORM 5000-PREPARE-SEL-QUEUE                   19600099
196100                 SET ASC-FUNC05-RETURN-YES TO TRUE                19610099
196200                 IF PS-RECEIVER-DOESNT-EXIST                      19620099
196300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         19630099
196400                     SET DP030-OVERRIDE-GO  TO TRUE               19640099
196500                     MOVE PC-TSYMSG-02479   TO DP020-MSG-NUMBER   19650099
196600                     SET DP020-MSG-WARNING  TO TRUE               19660099
196700                 END-IF                                           19670099
196800             ELSE                                                 19680099
196900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19690099
197000                 SET DP030-OVERRIDE-GO  TO TRUE                   19700099
197100                 MOVE PC-TSYMSG-00057   TO DP020-MSG-NUMBER       19710099
197200                 SET DP020-MSG-WARNING  TO TRUE                   19720099
197300             END-IF                                               19730099
197400                                                                  19740099
197500****F16 **LIST SEQUENCE**                                         19750099
197600*        SELECT BETWEEN S=SCAC/TRLR, A=ASCENDING DATE,            19760099
197700*                       D=DESCENDING DATE                         19770099
197800*                                                                 19780099
197900         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              19790099
198000*EDIT TO MAKE SURE S, A OR D ENTERED                              19800099
198100             MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID             19810099
198200             MOVE ASC-FCLTY-ID      TO DK-FCLTY-ID                19820099
198300             MOVE ASC-LIST-SEQ-IND  TO DK-LIST-SEQ-IND            19830099
198400                                                                  19840099
198500             PERFORM 2050-DELETE-LIST-QUEUE                       19850099
198600             PERFORM 4000-BUILD-INITIAL-PANEL                     19860099
198700                                                                  19870099
198800****F17 **PACKSLIP LIST** (RCKCS213)                              19880099
198900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              19890099
199000             INITIALIZE RC015-INTER-APPL-COMMAREA                 19900099
199100             MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO                 19910099
199200                                   RC015-NUMBER-OF-SELECTED-ITEMS 19920099
199300             MOVE ASC-OPER-UNT-ID   TO RC015-OPER-UNT-ID          19930099
199400             MOVE ASC-FCLTY-ID      TO RC015-FCLTY-ID             19940099
199500             PERFORM 5000-PREPARE-SEL-QUEUE                       19950099
199600             SET ASC-FUNC01-RETURN-YES TO TRUE                    19960099
199700                                                                  19970099
199800****F18 **TROUBLE LIST** (TMKCS532)                               19980099
199900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              19990099
200000             INITIALIZE RC015-INTER-APPL-COMMAREA                 20000099
200100             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    20010099
200200                            TO RC015-NUMBER-OF-SELECTED-ITEMS     20020099
200300             MOVE ASC-OPER-UNT-ID  TO RC015-OPER-UNT-ID           20030099
200400             MOVE ASC-FCLTY-ID     TO RC015-FCLTY-ID              20040099
200500             MOVE ASC-PO-NUMBER    TO RC015-PO-NBR                20050099
200600             MOVE ASC-REC-SEQ-NBR  TO RC015-REC-SEQ-NBR           20060099
200700             PERFORM 5000-PREPARE-SEL-QUEUE                       20070099
200800             SET ASC-FUNC02-RETURN-YES TO TRUE                    20080099
200900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > +0                20090099
201000                 PERFORM 7000-FORMAT-COMMAREA                     20100099
201100             END-IF                                               20110099
201200                                                                  20120099
201300****F22 **CREATE LABELS ** (PCKCS701)                             20130099
201400         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              20140099
201500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              20150099
201600                 INITIALIZE RC815-INTER-APPL-COMMAREA             20160099
201700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                20170099
201800                                 TO RC815-NUMBER-OF-SELECTED-ITEMS20180099
201900                 MOVE ASC-OPER-UNT-ID TO  RC815-OPER-UNT-ID       20190099
202000                 MOVE ASC-FCLTY-ID    TO  RC815-FCLTY-ID          20200099
202100                 PERFORM 5000-PREPARE-SEL-QUEUE                   20210099
202200                 SET ASC-FUNC06-RETURN-YES TO TRUE                20220099
202300             ELSE                                                 20230099
202400                 IF  PV-PBS                                       20240099
202500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         20250099
202600                     SET DP030-OVERRIDE-GO  TO TRUE               20260099
202700                     MOVE PC-TSYMSG-01803   TO DP020-MSG-NUMBER   20270099
202800                     SET DP020-MSG-WARNING  TO TRUE               20280099
202900                 ELSE                                             20290099
203000                     IF  PS-NONTRANSCRIBED-RCVR                   20300099
203100                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     20310099
203200                         SET DP030-OVERRIDE-GO TO TRUE            20320099
203300                         MOVE PC-TSYMSG-03228  TO DP020-MSG-NUMBER20330099
203400                         SET DP020-MSG-WARNING TO TRUE            20340099
203500                     ELSE                                         20350099
203600                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     20360099
203700                         SET DP030-OVERRIDE-GO TO TRUE            20370099
203800                         MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER20380099
203900                         SET DP020-MSG-WARNING TO TRUE            20390099
204000                     END-IF                                       20400099
204100                 END-IF                                           20410099
204200             END-IF                                               20420099
204300                                                                  20430099
204400****F23 **CARTON LIST ** (SUKCS555)                               20440099
204500         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              20450099
204600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              20460099
204700                  INITIALIZE SU003-INTER-APPL-COMMAREA            20470099
204800                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               20480099
204900                                 TO SU003-NUMBER-OF-SELECTED-ITEMS20490099
205000                  MOVE ASC-PO-NUMBER   TO SU003-PO-NBR            20500099
205100                  MOVE ASC-REC-SEQ-NBR TO SU003-REC-SEQ-NBR       20510099
205200                  MOVE ASC-OPER-UNT-ID TO SU003-OPER-UNT-ID       20520099
205300                  MOVE ASC-FCLTY-ID    TO SU003-FCLTY-ID          20530099
205400                  PERFORM 5000-PREPARE-SEL-QUEUE                  20540099
205500                  SET ASC-FUNC07-RETURN-YES TO TRUE               20550099
205600             ELSE                                                 20560099
205700                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            20570099
205800                  SET DP030-OVERRIDE-GO TO TRUE                   20580099
205900                  MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER       20590099
206000                  SET DP020-MSG-WARNING TO TRUE                   20600099
206100             END-IF                                               20610099
206200                                                                  20620099
206300****F24 **TRAILER LIST** (RCKCS815)                               20630099
206400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              20640099
206500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              20650099
206600                 INITIALIZE SU003-INTER-APPL-COMMAREA             20660099
206700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                20670099
206800                                TO SU003-NUMBER-OF-SELECTED-ITEMS 20680099
206900                 MOVE ASC-OPER-UNT-ID  TO SU003-OPER-UNT-ID       20690099
207000                 MOVE ASC-FCLTY-ID     TO SU003-FCLTY-ID          20700099
207100                 MOVE ASC-FCLTY-NME    TO SU003-FCLTY-NME         20710099
207200                 MOVE ASC-SCAC-ID      TO SU003-SCAC-CDE          20720099
207300                 MOVE ASC-TRLR-NUMBER  TO SU003-TRLR-NBR          20730099
207400                 MOVE ASC-TRIP-ID      TO SU003-TRIP-ID           20740099
207500                 PERFORM 5000-PREPARE-SEL-QUEUE                   20750099
207600                 SET ASC-FUNC03-RETURN-YES TO TRUE                20760099
207700             ELSE                                                 20770099
207800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             20780099
207900                 SET DP030-OVERRIDE-GO   TO TRUE                  20790099
208000                 MOVE PC-TSYMSG-00057    TO DP020-MSG-NUMBER      20800099
208100                 SET DP020-MSG-WARNING   TO TRUE                  20810099
208200             END-IF                                               20820099
208300                                                                  20830099
208400*                                                                 20840099
208500* F6 - FIRST PAGE                                                 20850099
208600*                                                                 20860099
208700         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  20870099
208800             MOVE +1               TO PV-TOP-ITEM                 20880099
208900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20890099
209000*                                                                 20900099
209100* F7 - PREVIOUS PAGE                                              20910099
209200*                                                                 20920099
209300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   20930099
209400             PERFORM 2110-BROWSE-BACKWARD                         20940099
209500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20950099
209600*                                                                 20960099
209700* F8 - NEXT PAGE                                                  20970099
209800*                                                                 20980099
209900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   20990099
210000             PERFORM 2120-BROWSE-FORWARD                          21000099
210100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 21010099
210200*                                                                 21020099
210300* ENTER KEY                                                       21030099
210400*                                                                 21040099
210500         WHEN DP020-SRC-AID = DP016-ENTER                         21050099
210600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   21060099
210700             IF  PS-ERROR                                         21070099
210800                 CONTINUE                                         21080099
210900             ELSE                                                 21090099
211000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             21100099
211100             END-IF                                               21110099
211200                                                                  21120099
211300         WHEN OTHER                                               21130099
211400             SET DP013-NO-ROLLBACK                                21140099
211500                 DP013-XCTL-DISPLAY-RESTART                       21150099
211600                 DP013-CICS-ABEND  TO TRUE                        21160099
211700             MOVE '2100-CHECK-FUNCTION-KEY'                       21170099
211800                                   TO DP013-PARAGRAPH             21180099
211900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      21190099
212000                                   TO DP013-MESSAGE-TEXT (1)      21200099
212100             PERFORM DP013-0000-PROCESS-ABEND                     21210099
212200     END-EVALUATE.                                                21220099
212300*                                                                 21230099
212400*----------------------------------------------------------------*21240099
212500*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *21250099
212600*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *21260099
212700*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *21270099
212800*    MESSAGE.                                                    *21280099
212900*----------------------------------------------------------------*21290099
213000 2110-BROWSE-BACKWARD.                                            21300099
213100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    21310099
213200         GIVING PV-TOP-ITEM.                                      21320099
213300                                                                  21330099
213400     IF  ((PV-TOP-ITEM < +1)                                      21340099
213500       OR (PV-TOP-ITEM = +1))                                     21350099
213600         MOVE +1                   TO PV-TOP-ITEM                 21360099
213700*        -- TOP OF LIST --                                        21370099
213800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            21380099
213900         SET DP020-MSG-INFORMATIONAL TO TRUE                      21390099
214000     END-IF.                                                      21400099
214100                                                                  21410099
214200*----------------------------------------------------------------*21420099
214300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *21430099
214400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *21440099
214500*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *21450099
214600*----------------------------------------------------------------*21460099
214700 2120-BROWSE-FORWARD.                                             21470099
214800                                                                  21480099
214900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              21490099
215000         GIVING PV-TOP-ITEM.                                      21500099
215100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   21510099
215200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            21520099
215300                                   TO PV-TOP-ITEM                 21530099
215400*        -- BOTTOM OF LIST --                                     21540099
215500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            21550099
215600         SET DP020-MSG-INFORMATIONAL                              21560099
215700                                   TO TRUE                        21570099
215800     ELSE                                                         21580099
215900         COMPUTE PV-BOTTOM-ITEM =                                 21590099
216000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 21600099
216100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            21610099
216200*            -- BOTTOM OF LIST --                                 21620099
216300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            21630099
216400             SET DP020-MSG-INFORMATIONAL                          21640099
216500                                   TO TRUE                        21650099
216600         END-IF                                                   21660099
216700     END-IF.                                                      21670099
216800                                                                  21680099
216900*----------------------------------------------------------------*21690099
217000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *21700099
217100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *21710099
217200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *21720099
217300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *21730099
217400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *21740099
217500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *21750099
217600*----------------------------------------------------------------*21760099
217700 2130-CHECK-FOR-JUMP-BROWSE.                                      21770099
217800     SET PS-NO-ERROR               TO TRUE.                       21780099
217900     IF (ASC-START-ITEM-REQUEST = SPACE)                          21790099
218000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            21800099
218100                                   TO PV-TOP-ITEM                 21810099
218200     ELSE                                                         21820099
218300         MOVE ASC-START-ITEM-REQUEST                              21830099
218400                                   TO DP010I-UNEDITED-FIELD       21840099
218500         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     21850099
218600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       21860099
218700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  21870099
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21890099
273427              USING DP010I-NUMERIC-EDIT-AREA                      21891099
218900                                                                  21892099
219000         IF  NOT DP010I-ERROR-DETECTED                            21900099
219100             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N21910099
219200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  21920099
219300                 IF  ASC-START-ITEM-REQUEST-N >                   21930099
219400                                          ASC-NUMBER-OF-ITEMS-READ21940099
219500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         21950099
219600                     COMPUTE PV-TOP-ITEM =                        21960099
219700                             ASC-NUMBER-OF-ITEMS-READ             21970099
219800                             - PC-ITEMS-PER-PANEL + 1             21980099
219900                     IF  PV-TOP-ITEM < +1                         21990099
220000                         MOVE +1   TO PV-TOP-ITEM                 22000099
220100                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 22010099
220200                         SET DP020-MSG-INFORMATIONAL TO TRUE      22020099
220300                     ELSE                                         22030099
220400                         MOVE PV-TOP-ITEM                         22040099
220500                                   TO ASC-START-ITEM-REQUEST-N    22050099
220600                     END-IF                                       22060099
220700                 ELSE                                             22070099
220800                     MOVE ASC-START-ITEM-REQUEST-N                22080099
220900                                   TO PV-TOP-ITEM                 22090099
221000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      22100099
221100                     COMPUTE PV-BOTTOM-ITEM =                     22110099
221200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     22120099
221300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ22130099
221400                         SUBTRACT  PV-TOP-ITEM                    22140099
221500                             FROM  ASC-NUMBER-OF-ITEMS-READ       22150099
221600                           GIVING  ASC-ITEMS-DISPLAYED            22160099
221700                         MOVE  ASC-NUMBER-OF-ITEMS-READ           22170099
221800                           TO  PV-BOTTOM-ITEM                     22180099
221900*                        -- BOTTOM OF LIST --                     22190099
222000                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 22200099
222100                         SET DP020-MSG-INFORMATIONAL TO TRUE      22210099
222200                     END-IF                                       22220099
222300                 END-IF                                           22230099
222400             ELSE                                                 22240099
222500*                --- VALUE OUT OF RANGE ----                      22250099
222600                 MOVE PC-TSYMSG-00101        TO DP020-MSG-NUMBER  22260099
222700                 MOVE -1                     TO ASTRTITL          22270099
222800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              22280099
222900                 MOVE DP015-REVERSE          TO ASTRTITH          22290099
223000                 MOVE DP015-RED              TO ASTRTITC          22300099
223100                 MOVE DP015-UNP-NUM-BRT-MDT  TO ASTRTITA          22310099
223200                 SET DP020-MSG-FATAL         TO TRUE              22320099
223300                 SET PS-ERROR                TO TRUE              22330099
223400             END-IF                                               22340099
223500         ELSE                                                     22350099
223600             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      22360099
223700             MOVE -1                     TO ASTRTITL              22370099
223800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  22380099
223900             MOVE DP015-REVERSE          TO ASTRTITH              22390099
224000             MOVE DP015-RED              TO ASTRTITC              22400099
224100             MOVE DP015-UNP-NUM-BRT-MDT  TO ASTRTITA              22410099
224200             SET DP020-MSG-FATAL         TO TRUE                  22420099
224300             SET PS-ERROR                TO TRUE                  22430099
224400         END-IF                                                   22440099
224500     END-IF.                                                      22450099
224600                                                                  22460099
224700*----------------------------------------------------------------*22470099
224800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *22480099
224900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *22490099
225000*----------------------------------------------------------------*22500099
225100 2140-DESELECT-ALL-ITEMS.                                         22510099
225200     MOVE +1                       TO ASC-BLK-SUB.                22520099
225300                                                                  22530099
225400     PERFORM 2141-CLEAR-SELECTED-INDS                             22540099
225500         VARYING ASC-ITEM-SUB                                     22550099
225600         FROM 1 BY 1                                              22560099
225700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22570099
225800                                                                  22580099
225900     ADD +1                        TO ASC-BLK-SUB.                22590099
226000                                                                  22600099
226100     PERFORM 2141-CLEAR-SELECTED-INDS                             22610099
226200         VARYING ASC-ITEM-SUB                                     22620099
226300         FROM 1 BY 1                                              22630099
226400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22640099
226500                                                                  22650099
226600     MOVE ASC-LIST-ITEM-NUMBER(1 1)  TO PV-LIST-ITEM-NUMBER.      22660099
226700                                                                  22670099
226800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            22680099
226900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    22690099
227000                                                                  22700099
227100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     22710099
227200        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      22720099
227300         MOVE +1                   TO ASC-BLK-SUB                 22730099
227400                                                                  22740099
227500         PERFORM 5100-WRITE-TEMP-STORAGE                          22750099
227600         MOVE +2                   TO ASC-BLK-SUB                 22760099
227700         PERFORM 5100-WRITE-TEMP-STORAGE                          22770099
227800         MOVE +1                   TO ASC-BLK-SUB                 22780099
227900                                                                  22790099
228000         MOVE +1                   TO PV-BLOCK-NUMBER             22800099
228100                                                                  22810099
228200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         22820099
228300             PV-FIRST-BLOCK-IN-ARRAY - 1                          22830099
228400                                                                  22840099
228500         PERFORM                                                  22850099
228600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       22860099
228700                                                                  22870099
228800             PERFORM 4410-READ-TEMP-STORAGE                       22880099
228900                                                                  22890099
229000             PERFORM 2141-CLEAR-SELECTED-INDS                     22900099
229100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 22910099
229200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22920099
229300                                                                  22930099
229400             PERFORM 5100-WRITE-TEMP-STORAGE                      22940099
229500             ADD +1                TO PV-BLOCK-NUMBER             22950099
229600         END-PERFORM                                              22960099
229700                                                                  22970099
229800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         22980099
229900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     22990099
230000                                                                  23000099
230100         PERFORM                                                  23010099
230200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23020099
230300                   ASC-HIGHEST-BLOCK-WRITTEN                      23030099
230400                                                                  23040099
230500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          23050099
230600                                   TO PV-BLOCK-NUMBER             23060099
230700             PERFORM 4410-READ-TEMP-STORAGE                       23070099
230800                                                                  23080099
230900             PERFORM 2141-CLEAR-SELECTED-INDS                     23090099
231000                 VARYING ASC-ITEM-SUB                             23100099
231100                 FROM 1 BY 1                                      23110099
231200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23120099
231300                                                                  23130099
231400             PERFORM 5100-WRITE-TEMP-STORAGE                      23140099
231500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23150099
231600         END-PERFORM                                              23160099
231700                                                                  23170099
231800         MOVE PV-FIRST-BLOCK-IN-ARRAY  TO PV-BLOCK-NUMBER         23180099
231900                                                                  23190099
232000         PERFORM 4410-READ-TEMP-STORAGE                           23200099
232100     END-IF.                                                      23210099
232200                                                                  23220099
232300     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 23230099
232400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.23240099
232500     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  23250099
232600                                                                  23260099
232700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        23270099
232800                                                                  23280099
232900*----------------------------------------------------------------*23290099
233000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *23300099
233100*----------------------------------------------------------------*23310099
233200 2141-CLEAR-SELECTED-INDS.                                        23320099
233300                                                                  23330099
233400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           23340099
233500             NOT EQUAL ZERO                                       23350099
233600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23360099
233700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23370099
233800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    23380099
233900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  23390099
234000                                   TO TRUE                        23400099
234100         END-IF                                                   23410099
234200     END-IF.                                                      23420099
234300                                                                  23430099
234400*----------------------------------------------------------------*23440099
234500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *23450099
234600*  FOR ALL ITEMS.                                                *23460099
234700*----------------------------------------------------------------*23470099
234800 2150-SELECT-ALL-ITEMS.                                           23480099
234900                                                                  23490099
235000     MOVE +1                       TO ASC-BLK-SUB.                23500099
235100                                                                  23510099
235200     PERFORM 2151-SET-SELECTED-INDS                               23520099
235300         VARYING ASC-ITEM-SUB                                     23530099
235400         FROM 1 BY 1                                              23540099
235500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23550099
235600                                                                  23560099
235700     ADD +1                        TO ASC-BLK-SUB.                23570099
235800                                                                  23580099
235900     PERFORM 2151-SET-SELECTED-INDS                               23590099
236000         VARYING ASC-ITEM-SUB                                     23600099
236100         FROM 1 BY 1                                              23610099
236200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23620099
236300                                                                  23630099
236400     MOVE ASC-LIST-ITEM-NUMBER(1 1)   TO PV-LIST-ITEM-NUMBER.     23640099
236500                                                                  23650099
236600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23660099
236700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    23670099
236800                                                                  23680099
236900*10/13/00- BEGIN                                                  23690099
237000     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            23700099
237100         MOVE +1                   TO ASC-BLK-SUB                 23710099
237200                                                                  23720099
237300         PERFORM 5100-WRITE-TEMP-STORAGE                          23730099
237400         MOVE +2                   TO ASC-BLK-SUB                 23740099
237500         PERFORM 5100-WRITE-TEMP-STORAGE                          23750099
237600         MOVE +1                   TO ASC-BLK-SUB                 23760099
237700         MOVE +1                   TO PV-BLOCK-NUMBER             23770099
237800     END-IF.                                                      23780099
237900* 10/13/00 END                                                    23790099
238000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     23800099
238100        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    23810099
238200         MOVE +1                   TO ASC-BLK-SUB                 23820099
238300                                                                  23830099
238400         PERFORM 5100-WRITE-TEMP-STORAGE                          23840099
238500         MOVE +2                   TO ASC-BLK-SUB                 23850099
238600         PERFORM 5100-WRITE-TEMP-STORAGE                          23860099
238700         MOVE +1                   TO ASC-BLK-SUB                 23870099
238800         MOVE +1                   TO PV-BLOCK-NUMBER             23880099
238900                                                                  23890099
239000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23900099
239100             PV-FIRST-BLOCK-IN-ARRAY - 1                          23910099
239200                                                                  23920099
239300         PERFORM                                                  23930099
239400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       23940099
239500                                                                  23950099
239600             PERFORM 4410-READ-TEMP-STORAGE                       23960099
239700                                                                  23970099
239800             PERFORM 2151-SET-SELECTED-INDS                       23980099
239900                 VARYING ASC-ITEM-SUB                             23990099
240000                 FROM 1 BY 1                                      24000099
240100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24010099
240200                                                                  24020099
240300             PERFORM 5100-WRITE-TEMP-STORAGE                      24030099
240400                                                                  24040099
240500             ADD +1                TO PV-BLOCK-NUMBER             24050099
240600         END-PERFORM                                              24060099
240700                                                                  24070099
240800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24080099
240900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24090099
241000                                                                  24100099
241100         PERFORM                                                  24110099
241200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24120099
241300                   ASC-HIGHEST-BLOCK-WRITTEN                      24130099
241400                                                                  24140099
241500             MOVE PV-NEXT-BLOCK-IN-ARRAY   TO PV-BLOCK-NUMBER     24150099
241600                                                                  24160099
241700             PERFORM 4410-READ-TEMP-STORAGE                       24170099
241800                                                                  24180099
241900             PERFORM 2151-SET-SELECTED-INDS                       24190099
242000                 VARYING ASC-ITEM-SUB                             24200099
242100                 FROM 1 BY 1                                      24210099
242200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24220099
242300                                                                  24230099
242400             PERFORM 5100-WRITE-TEMP-STORAGE                      24240099
242500                                                                  24250099
242600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24260099
242700         END-PERFORM                                              24270099
242800                                                                  24280099
242900         MOVE PV-FIRST-BLOCK-IN-ARRAY     TO PV-BLOCK-NUMBER      24290099
243000         PERFORM 4410-READ-TEMP-STORAGE                           24300099
243100     END-IF.                                                      24310099
243200                                                                  24320099
243300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             24330099
243400                       ASC-NUMBER-OF-SELECTED-ITEMS.              24340099
243500                                                                  24350099
243600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        24360099
243700                                                                  24370099
243800*----------------------------------------------------------------*24380099
243900*    MARK EACH ITEM AS BEING SELECTED.                           *24390099
244000*----------------------------------------------------------------*24400099
244100 2151-SET-SELECTED-INDS.                                          24410099
244200                                                                  24420099
244300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           24430099
244400             NOT EQUAL ZERO                                       24440099
244500         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             24450099
244600             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             24460099
244700                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        24470099
244800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  24480099
244900                               TO  TRUE                           24490099
245000         END-IF                                                   24500099
245100     END-IF.                                                      24510099
245200                                                                  24520099
245300******************************************************************24530099
245400** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **24540099
245500** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **24550099
245600******************************************************************24560099
245700 2200-MOVE-SCREEN-TO-COMMAREA.                                    24570099
245800                                                                  24580099
245900     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             24590099
246000     MOVE +1                       TO PV-SUB.                     24600099
246100                                                                  24610099
246200     PERFORM 3100-SET-SUBSCRIPTS.                                 24620099
246300     IF  ASTRTITL > ZERO                                          24630099
246400         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          24640099
246500     ELSE                                                         24650099
246600         IF  ASTRTITF = DP015-ERASE-EOF                           24660099
246700             INITIALIZE ASC-START-ITEM-REQUEST                    24670099
246800         END-IF                                                   24680099
246900     END-IF.                                                      24690099
247000     IF  ALSTSEQL > ZERO                                          24700099
247100         MOVE ALSTSEQI         TO ASC-LIST-SEQ-IND                24710099
247200         EVALUATE TRUE                                            24720099
247300            WHEN ALSTSEQI = PC-S                                  24730099
247400               SET ASC-LIST-SEQ-VALID TO TRUE                     24740099
247500            WHEN ALSTSEQI = PC-A                                  24750099
247600               SET ASC-LIST-SEQ-VALID TO TRUE                     24760099
247700            WHEN ALSTSEQI = PC-D                                  24770099
247800               SET ASC-LIST-SEQ-VALID TO TRUE                     24780099
247900            WHEN OTHER                                            24790099
248000               SET ASC-LIST-SEQ-NOT-VALID TO TRUE                 24800099
248100               SET PS-ERROR               TO TRUE                 24810099
248200         END-EVALUATE                                             24820099
248300     ELSE                                                         24830099
248400         IF  ALSTSEQF = DP015-ERASE-EOF                           24840099
248500             INITIALIZE ASC-LIST-SEQ-IND                          24850099
248600         END-IF                                                   24860099
248700     END-IF.                                                      24870099
248800                                                                  24880099
248900     IF PS-NO-ERROR                                               24890099
249000         PERFORM 2210-MOVE-LINES-TO-COMMAREA                      24900099
249100             VARYING PV-SUB                                       24910099
249200             FROM 1 BY 1                                          24920099
249300             UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                   24930099
249400     END-IF.                                                      24940099
249500                                                                  24950099
249600******************************************************************24960099
249700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**24970099
249800******************************************************************24980099
249900 2210-MOVE-LINES-TO-COMMAREA.                                     24990099
250000     IF  MR-SELECTL (PV-SUB) > ZERO                               25000099
250100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             25010099
250200         MOVE MR-SELECTI (PV-SUB)                                 25020099
250300                                   TO ASC-TEMP-SELECTED-SW        25030099
250400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      25040099
250500     ELSE                                                         25050099
250600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                25060099
250700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     25070099
250800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        25080099
250900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      25090099
251000         END-IF                                                   25100099
251100     END-IF.                                                      25110099
251200     ADD +1                        TO ASC-ITEM-SUB.               25120099
251300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        25130099
251400         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     25140099
251500             COMPUTE PV-BLOCK-NUMBER  =                           25150099
251600                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         25160099
251700                    PC-ITEMS-PER-PANEL                            25170099
251800             PERFORM 5105-REWRITE-ASC-LISTQ                       25180099
251900         END-IF                                                   25190099
252000         ADD +1                    TO ASC-BLK-SUB                 25200099
252100         MOVE +1                   TO ASC-ITEM-SUB                25210099
252200     ELSE                                                         25220099
252300     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             25230099
252400         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     25240099
252500             COMPUTE PV-BLOCK-NUMBER  =                           25250099
252600                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         25260099
252700                    PC-ITEMS-PER-PANEL                            25270099
252800             PERFORM 5105-REWRITE-ASC-LISTQ                       25280099
252900         END-IF                                                   25290099
253000     END-IF.                                                      25300099
253100******************************************************************25310099
253200** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **25320099
253300** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **25330099
253400******************************************************************25340099
253500 3000-EDIT-DATA-IN-COMMAREA.                                      25350099
253600     SET PS-NO-ERROR               TO TRUE.                       25360099
253700     PERFORM 3200-RESET-ATTRIBUTES.                               25370099
253800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     25380099
253900                                                                  25390099
254000     IF  ASC-LIST-SEQ-IND > SPACES                                25400099
254100         IF  PS-NO-ERROR                                          25410099
254200             IF  ASC-LIST-SEQ-VALID                               25420099
254300                 CONTINUE                                         25430099
254400             ELSE                                                 25440099
254500                 SET PS-ERROR                                     25450099
254600                 DP020-MSG-FATAL             TO TRUE              25460099
254700                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  25470099
254800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALSTSEQA          25480099
254900                 MOVE DP015-RED              TO ALSTSEQC          25490099
255000                 MOVE DP015-REVERSE          TO ALSTSEQH          25500099
255100                 MOVE -1                     TO ALSTSEQL          25510099
255200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              25520099
255300             END-IF                                               25530099
255400         END-IF                                                   25540099
255500     END-IF.                                                      25550099
255600**                                                                25560099
255700* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              25570099
255800* EDITTING IS DONE FROM THE BOTTOM UP.                            25580099
255900**                                                                25590099
256000     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       25600099
256100         ASC-ITEMS-DISPLAYED - 1.                                 25610099
256200     PERFORM 3100-SET-SUBSCRIPTS.                                 25620099
256300                                                                  25630099
256400     IF  PS-NO-ERROR                                              25640099
256500         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        25650099
256600     END-IF.                                                      25660099
256700                                                                  25670099
256800     IF  PS-NO-ERROR                                              25680099
256900         PERFORM 3400-CHECK-RANGE-SEQUENCE                        25690099
257000     END-IF.                                                      25700099
257100                                                                  25710099
257200     IF  ((PS-NO-ERROR)                                           25720099
257300       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   25730099
257400       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    25740099
257500             PERFORM 3500-MARK-RANGE-AS-SELECTED                  25750099
257600     END-IF.                                                      25760099
257700                                                                  25770099
257800*----------------------------------------------------------------*25780099
257900*   3005-EDIT-COMMAREA-BLOCKS                                    *25790099
258000*----------------------------------------------------------------*25800099
258100 3005-EDIT-COMMAREA-BLOCKS.                                       25810099
258200     MOVE +1                       TO PV-BLOCK-NUMBER.            25820099
258300     MOVE +1                       TO ASC-BLK-SUB.                25830099
258400     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               25840099
258500                                                                  25850099
258600     COMPUTE PV-BLOCK-NUMBER  =                                   25860099
258700        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 25870099
258800            PC-ITEMS-PER-PANEL.                                   25880099
258900                                                                  25890099
259000     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          25900099
259100                                                                  25910099
259200     PERFORM                                                      25920099
259300       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          25930099
259400          OR PS-ERROR                                             25940099
259500          OR PS-BLOCK-ERROR                                       25950099
259600                                                                  25960099
259700             COMPUTE PV-ITEMS-HOLD  =                             25970099
259800                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        25980099
259900                     PC-ITEMS-PER-PANEL - 1                       25990099
260000                                                                  26000099
260100             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       26010099
260200                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               26020099
260300                     FROM  PV-ITEMS-HOLD                          26030099
260400                   GIVING  PV-ITEMS-DIFF                          26040099
260500                 SUBTRACT  PV-ITEMS-DIFF                          26050099
260600                     FROM  PC-ITEMS-PER-PANEL                     26060099
260700                   GIVING  PV-ITEMS-HOLD                          26070099
260800                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              26080099
260900                                              ASC-ITEM-SUB        26090099
261000                                              ASC-ITEMS-DISPLAYED 26100099
261100             ELSE                                                 26110099
261200                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              26120099
261300                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        26130099
261400             END-IF                                               26140099
261500                                                                  26150099
261600             PERFORM 3300-EDIT-SELECTIONS                         26160099
261700                     VARYING PV-SUB                               26170099
261800                        FROM PV-SUB BY -1                         26180099
261900                       UNTIL PV-SUB < +1                          26190099
262000                                                                  26200099
262100             MOVE +1               TO ASC-BLK-SUB                 26210099
262200                                                                  26220099
262300             PERFORM 5105-REWRITE-ASC-LISTQ                       26230099
262400                                                                  26240099
262500             MOVE +1                TO ASC-BLK-SUB                26250099
262600                                                                  26260099
262700             IF  PS-BLOCK-ERROR                                   26270099
262800                 SET  PS-ERROR     TO TRUE                        26280099
262900                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        26290099
263000                                   TO PV-TOP-ITEM                 26300099
263100             ELSE                                                 26310099
263200                 ADD  +1           TO PV-BLOCK-NUMBER             26320099
263300                 IF  PV-BLOCK-NUMBER >                            26330099
263400                     ASC-HIGHEST-BLOCK-WRITTEN                    26340099
263500                     MOVE +2       TO ASC-BLK-SUB                 26350099
263600                     PERFORM 4410-READ-TEMP-STORAGE               26360099
263700                     MOVE +1       TO ASC-BLK-SUB                 26370099
263800                 ELSE                                             26380099
263900                     PERFORM 4410-READ-TEMP-STORAGE               26390099
264000                     ADD  +1        TO PV-BLOCK-NUMBER            26400099
264100                     MOVE +2        TO ASC-BLK-SUB                26410099
264200                     PERFORM 4410-READ-TEMP-STORAGE               26420099
264300                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            26430099
264400                     MOVE +1        TO ASC-BLK-SUB                26440099
264500                 END-IF                                           26450099
264600             END-IF                                               26460099
264700     END-PERFORM.                                                 26470099
264800                                                                  26480099
264900     IF  PV-ORIGINAL-BLOCK  = +1    OR                            26490099
265000         PS-ERROR                   OR                            26500099
265100         PS-BLOCK-ERROR                                           26510099
265200         CONTINUE                                                 26520099
265300     ELSE                                                         26530099
265400         MOVE +1                 TO PV-BLOCK-NUMBER               26540099
265500         MOVE +1                 TO ASC-BLK-SUB                   26550099
265600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  26560099
265700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           26570099
265800         PERFORM 4410-READ-TEMP-STORAGE                           26580099
265900                                                                  26590099
266000         PERFORM                                                  26600099
266100           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              26610099
266200              OR PS-ERROR                                         26620099
266300              OR PS-BLOCK-ERROR                                   26630099
266400                                                                  26640099
266500                 COMPUTE PV-ITEMS-HOLD  =                         26650099
266600                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    26660099
266700                         PC-ITEMS-PER-PANEL - 1                   26670099
266800                                                                  26680099
266900                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     26690099
267000                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           26700099
267100                         FROM  PV-ITEMS-HOLD                      26710099
267200                       GIVING  PV-ITEMS-DIFF                      26720099
267300                     SUBTRACT  PV-ITEMS-DIFF                      26730099
267400                         FROM  PC-ITEMS-PER-PANEL                 26740099
267500                       GIVING  PV-ITEMS-HOLD                      26750099
267600                         MOVE  PV-ITEMS-HOLD TO PV-SUB            26760099
267700                                                ASC-ITEM-SUB      26770099
267800                                               ASC-ITEMS-DISPLAYED26780099
267900                 ELSE                                             26790099
268000                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          26800099
268100                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    26810099
268200                 END-IF                                           26820099
268300                                                                  26830099
268400                 PERFORM 3300-EDIT-SELECTIONS                     26840099
268500                         VARYING PV-SUB                           26850099
268600                            FROM PV-SUB BY -1                     26860099
268700                           UNTIL PV-SUB < +1                      26870099
268800                                                                  26880099
268900                 MOVE +1               TO ASC-BLK-SUB             26890099
269000                                                                  26900099
269100                 PERFORM 5105-REWRITE-ASC-LISTQ                   26910099
269200                                                                  26920099
269300                 MOVE +1                TO ASC-BLK-SUB            26930099
269400                                                                  26940099
269500                 IF  PS-BLOCK-ERROR                               26950099
269600                     SET  PS-ERROR     TO TRUE                    26960099
269700                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    26970099
269800                                       TO PV-TOP-ITEM             26980099
269900                 ELSE                                             26990099
270000                     ADD  +1            TO PV-BLOCK-NUMBER        27000099
270100                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      27010099
270200                         MOVE +2        TO ASC-BLK-SUB            27020099
270300                         PERFORM 4410-READ-TEMP-STORAGE           27030099
270400                         MOVE +1        TO ASC-BLK-SUB            27040099
270500                     ELSE                                         27050099
270600                         PERFORM 4410-READ-TEMP-STORAGE           27060099
270700                         ADD  +1        TO PV-BLOCK-NUMBER        27070099
270800                         MOVE +2        TO ASC-BLK-SUB            27080099
270900                         PERFORM 4410-READ-TEMP-STORAGE           27090099
271000                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        27100099
271100                         MOVE +1        TO ASC-BLK-SUB            27110099
271200                     END-IF                                       27120099
271300                 END-IF                                           27130099
271400     END-PERFORM.                                                 27140099
271500*                                                                 27150099
271600*                                                                 27160099
271700*----------------------------------------------------------------*27170099
271800*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *27180099
271900*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*27190099
272000*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *27200099
272100*                                                                *27210099
272200*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *27220099
272300*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *27230099
272400*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *27240099
272500*    US IN THE 2ND BLOCK OF THE ARRAY.                           *27250099
272600*----------------------------------------------------------------*27260099
272700 3100-SET-SUBSCRIPTS.                                             27270099
272800                                                                  27280099
272900     COMPUTE ASC-ITEM-SUB =                                       27290099
273000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        27300099
273100                                                                  27310099
273200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         27320099
273300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            27330099
273400                                                                  27340099
273500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               27350099
273600     ELSE                                                         27360099
273700         MOVE +1                     TO ASC-BLK-SUB               27370099
273800     END-IF.                                                      27380099
273900                                                                  27390099
274000                                                                  27400099
274100 3150-LIST-SEQUENCE.                                              27410099
274200     EXEC SQL                                                     27420099
274300          SELECT FUNC_TXT                                         27430099
274400          INTO  :KRPRPM-FUNC-TXT                                  27440099
274500          FROM   TKRPRPM                                          27450099
274600          WHERE  SYS_PRC_FUNC_CDE  = 'FALTSQ'                     27460099
274700            AND  LOC_ID            = :DK-OPER-UNT-ID              27470099
274800            AND  INTFC_SYS_CDE     = 'KHL'                        27480099
274900            AND  FUNC_PRC_STAT_CDE = 'AC'                         27490099
275000            WITH UR                                               27500099
275100     END-EXEC.                                                    27510099
275200                                                                  27520099
275300     EVALUATE TRUE                                                27530099
275400        WHEN SQLCODE = +0                                         27540099
275500            CONTINUE                                              27550099
275600        WHEN OTHER                                                27560099
275700            MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER           27570099
275800            STRING  ' SUKCS761- 3150-  '      DELIMITED BY SIZE   27580099
275900                    ' OPER-'                  DELIMITED BY SIZE   27590099
276000                    PV-DISP-OPER              DELIMITED BY SIZE   27600099
276100                                   INTO PV-CICS-MSG-AREA          27610099
276200            PERFORM 9900-WRITE-CICS-LOG                           27620099
276300                                                                  27630099
276400            SET PS-ERROR    TO TRUE                               27640099
276500            MOVE '3150-LIST-SEQUENCE'  TO DP013-PARAGRAPH         27650099
276600            MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)  27660099
276700            MOVE DK-OPER-UNT-ID        TO DP013-MESSAGE-TEXT (2)  27670099
276800            MOVE SQLCA   TO DP013-SQLCA                           27680099
276900            MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)           27690099
277000            SET DP013-DB2-ABEND                                   27700099
277100                DP013-XCTL-DISPLAY-RESTART TO TRUE                27710099
277200            PERFORM DP013-0000-PROCESS-ABEND                      27720099
277300     END-EVALUATE.                                                27730099
277400                                                                  27740099
277500******************************************************************27750099
277600** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **27760099
277700******************************************************************27770099
277800 3200-RESET-ATTRIBUTES.                                           27780099
277900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   27790099
278000     MOVE DP015-GREEN              TO ASTRTITC.                   27800099
278100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   27810099
278200                                                                  27820099
278300     PERFORM                                                      27830099
278400         VARYING PV-SUB                                           27840099
278500         FROM 1 BY 1                                              27850099
278600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        27860099
278700         MOVE DP015-UNP-ALP-NOR-OFF                               27870099
278800                                   TO MR-SELECTA (PV-SUB)         27880099
278900         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         27890099
279000         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         27900099
279100     END-PERFORM.                                                 27910099
279200                                                                  27920099
279300*----------------------------------------------------------------*27930099
279400*  GET SEASONAL SET NAME FOR PO-RCVR                             *27940099
279500*----------------------------------------------------------------*27950099
279600 3250-GET-SEASET-NAME.                                            27960099
279700                                                                  27970099
279800     EXEC SQL                                                     27980099
279900          SELECT   SEASET_SHRT_NM                                 27990099
280000            INTO  :PURCHS-SEASET-SHRT-NM                          28000099
280100            FROM TPURCHS                                          28010099
280200           WHERE PO_NBR           =  :DK-PO-NBR                   28020099
280300             AND VER_STATUS_CDE   = 'A'                           28030099
280400     WITH UR                                                      28040099
280500     END-EXEC.                                                    28050099
280600                                                                  28060099
280700     EVALUATE TRUE                                                28070099
280800         WHEN SQLCODE = +0                                        28080099
280900              CONTINUE                                            28090099
281000         WHEN SQLCODE = +100                                      28100099
281100              MOVE PC-UNKNWN-SEASET-NME TO PURCHS-SEASET-SHRT-NM  28110099
281200         WHEN OTHER                                               28120099
281300              MOVE DK-PO-NBR              TO PV-DISP-PO           28130099
281400              STRING  ' SUKCS761- 3250-  '      DELIMITED BY SIZE 28140099
281500                      ' PO-'                    DELIMITED BY SIZE 28150099
281600                      PV-DISP-PO                DELIMITED BY SIZE 28160099
281700                                      INTO PV-CICS-MSG-AREA       28170099
281800              PERFORM 9900-WRITE-CICS-LOG                         28180099
281900                                                                  28190099
282000              MOVE '3250-GET-SEASET-NAME'                         28200099
282100                                  TO DP013-PARAGRAPH              28210099
282200              MOVE 'SELECT SEASONAL SET NAME    '                 28220099
282300                                  TO DP013-MESSAGE-TEXT (1)       28230099
282400              MOVE DK-PO-NBR                                      28240099
282500                                  TO DP013-MESSAGE-TEXT (2)       28250099
282600              MOVE SQLCA          TO DP013-SQLCA                  28260099
282700              MOVE 'TPURCHS'      TO DP013-DB2-TABLE-NAME (1)     28270099
282800              SET DP013-DB2-ABEND TO TRUE                         28280099
282900              SET DP013-XCTL-DISPLAY-RESTART TO TRUE              28290099
283000              PERFORM DP013-0000-PROCESS-ABEND                    28300099
283100     END-EVALUATE.                                                28310099
283200                                                                  28320099
283300******************************************************************28330099
283400** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **28340099
283500** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **28350099
283600** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **28360099
283700** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **28370099
283800******************************************************************28380099
283900 3300-EDIT-SELECTIONS.                                            28390099
284000     EVALUATE TRUE                                                28400099
284100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     28410099
284200             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         28420099
284300                 CONTINUE                                         28430099
284400         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         28440099
284500             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        28450099
284600                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   28460099
284700                 MOVE ASC-TEMP-SELECTED-SW                        28470099
284800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28480099
284900                                TO ASC-SELECTED-SW                28490099
285000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28500099
285100             END-IF                                               28510099
285200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     28520099
285300                 = SPACE                                          28530099
285400             EVALUATE TRUE                                        28540099
285500                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       28550099
285600                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS28560099
285700                     MOVE SPACE TO ASC-SELECTED-SW                28570099
285800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28580099
285900                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        28590099
286000                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    28600099
286100                     MOVE SPACE TO ASC-SELECTED-SW                28610099
286200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28620099
286300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          28630099
286400                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      28640099
286500                     MOVE SPACE TO ASC-SELECTED-SW                28650099
286600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28660099
286700             END-EVALUATE                                         28670099
286800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           28680099
286900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            28690099
287000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    28700099
287100             END-IF                                               28710099
287200             PERFORM 3310-EDIT-RANGE                              28720099
287300         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             28730099
287400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            28740099
287500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    28750099
287600             END-IF                                               28760099
287700             PERFORM 3310-EDIT-RANGE                              28770099
287800         WHEN OTHER                                               28780099
287900             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           28790099
288000             SET DP020-MSG-FATAL    TO TRUE                       28800099
288100             MOVE -1                TO MR-SELECTL (PV-SUB)        28810099
288200             SET DP030-SET-CURSOR-APPL-1                          28820099
288300                                    TO TRUE                       28830099
288400             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        28840099
288500             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        28850099
288600             SET PS-ERROR TO TRUE                                 28860099
288700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            28870099
288800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     28880099
288900                 MOVE SPACE         TO ASC-SELECTED-SW            28890099
289000                                        (ASC-BLK-SUB ASC-ITEM-SUB)28900099
289100             END-IF                                               28910099
289200     END-EVALUATE.                                                28920099
289300                                                                  28930099
289400     IF PS-NO-ERROR                                               28940099
289500       IF DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID) AND              28950099
289600            ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                 28960099
289700           IF ASC-PACK-TYPE (ASC-BLK-SUB ASC-ITEM-SUB) =  ' '     28970099
289800               SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       28980099
289900                                     TO TRUE                      28990099
290000               SET PV-PBS            TO TRUE                      29000099
290100               SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS       29010099
290200           END-IF                                                 29020099
290300       END-IF                                                     29030099
290400     END-IF                                                       29040099
290500                                                                  29050099
290600     IF PS-NO-ERROR                                               29060099
290700       IF DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID) AND              29070099
290800            ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                 29080099
290900           IF ASC-CSR-IND (ASC-BLK-SUB ASC-ITEM-SUB) NOT = 'A'    29090099
291000               SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       29100099
291100                                           TO TRUE                29110099
291200               SET PS-NONTRANSCRIBED-RCVR  TO TRUE                29120099
291300               SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS       29130099
291400           END-IF                                                 29140099
291500       END-IF                                                     29150099
291600     END-IF                                                       29160099
291700                                                                  29170099
291800     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 29180099
291900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               29190099
292000     IF  ASC-ITEM-SUB < 1                                         29200099
292100         SUBTRACT +1 FROM ASC-BLK-SUB                             29210099
292200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                29220099
292300     END-IF.                                                      29230099
292400                                                                  29240099
292500******************************************************************29250099
292600** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **29260099
292700** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **29270099
292800** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**29280099
292900** THE ENDING.                                                  **29290099
293000******************************************************************29300099
293100 3310-EDIT-RANGE.                                                 29310099
293200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                29320099
293300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   29330099
293400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)29340099
293500                                   TO ASC-SELECTED-SW             29350099
293600                                        (ASC-BLK-SUB ASC-ITEM-SUB)29360099
293700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 29370099
293800         ELSE                                                     29380099
293900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     29390099
294000                 CONTINUE                                         29400099
294100             ELSE                                                 29410099
294200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        29420099
294300                 MOVE PC-TSYMSG-00054       TO DP020-MSG-NUMBER   29430099
294400                 SET DP020-MSG-FATAL        TO TRUE               29440099
294500                 MOVE -1                    TO MR-SELECTL (PV-SUB)29450099
294600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              29460099
294700                 MOVE DP015-RED             TO MR-SELECTC (PV-SUB)29470099
294800                 MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)29480099
294900                 SET PS-ERROR               TO TRUE               29490099
295000             END-IF                                               29500099
295100         END-IF                                                   29510099
295200     ELSE                                                         29520099
295300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     29530099
295400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 29540099
295500                                   TO ASC-SELECTED-SW             29550099
295600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   29560099
295700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   29570099
295800         ELSE                                                     29580099
295900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       29590099
296000                 CONTINUE                                         29600099
296100             ELSE                                                 29610099
296200*                -- ONLY ONE END-OF-RANGE ALLOWED --              29620099
296300                 MOVE PC-TSYMSG-00055       TO DP020-MSG-NUMBER   29630099
296400                 SET DP020-MSG-FATAL        TO TRUE               29640099
296500                 MOVE -1                    TO MR-SELECTL (PV-SUB)29650099
296600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              29660099
296700                 SET PS-ERROR                TO TRUE              29670099
296800             END-IF                                               29680099
296900         END-IF                                                   29690099
297000     END-IF.                                                      29700099
297100                                                                  29710099
297200******************************************************************29720099
297300** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **29730099
297400** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **29740099
297500******************************************************************29750099
297600 3400-CHECK-RANGE-SEQUENCE.                                       29760099
297700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       29770099
297800       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      29780099
297900       AND  ASC-START-OF-SELECTED-RANGE >                         29790099
298000                                         ASC-END-OF-SELECTED-RANGE29800099
298100*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                29810099
298200         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 29820099
298300         SET DP020-MSG-FATAL TO TRUE                              29830099
298400         SET PS-ERROR TO TRUE                                     29840099
298500         PERFORM 3410-POSITION-AT-ERROR                           29850099
298600     END-IF.                                                      29860099
298700******************************************************************29870099
298800** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **29880099
298900** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **29890099
299000** SHOULD BE POSITIONED ON A RANGE ERROR.                       **29900099
299100******************************************************************29910099
299200 3410-POSITION-AT-ERROR.                                          29920099
299300     SET DP030-SET-CURSOR-APPL-1                                  29930099
299400                                   TO TRUE.                       29940099
299500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 29950099
299600                    - PV-TOP-ITEM + 1.                            29960099
299700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29970099
299800         CONTINUE                                                 29980099
299900     ELSE                                                         29990099
300000         MOVE -1                   TO MR-SELECTL (PV-SUB)         30000099
300100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         30010099
300200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         30020099
300300     END-IF.                                                      30030099
300400                                                                  30040099
300500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   30050099
300600                    - PV-TOP-ITEM + 1.                            30060099
300700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      30070099
300800         CONTINUE                                                 30080099
300900     ELSE                                                         30090099
301000         MOVE -1                   TO MR-SELECTL (PV-SUB)         30100099
301100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         30110099
301200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         30120099
301300     END-IF.                                                      30130099
301400                                                                  30140099
301500*----------------------------------------------------------------*30150099
301600*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *30160099
301700*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *30170099
301800*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *30180099
301900*----------------------------------------------------------------*30190099
302000                                                                  30200099
302100 3500-MARK-RANGE-AS-SELECTED.                                     30210099
302200     MOVE +1                       TO  ASC-BLK-SUB.               30220099
302300     PERFORM 3510-MARK-SELECTED-INDS                              30230099
302400         VARYING ASC-ITEM-SUB                                     30240099
302500         FROM 1 BY 1                                              30250099
302600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 30260099
302700                                                                  30270099
302800     ADD +1                        TO ASC-BLK-SUB.                30280099
302900     PERFORM 3510-MARK-SELECTED-INDS                              30290099
303000         VARYING ASC-ITEM-SUB                                     30300099
303100         FROM 1 BY 1                                              30310099
303200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 30320099
303300                                                                  30330099
303400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               30340099
303500                                   TO  PV-LIST-ITEM-NUMBER.       30350099
303600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            30360099
303700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         30370099
303800               PC-ITEMS-PER-PANEL).                               30380099
303900                                                                  30390099
304000     MOVE ASC-START-OF-SELECTED-RANGE                             30400099
304100                                   TO PV-START-OF-SELECTED-RANGE. 30410099
304200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            30420099
304300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  30430099
304400               PC-ITEMS-PER-PANEL).                               30440099
304500                                                                  30450099
304600     MOVE ASC-END-OF-SELECTED-RANGE                               30460099
304700                                   TO  PV-END-OF-SELECTED-RANGE.  30470099
304800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             30480099
304900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    30490099
305000               PC-ITEMS-PER-PANEL).                               30500099
305100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             30510099
305200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             30520099
305300                                                                  30530099
305400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    30540099
305500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        30550099
305600         MOVE +1                   TO ASC-BLK-SUB                 30560099
305700         PERFORM 5100-WRITE-TEMP-STORAGE                          30570099
305800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         30580099
305900             PV-FIRST-BLOCK-IN-ARRAY - 1                          30590099
306000                                                                  30600099
306100         PERFORM                                                  30610099
306200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      30620099
306300                   PV-PREV-BLOCK-IN-ARRAY                         30630099
306400             MOVE PV-FIRST-BLOCK-IN-RANGE                         30640099
306500                                   TO PV-BLOCK-NUMBER             30650099
306600             PERFORM 4410-READ-TEMP-STORAGE                       30660099
306700             PERFORM 3510-MARK-SELECTED-INDS                      30670099
306800                 VARYING ASC-ITEM-SUB                             30680099
306900                 FROM 1 BY 1                                      30690099
307000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          30700099
307100             PERFORM 5100-WRITE-TEMP-STORAGE                      30710099
307200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     30720099
307300         END-PERFORM                                              30730099
307400                                                                  30740099
307500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         30750099
307600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     30760099
307700         PERFORM                                                  30770099
307800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       30780099
307900                   PV-LAST-BLOCK-IN-RANGE                         30790099
308000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          30800099
308100                                   TO PV-BLOCK-NUMBER             30810099
308200             PERFORM 4410-READ-TEMP-STORAGE                       30820099
308300             PERFORM 3510-MARK-SELECTED-INDS                      30830099
308400                 VARYING ASC-ITEM-SUB                             30840099
308500                 FROM 1 BY 1                                      30850099
308600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          30860099
308700             PERFORM 5100-WRITE-TEMP-STORAGE                      30870099
308800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      30880099
308900         END-PERFORM                                              30890099
309000                                                                  30900099
309100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             30910099
309200                                   TO PV-BLOCK-NUMBER             30920099
309300         PERFORM 4410-READ-TEMP-STORAGE                           30930099
309400     END-IF.                                                      30940099
309500                                                                  30950099
309600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 30960099
309700                                      ASC-END-OF-SELECTED-RANGE.  30970099
309800                                                                  30980099
309900*----------------------------------------------------------------*30990099
310000* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *31000099
310100*----------------------------------------------------------------*31010099
310200 3510-MARK-SELECTED-INDS.                                         31020099
310300                                                                  31030099
310400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         31040099
310500         ASC-START-OF-SELECTED-RANGE)                             31050099
310600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         31060099
310700         ASC-START-OF-SELECTED-RANGE)                             31070099
310800                                                                  31080099
310900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB  ASC-ITEM-SUB) <    31090099
311000             ASC-END-OF-SELECTED-RANGE)                           31100099
311100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     31110099
311200             ASC-END-OF-SELECTED-RANGE)                           31120099
311300                                                                  31130099
311400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          31140099
311500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   31150099
311600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   31160099
311700                               TO TRUE                            31170099
311800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)   TO TRUE    31180099
311900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    31190099
312000             END-IF                                               31200099
312100         END-IF                                                   31210099
312200     END-IF.                                                      31220099
312300                                                                  31230099
312400*----------------------------------------------------------------*31240099
312500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *31250099
312600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *31260099
312700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *31270099
312800*    DISPLAY THE PANEL TO USER.                                  *31280099
312900*----------------------------------------------------------------*31290099
313000 4000-BUILD-INITIAL-PANEL.                                        31300099
313100                                                                  31310099
313200     INITIALIZE                   ASC-BLOCK-ENTRIES (1)           31320099
313300                                  ASC-BLOCK-ENTRIES (2).          31330099
313400     MOVE +1                   TO ASC-BLK-SUB.                    31340099
313500     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           31350099
313600                                                                  31360099
313700     MOVE +0                 TO ASC-ITEM-SUB                      31370099
313800                                ASC-NUMBER-OF-ITEMS-READ          31380099
313900                                ASC-NUMBER-OF-SELECTED-ITEMS      31390099
314000                                ASC-HIGHEST-BLOCK-WRITTEN         31400099
314100                                ASC-START-OF-SELECTED-RANGE       31410099
314200                                ASC-END-OF-SELECTED-RANGE         31420099
314300                                ASC-ITEM-AT-TOP-OF-PANEL.         31430099
314400     PERFORM 4100-PREPARE-CURSOR.                                 31440099
314500                                                                  31450099
314600     PERFORM 4010-OPEN-CURSOR.                                    31460099
314700     PERFORM 4300-READ-ITEMS-FROM-DB.                             31470099
314800     PERFORM 4020-CLOSE-CURSOR.                                   31480099
314900                                                                  31490099
315000     MOVE +1                   TO  PV-TOP-ITEM.                   31500099
315100     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          31510099
315200         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    31520099
315300         SET DP020-MSG-FATAL   TO  TRUE                           31530099
315400         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               31540099
315500     ELSE                                                         31550099
315600         MOVE -1               TO MR-SELECTL (1)                  31560099
315700         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     31570099
315800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     31580099
315900     END-IF.                                                      31590099
316000                                                                  31600099
316100*----------------------------------------------------------------*31610099
316200* OPEN CURSOR                                                     31620099
316300*----------------------------------------------------------------*31630099
316400 4010-OPEN-CURSOR.                                                31640099
316500                                                                  31650099
316600         EVALUATE TRUE                                            31660099
316700             WHEN ASC-CURR-DTE-S-CSR                              31670099
316800                  MOVE 'CURSOR:  CURR-DTE-S-CSR'                  31680099
316900                                 TO DP013-MESSAGE-TEXT (2)        31690099
317000                  EXEC SQL                                        31700099
317100                       OPEN CURR-DTE-S-CSR                        31710099
317200                  END-EXEC                                        31720099
317300             WHEN ASC-CURR-DTE-A-CSR                              31730099
317400                  MOVE 'CURSOR:  CURR-DTE-A-CSR'                  31740099
317500                                 TO DP013-MESSAGE-TEXT (2)        31750099
317600                  EXEC SQL                                        31760099
317700                       OPEN CURR-DTE-A-CSR                        31770099
317800                  END-EXEC                                        31780099
317900                                                                  31790099
318000             WHEN ASC-CURR-DTE-D-CSR                              31800099
318100                  MOVE 'CURSOR:  CURR-DTE-D-CSR'                  31810099
318200                                 TO DP013-MESSAGE-TEXT (2)        31820099
318300                  EXEC SQL                                        31830099
318400                       OPEN CURR-DTE-D-CSR                        31840099
318500                  END-EXEC                                        31850099
318600                                                                  31860099
318700******************************************************************31870099
318800             WHEN ASC-DATE-RNGE-S-CSR                             31880099
318900                  MOVE 'CURSOR:  DATE-RNGE-S-CSR'                 31890099
319000                                 TO DP013-MESSAGE-TEXT (2)        31900099
319100                  EXEC SQL                                        31910099
319200                       OPEN DATE-RNGE-S-CSR                       31920099
319300                  END-EXEC                                        31930099
319400                                                                  31940099
319500             WHEN ASC-DATE-RNGE-A-CSR                             31950099
319600                  MOVE 'CURSOR:  DATE-RNGE-A-CSR'                 31960099
319700                                 TO DP013-MESSAGE-TEXT (2)        31970099
319800                  EXEC SQL                                        31980099
319900                       OPEN DATE-RNGE-A-CSR                       31990099
320000                  END-EXEC                                        32000099
320100                                                                  32010099
320200             WHEN ASC-DATE-RNGE-D-CSR                             32020099
320300                  MOVE 'CURSOR:  DATE-RNGE-D-CSR'                 32030099
320400                                 TO DP013-MESSAGE-TEXT (2)        32040099
320500                  EXEC SQL                                        32050099
320600                       OPEN DATE-RNGE-D-CSR                       32060099
320700                  END-EXEC                                        32070099
320800                                                                  32080099
320900******************************************************************32090099
321000             WHEN ASC-SCAC-TRLR-S-CSR                             32100099
321100                  MOVE 'CURSOR:  SCAC-TRLR-S-CSR'                 32110099
321200                                 TO DP013-MESSAGE-TEXT (2)        32120099
321300                  EXEC SQL                                        32130099
321400                       OPEN SCAC-TRLR-S-CSR                       32140099
321500                  END-EXEC                                        32150099
321600                                                                  32160099
321700             WHEN ASC-SCAC-TRLR-A-CSR                             32170099
321800                  MOVE 'CURSOR:  SCAC-TRLR-A-CSR'                 32180099
321900                                 TO DP013-MESSAGE-TEXT (2)        32190099
322000                  EXEC SQL                                        32200099
322100                       OPEN SCAC-TRLR-A-CSR                       32210099
322200                  END-EXEC                                        32220099
322300                                                                  32230099
322400             WHEN ASC-SCAC-TRLR-D-CSR                             32240099
322500                  MOVE 'CURSOR:  SCAC-TRLR-D-CSR'                 32250099
322600                                 TO DP013-MESSAGE-TEXT (2)        32260099
322700                  EXEC SQL                                        32270099
322800                       OPEN SCAC-TRLR-D-CSR                       32280099
322900                  END-EXEC                                        32290099
323000                                                                  32300099
323100******************************************************************32310099
323200             WHEN ASC-TRIP-ID-S-CSR                               32320099
323300                  MOVE 'CURSOR:  TRIP-ID-S-CSR'                   32330099
323400                                 TO DP013-MESSAGE-TEXT (2)        32340099
323500                  EXEC SQL                                        32350099
323600                       OPEN TRIP-ID-S-CSR                         32360099
323700                  END-EXEC                                        32370099
323800                                                                  32380099
323900             WHEN ASC-TRIP-ID-A-CSR                               32390099
324000                  MOVE 'CURSOR:  TRIP-ID-A-CSR'                   32400099
324100                                 TO DP013-MESSAGE-TEXT (2)        32410099
324200                  EXEC SQL                                        32420099
324300                       OPEN TRIP-ID-A-CSR                         32430099
324400                  END-EXEC                                        32440099
324500                                                                  32450099
324600             WHEN ASC-TRIP-ID-D-CSR                               32460099
324700                  MOVE 'CURSOR:  TRIP-ID-D-CSR'                   32470099
324800                                 TO DP013-MESSAGE-TEXT (2)        32480099
324900                  EXEC SQL                                        32490099
325000                       OPEN TRIP-ID-D-CSR                         32500099
325100                  END-EXEC                                        32510099
325200                                                                  32520099
325300******************************************************************32530099
325400             WHEN ASC-PO-CURR-DTE-S-CSR                           32540099
325500                  MOVE 'CURSOR:  PO-CURR-DTE-S-CSR'               32550099
325600                                 TO DP013-MESSAGE-TEXT (2)        32560099
325700                  EXEC SQL                                        32570099
325800                       OPEN PO-CURR-DTE-S-CSR                     32580099
325900                  END-EXEC                                        32590099
326000                                                                  32600099
326100             WHEN ASC-PO-CURR-DTE-A-CSR                           32610099
326200                  MOVE 'CURSOR:  PO-CURR-DTE-A-CSR'               32620099
326300                                 TO DP013-MESSAGE-TEXT (2)        32630099
326400                  EXEC SQL                                        32640099
326500                       OPEN PO-CURR-DTE-A-CSR                     32650099
326600                  END-EXEC                                        32660099
326700                                                                  32670099
326800             WHEN ASC-PO-CURR-DTE-D-CSR                           32680099
326900                  MOVE 'CURSOR:  PO-CURR-DTE-D-CSR'               32690099
327000                                 TO DP013-MESSAGE-TEXT (2)        32700099
327100                  EXEC SQL                                        32710099
327200                       OPEN PO-CURR-DTE-D-CSR                     32720099
327300                  END-EXEC                                        32730099
327400                                                                  32740099
327500******************************************************************32750099
327600             WHEN ASC-PO-DTE-RNGE-S-CSR                           32760099
327700                  MOVE 'CURSOR:  PO-DATE-RNGE-S-CSR'              32770099
327800                                 TO DP013-MESSAGE-TEXT (2)        32780099
327900                  EXEC SQL                                        32790099
328000                       OPEN PO-DATE-RNGE-S-CSR                    32800099
328100                  END-EXEC                                        32810099
328200                                                                  32820099
328300             WHEN ASC-PO-DTE-RNGE-A-CSR                           32830099
328400                  MOVE 'CURSOR:  PO-DATE-RNGE-A-CSR'              32840099
328500                                 TO DP013-MESSAGE-TEXT (2)        32850099
328600                  EXEC SQL                                        32860099
328700                       OPEN PO-DATE-RNGE-A-CSR                    32870099
328800                  END-EXEC                                        32880099
328900                                                                  32890099
329000             WHEN ASC-PO-DTE-RNGE-D-CSR                           32900099
329100                  MOVE 'CURSOR:  PO-DATE-RNGE-D-CSR'              32910099
329200                                 TO DP013-MESSAGE-TEXT (2)        32920099
329300                  EXEC SQL                                        32930099
329400                       OPEN PO-DATE-RNGE-D-CSR                    32940099
329500                  END-EXEC                                        32950099
329600                                                                  32960099
329700******************************************************************32970099
329800             WHEN ASC-PO-RCVR-S-CSR                               32980099
329900                  MOVE 'CURSOR:  PO-RCVR-S-CSR'                   32990099
330000                                 TO DP013-MESSAGE-TEXT (2)        33000099
330100                  EXEC SQL                                        33010099
330200                       OPEN PO-RCVR-S-CSR                         33020099
330300                  END-EXEC                                        33030099
330400                                                                  33040099
330500             WHEN ASC-PO-RCVR-A-CSR                               33050099
330600                  MOVE 'CURSOR:  PO-RCVR-A-CSR'                   33060099
330700                                 TO DP013-MESSAGE-TEXT (2)        33070099
330800                  EXEC SQL                                        33080099
330900                       OPEN PO-RCVR-A-CSR                         33090099
331000                  END-EXEC                                        33100099
331100                                                                  33110099
331200             WHEN ASC-PO-RCVR-D-CSR                               33120099
331300                  MOVE 'CURSOR:  PO-RCVR-D-CSR'                   33130099
331400                                 TO DP013-MESSAGE-TEXT (2)        33140099
331500                  EXEC SQL                                        33150099
331600                       OPEN PO-RCVR-D-CSR                         33160099
331700                  END-EXEC                                        33170099
331800                                                                  33180099
331900         END-EVALUATE.                                            33190099
332000                                                                  33200099
332100         EVALUATE TRUE                                            33210099
332200             WHEN SQLCODE = +0                                    33220099
332300               CONTINUE                                           33230099
332400             WHEN OTHER                                           33240099
332500               MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER        33250099
332600               MOVE DK-TRIP-ID             TO PV-DISP-TRIP        33260099
332700               MOVE DK-PO-NBR              TO PV-DISP-PO          33270099
332800               MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR        33280099
332900               STRING  ' SUKCS761- 4010-  '      DELIMITED BY SIZE33290099
333000                       ' OPER- '                 DELIMITED BY SIZE33300099
333100                       PV-DISP-OPER              DELIMITED BY SIZE33310099
333200                       ' SCAC- '                 DELIMITED BY SIZE33320099
333300                       DK-SCAC                   DELIMITED BY SIZE33330099
333400                       ' TRLR- '                 DELIMITED BY SIZE33340099
333500                       DK-TRLR-NBR               DELIMITED BY SIZE33350099
333600                       ' TRIP- '                 DELIMITED BY SIZE33360099
333700                       PV-DISP-TRIP              DELIMITED BY SIZE33370099
333800                       ' PO-'                    DELIMITED BY SIZE33380099
333900                       PV-DISP-PO                DELIMITED BY SIZE33390099
334000                       ' RCVR- '                 DELIMITED BY SIZE33400099
334100                       PV-DISP-RCVR              DELIMITED BY SIZE33410099
334200                                      INTO PV-CICS-MSG-AREA       33420099
334300               PERFORM 9900-WRITE-CICS-LOG                        33430099
334400                                                                  33440099
334500               STRING  ' SUKCS761- 4010-  '      DELIMITED BY SIZE33450099
334600                       ' CURR DTE- '             DELIMITED BY SIZE33460099
334700                       DK-CURR-DATE              DELIMITED BY SIZE33470099
334800                       ' FROM DTE- '             DELIMITED BY SIZE33480099
334900                       DK-FROM-DATE              DELIMITED BY SIZE33490099
335000                       ' TO DTE- '               DELIMITED BY SIZE33500099
335100                       DK-TO-DATE                DELIMITED BY SIZE33510099
335200                                      INTO PV-CICS-MSG-AREA       33520099
335300               PERFORM 9900-WRITE-CICS-LOG                        33530099
335400                                                                  33540099
335500               MOVE '4010-OPEN-CURSOR'                            33550099
335600                                 TO DP013-PARAGRAPH               33560099
335700               MOVE 'OPEN CURSOR - '                              33570099
335800                                 TO DP013-MESSAGE-TEXT (1)        33580099
335900               MOVE SQLCA        TO DP013-SQLCA                   33590099
336000               MOVE 'CURSOR TYPE ' TO PV-ERROR-TEXT1              33600099
336100               MOVE ASC-CURSOR-SW                                 33610099
336200                                TO PV-ERROR-TEXT2                 33620099
336300               MOVE PV-ERROR-MSG                                  33630099
336400                                TO DP013-MESSAGE-TEXT (2)         33640099
336500               MOVE 'TVHTRIP '   TO DP013-DB2-TABLE-NAME (1)      33650099
336600               SET DP013-DB2-ABEND                                33660099
336700                   DP013-XCTL-DISPLAY-RESTART TO TRUE             33670099
336800               PERFORM DP013-0000-PROCESS-ABEND                   33680099
336900         END-EVALUATE.                                            33690099
337000                                                                  33700099
337100                                                                  33710099
337200******************************************************************33720099
337300*  CLOSE CURSOR                                                   33730099
337400******************************************************************33740099
337500 4020-CLOSE-CURSOR.                                               33750099
337600     EVALUATE TRUE                                                33760099
337700         WHEN ASC-CURR-DTE-S-CSR                                  33770099
337800             EXEC SQL                                             33780099
337900                 CLOSE CURR-DTE-S-CSR                             33790099
338000             END-EXEC                                             33800099
338100                                                                  33810099
338200         WHEN ASC-CURR-DTE-A-CSR                                  33820099
338300             EXEC SQL                                             33830099
338400                 CLOSE CURR-DTE-A-CSR                             33840099
338500             END-EXEC                                             33850099
338600                                                                  33860099
338700         WHEN ASC-CURR-DTE-D-CSR                                  33870099
338800             EXEC SQL                                             33880099
338900                 CLOSE CURR-DTE-D-CSR                             33890099
339000             END-EXEC                                             33900099
339100                                                                  33910099
339200******************************************************************33920099
339300         WHEN ASC-DATE-RNGE-S-CSR                                 33930099
339400             EXEC SQL                                             33940099
339500                 CLOSE DATE-RNGE-S-CSR                            33950099
339600             END-EXEC                                             33960099
339700                                                                  33970099
339800         WHEN ASC-DATE-RNGE-A-CSR                                 33980099
339900             EXEC SQL                                             33990099
340000                 CLOSE DATE-RNGE-A-CSR                            34000099
340100             END-EXEC                                             34010099
340200                                                                  34020099
340300         WHEN ASC-DATE-RNGE-D-CSR                                 34030099
340400             EXEC SQL                                             34040099
340500                 CLOSE DATE-RNGE-D-CSR                            34050099
340600             END-EXEC                                             34060099
340700                                                                  34070099
340800******************************************************************34080099
340900         WHEN ASC-SCAC-TRLR-S-CSR                                 34090099
341000             EXEC SQL                                             34100099
341100                 CLOSE SCAC-TRLR-S-CSR                            34110099
341200             END-EXEC                                             34120099
341300                                                                  34130099
341400         WHEN ASC-SCAC-TRLR-A-CSR                                 34140099
341500             EXEC SQL                                             34150099
341600                 CLOSE SCAC-TRLR-A-CSR                            34160099
341700             END-EXEC                                             34170099
341800                                                                  34180099
341900         WHEN ASC-SCAC-TRLR-D-CSR                                 34190099
342000             EXEC SQL                                             34200099
342100                 CLOSE SCAC-TRLR-D-CSR                            34210099
342200             END-EXEC                                             34220099
342300                                                                  34230099
342400******************************************************************34240099
342500         WHEN ASC-TRIP-ID-S-CSR                                   34250099
342600             EXEC SQL                                             34260099
342700                 CLOSE TRIP-ID-S-CSR                              34270099
342800             END-EXEC                                             34280099
342900                                                                  34290099
343000         WHEN ASC-TRIP-ID-A-CSR                                   34300099
343100             EXEC SQL                                             34310099
343200                 CLOSE TRIP-ID-A-CSR                              34320099
343300             END-EXEC                                             34330099
343400                                                                  34340099
343500         WHEN ASC-TRIP-ID-D-CSR                                   34350099
343600             EXEC SQL                                             34360099
343700                 CLOSE TRIP-ID-D-CSR                              34370099
343800             END-EXEC                                             34380099
343900                                                                  34390099
344000******************************************************************34400099
344100         WHEN ASC-PO-CURR-DTE-S-CSR                               34410099
344200             EXEC SQL                                             34420099
344300                 CLOSE PO-CURR-DTE-S-CSR                          34430099
344400             END-EXEC                                             34440099
344500                                                                  34450099
344600         WHEN ASC-PO-CURR-DTE-A-CSR                               34460099
344700             EXEC SQL                                             34470099
344800                 CLOSE PO-CURR-DTE-A-CSR                          34480099
344900             END-EXEC                                             34490099
345000                                                                  34500099
345100         WHEN ASC-PO-CURR-DTE-D-CSR                               34510099
345200             EXEC SQL                                             34520099
345300                 CLOSE PO-CURR-DTE-D-CSR                          34530099
345400             END-EXEC                                             34540099
345500                                                                  34550099
345600******************************************************************34560099
345700         WHEN ASC-PO-DTE-RNGE-S-CSR                               34570099
345800             EXEC SQL                                             34580099
345900                 CLOSE PO-DATE-RNGE-S-CSR                         34590099
346000             END-EXEC                                             34600099
346100                                                                  34610099
346200         WHEN ASC-PO-DTE-RNGE-A-CSR                               34620099
346300             EXEC SQL                                             34630099
346400                 CLOSE PO-DATE-RNGE-A-CSR                         34640099
346500             END-EXEC                                             34650099
346600                                                                  34660099
346700         WHEN ASC-PO-DTE-RNGE-D-CSR                               34670099
346800             EXEC SQL                                             34680099
346900                 CLOSE PO-DATE-RNGE-D-CSR                         34690099
347000             END-EXEC                                             34700099
347100                                                                  34710099
347200******************************************************************34720099
347300         WHEN ASC-PO-RCVR-S-CSR                                   34730099
347400             EXEC SQL                                             34740099
347500                 CLOSE PO-RCVR-S-CSR                              34750099
347600             END-EXEC                                             34760099
347700                                                                  34770099
347800         WHEN ASC-PO-RCVR-A-CSR                                   34780099
347900             EXEC SQL                                             34790099
348000                 CLOSE PO-RCVR-A-CSR                              34800099
348100             END-EXEC                                             34810099
348200                                                                  34820099
348300         WHEN ASC-PO-RCVR-D-CSR                                   34830099
348400             EXEC SQL                                             34840099
348500                 CLOSE PO-RCVR-D-CSR                              34850099
348600             END-EXEC                                             34860099
348700                                                                  34870099
348800     END-EVALUATE                                                 34880099
348900                                                                  34890099
349000     EVALUATE TRUE                                                34900099
349100         WHEN SQLCODE = +0                                        34910099
349200             CONTINUE                                             34920099
349300         WHEN OTHER                                               34930099
349400              MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER         34940099
349500              MOVE DK-TRIP-ID             TO PV-DISP-TRIP         34950099
349600              MOVE DK-PO-NBR              TO PV-DISP-PO           34960099
349700              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         34970099
349800              STRING  ' SUKCS761- 4030-  '      DELIMITED BY SIZE 34980099
349900                      ' OPER- '                 DELIMITED BY SIZE 34990099
350000                      PV-DISP-OPER              DELIMITED BY SIZE 35000099
350100                      ' SCAC- '                 DELIMITED BY SIZE 35010099
350200                      DK-SCAC                   DELIMITED BY SIZE 35020099
350300                      ' TRLR- '                 DELIMITED BY SIZE 35030099
350400                      DK-TRLR-NBR               DELIMITED BY SIZE 35040099
350500                      ' TRIP- '                 DELIMITED BY SIZE 35050099
350600                      PV-DISP-TRIP              DELIMITED BY SIZE 35060099
350700                      ' PO-'                    DELIMITED BY SIZE 35070099
350800                      PV-DISP-PO                DELIMITED BY SIZE 35080099
350900                      ' RCVR- '                 DELIMITED BY SIZE 35090099
351000                      PV-DISP-RCVR              DELIMITED BY SIZE 35100099
351100                                     INTO PV-CICS-MSG-AREA        35110099
351200             PERFORM 9900-WRITE-CICS-LOG                          35120099
351300                                                                  35130099
351400             STRING  ' SUKCS761- 4030-  '      DELIMITED BY SIZE  35140099
351500                     ' CURR DTE- '             DELIMITED BY SIZE  35150099
351600                     DK-CURR-DATE              DELIMITED BY SIZE  35160099
351700                     ' FROM DTE- '             DELIMITED BY SIZE  35170099
351800                     DK-FROM-DATE              DELIMITED BY SIZE  35180099
351900                     ' TO DTE- '               DELIMITED BY SIZE  35190099
352000                     DK-TO-DATE                DELIMITED BY SIZE  35200099
352100                                    INTO PV-CICS-MSG-AREA         35210099
352200             PERFORM 9900-WRITE-CICS-LOG                          35220099
352300                                                                  35230099
352400             MOVE '4020-CLOSE-CURSOR'                             35240099
352500                               TO DP013-PARAGRAPH                 35250099
352600             MOVE 'CLOSE CURSOR '                                 35260099
352700                               TO DP013-MESSAGE-TEXT (1)          35270099
352800             MOVE SQLCA        TO DP013-SQLCA                     35280099
352900             MOVE 'CURSOR TYPE ' TO PV-ERROR-TEXT1                35290099
353000             MOVE ASC-CURSOR-SW                                   35300099
353100                             TO PV-ERROR-TEXT2                    35310099
353200             MOVE PV-ERROR-MSG                                    35320099
353300                             TO DP013-MESSAGE-TEXT (2)            35330099
353400             MOVE 'TVHTRIP '   TO DP013-DB2-TABLE-NAME (1)        35340099
353500             SET DP013-DB2-ABEND                                  35350099
353600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35360099
353700             PERFORM DP013-0000-PROCESS-ABEND                     35370099
353800     END-EVALUATE.                                                35380099
353900                                                                  35390099
354000*----------------------------------------------------------------*35400099
354100*    SET UP THE HOST VARIABLES.                                  *35410099
354200*----------------------------------------------------------------*35420099
354300 4100-PREPARE-CURSOR.                                             35430099
354400                                                                  35440099
354500     SET ASC-NO-CURSOR         TO TRUE.                           35450099
354600                                                                  35460099
354700*WHEN ENTER OPER ID IN CRIT SPEC                                  35470099
354800           IF  ASC-OPER-UNT-ID GREATER THAN ZERO                  35480099
354900               IF ASC-LIST-SEQ-IND = PC-S                         35490099
355000                  SET ASC-CURR-DTE-S-CSR TO TRUE                  35500099
355100               ELSE                                               35510099
355200                  IF ASC-LIST-SEQ-IND = PC-A                      35520099
355300                     SET ASC-CURR-DTE-A-CSR TO TRUE               35530099
355400                  ELSE                                            35540099
355500                     IF ASC-LIST-SEQ-IND = PC-D                   35550099
355600                        SET ASC-CURR-DTE-D-CSR TO TRUE            35560099
355700                     END-IF                                       35570099
355800                  END-IF                                          35580099
355900               END-IF                                             35590099
356000           END-IF                                                 35600099
356100                                                                  35610099
356200******************************************************************35620099
356300*WHEN ENTER OPER ID AND CURR DATE IN CRIT SPEC                    35630099
356400           IF  ASC-OPER-UNT-ID GREATER THAN ZERO AND              35640099
356500               ASC-DATE-SELECTED = 'C'                            35650099
356600               IF ASC-LIST-SEQ-IND = PC-S                         35660099
356700                  SET ASC-CURR-DTE-S-CSR TO TRUE                  35670099
356800               ELSE                                               35680099
356900                  IF ASC-LIST-SEQ-IND = PC-A                      35690099
357000                     SET ASC-CURR-DTE-A-CSR TO TRUE               35700099
357100                  ELSE                                            35710099
357200                     IF ASC-LIST-SEQ-IND = PC-D                   35720099
357300                        SET ASC-CURR-DTE-D-CSR TO TRUE            35730099
357400                     END-IF                                       35740099
357500                  END-IF                                          35750099
357600               END-IF                                             35760099
357700           END-IF                                                 35770099
357800                                                                  35780099
357900******************************************************************35790099
358000*WHEN ENTER OPER ID AND DATE RANGE IN CRIT SPEC                   35800099
358100           IF  ASC-OPER-UNT-ID GREATER THAN ZERO AND              35810099
358200               ASC-DATE-SELECTED = 'R'                            35820099
358300               IF ASC-LIST-SEQ-IND = PC-S                         35830099
358400                  SET ASC-DATE-RNGE-S-CSR TO TRUE                 35840099
358500               ELSE                                               35850099
358600                  IF ASC-LIST-SEQ-IND = PC-A                      35860099
358700                     SET ASC-DATE-RNGE-A-CSR TO TRUE              35870099
358800                  ELSE                                            35880099
358900                     IF ASC-LIST-SEQ-IND = PC-D                   35890099
359000                        SET ASC-DATE-RNGE-D-CSR TO TRUE           35900099
359100                     END-IF                                       35910099
359200                  END-IF                                          35920099
359300               END-IF                                             35930099
359400           END-IF                                                 35940099
359500                                                                  35950099
359600******************************************************************35960099
359700*WHEN ENTER OPER ID, SCAC, TRLR IN CRIT SPEC                      35970099
359800           IF  ASC-OPER-UNT-ID GREATER THAN ZERO AND              35980099
359900               ASC-SCAC-ID GREATER THAN SPACES AND                35990099
360000               ASC-TRLR-NUMBER GREATER THAN SPACES                36000099
360100               IF ASC-LIST-SEQ-IND = PC-S                         36010099
360200                  SET ASC-SCAC-TRLR-S-CSR TO TRUE                 36020099
360300               ELSE                                               36030099
360400                  IF ASC-LIST-SEQ-IND = PC-A                      36040099
360500                     SET ASC-SCAC-TRLR-A-CSR TO TRUE              36050099
360600                  ELSE                                            36060099
360700                     IF ASC-LIST-SEQ-IND = PC-D                   36070099
360800                        SET ASC-SCAC-TRLR-D-CSR TO TRUE           36080099
360900                     END-IF                                       36090099
361000                  END-IF                                          36100099
361100               END-IF                                             36110099
361200           END-IF                                                 36120099
361300                                                                  36130099
361400******************************************************************36140099
361500*WHEN ENTER TRIP ID IN CRIT SPEC                                  36150099
361600           IF  ASC-TRIP-ID GREATER THAN ZERO AND                  36160099
361700               ASC-SCAC-ID = SPACES AND                           36170099
361800               ASC-TRLR-NUMBER = SPACES                           36180099
361900               IF ASC-LIST-SEQ-IND = PC-S                         36190099
362000                  SET ASC-TRIP-ID-S-CSR TO TRUE                   36200099
362100               ELSE                                               36210099
362200                  IF ASC-LIST-SEQ-IND = PC-A                      36220099
362300                     SET ASC-TRIP-ID-A-CSR TO TRUE                36230099
362400                  ELSE                                            36240099
362500                     IF ASC-LIST-SEQ-IND = PC-D                   36250099
362600                        SET ASC-TRIP-ID-D-CSR TO TRUE             36260099
362700                     END-IF                                       36270099
362800                  END-IF                                          36280099
362900               END-IF                                             36290099
363000           END-IF                                                 36300099
363100                                                                  36310099
363200******************************************************************36320099
363300*WHEN ENTER OPER, PO, CURRENT DATE IN CRIT SPEC                   36330099
363400           IF  ASC-OPER-UNT-ID GREATER THAN ZERO AND              36340099
363500               ASC-PO-NUMBER GREATER THAN ZERO AND                36350099
363600               ASC-DATE-SELECTED = 'C'                            36360099
363700               IF ASC-LIST-SEQ-IND = PC-S                         36370099
363800                  SET ASC-PO-CURR-DTE-S-CSR TO TRUE               36380099
363900               ELSE                                               36390099
364000                  IF ASC-LIST-SEQ-IND = PC-A                      36400099
364100                     SET ASC-PO-CURR-DTE-A-CSR TO TRUE            36410099
364200                  ELSE                                            36420099
364300                     IF ASC-LIST-SEQ-IND = PC-D                   36430099
364400                        SET ASC-PO-CURR-DTE-D-CSR TO TRUE         36440099
364500                     END-IF                                       36450099
364600                  END-IF                                          36460099
364700               END-IF                                             36470099
364800           END-IF                                                 36480099
364900                                                                  36490099
365000******************************************************************36500099
365100*WHEN ENTER OPER, PO, DATE RANGE IN CRIT SPEC                     36510099
365200           IF  ASC-OPER-UNT-ID GREATER THAN ZERO AND              36520099
365300               ASC-PO-NUMBER GREATER THAN ZERO AND                36530099
365400               ASC-DATE-SELECTED = 'R'                            36540099
365500               IF ASC-LIST-SEQ-IND = PC-S                         36550099
365600                  SET ASC-PO-DTE-RNGE-S-CSR TO TRUE               36560099
365700               ELSE                                               36570099
365800                  IF ASC-LIST-SEQ-IND = PC-A                      36580099
365900                     SET ASC-PO-DTE-RNGE-A-CSR TO TRUE            36590099
366000                  ELSE                                            36600099
366100                     IF ASC-LIST-SEQ-IND = PC-D                   36610099
366200                        SET ASC-PO-DTE-RNGE-D-CSR TO TRUE         36620099
366300                     END-IF                                       36630099
366400                  END-IF                                          36640099
366500               END-IF                                             36650099
366600           END-IF                                                 36660099
366700                                                                  36670099
366800******************************************************************36680099
366900*WHEN ENTER PO, RCVR IN CRIT SPEC                                 36690099
367000           IF  ASC-PO-NUMBER GREATER THAN ZERO AND                36700099
367100               ASC-REC-SEQ-NBR GREATER THAN ZERO                  36710099
367200               IF ASC-LIST-SEQ-IND = PC-S                         36720099
367300                  SET ASC-PO-RCVR-S-CSR TO TRUE                   36730099
367400               ELSE                                               36740099
367500                  IF ASC-LIST-SEQ-IND = PC-A                      36750099
367600                     SET ASC-PO-RCVR-A-CSR TO TRUE                36760099
367700                  ELSE                                            36770099
367800                     IF ASC-LIST-SEQ-IND = PC-D                   36780099
367900                        SET ASC-PO-RCVR-D-CSR TO TRUE             36790099
368000                     END-IF                                       36800099
368100                  END-IF                                          36810099
368200               END-IF                                             36820099
368300           END-IF                                                 36830099
368400                                                                  36840099
368500*                                                                 36850099
368600     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                36860099
368700     MOVE ASC-FCLTY-ID          TO DK-FCLTY-ID.                   36870099
368800     MOVE ASC-LIST-SEQ-IND      TO DK-LIST-SEQ-IND.               36880099
368900     MOVE ASC-SCAC-ID           TO DK-SCAC.                       36890099
369000     MOVE ASC-TRLR-NUMBER       TO DK-TRLR-NBR.                   36900099
369100     MOVE ASC-TRIP-ID           TO DK-TRIP-ID.                    36910099
369200     MOVE ASC-PO-NUMBER         TO DK-PO-NBR.                     36920099
369300     MOVE ASC-REC-SEQ-NBR       TO DK-REC-SEQ-NBR.                36930099
369400                                                                  36940099
369500     MOVE ASC-CURR-YY           TO PV-CURR-YY.                    36950099
369600     MOVE ASC-CURR-MM           TO PV-CURR-MM.                    36960099
369700     MOVE ASC-CURR-DD           TO PV-CURR-DD.                    36970099
369800     MOVE PV-CURR-DATE          TO DK-CURR-DATE.                  36980099
369900                                                                  36990099
370000     MOVE ASC-FROM-YY           TO PV-FROM-YY.                    37000099
370100     MOVE ASC-FROM-MM           TO PV-FROM-MM.                    37010099
370200     MOVE ASC-FROM-DD           TO PV-FROM-DD.                    37020099
370300     MOVE PV-FROM-DATE          TO DK-FROM-DATE.                  37030099
370400                                                                  37040099
370500     MOVE ASC-TO-YY             TO PV-TO-YY.                      37050099
370600     MOVE ASC-TO-MM             TO PV-TO-MM.                      37060099
370700     MOVE ASC-TO-DD             TO PV-TO-DD.                      37070099
370800     MOVE PV-TO-DATE            TO DK-TO-DATE.                    37080099
370900                                                                  37090099
371000******************************************************************37100099
371100 4150-GET-TRLR-INFO.                                              37110099
371200     EXEC SQL                                                     37120099
371300          SELECT A.OWNER_SCAC_ID                                  37130099
371400                ,A.VEH_NBR                                        37140099
371500                ,B.TRIP_STATUS_CDE                                37150099
371600          INTO  :DK-SCAC                                          37160099
371700               ,:DK-TRLR-NBR :DN-VEH-NBR                          37170099
371800               ,:DK-STATUS-CDE                                    37180099
371900           FROM TVHTRIP A                                         37190099
372000               ,TTRIPST B                                         37200099
372100               ,TTRSTYP C                                         37210099
372200               ,TSHIPMT E                                         37220099
372300               ,TSHPTPO F                                         37230099
372400          WHERE F.PO_NBR           = :DK-PO-NBR                   37240099
372500            AND F.REC_SEQ_NBR      = :DK-REC-SEQ-NBR              37250099
372600            AND A.TRIP_ID          = B.TRIP_ID                    37260099
372700            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            37270099
372800            AND A.TRIP_ID          = E.TRIP_ID                    37280099
372900            AND E.SHIPT_ID         = F.SHIPT_ID                   37290099
373000            AND F.PRIM_SHIPT_IND   = 'Y'                          37300099
373100            AND C.PRTY_CDE         =                              37310099
373200              (SELECT MAX(E.PRTY_CDE)                             37320099
373300                FROM TTRIPST D                                    37330099
373400                    ,TTRSTYP E                                    37340099
373500               WHERE D.TRIP_ID         = A.TRIP_ID                37350099
373600                 AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)       37360099
373700     WITH UR                                                      37370099
373800     END-EXEC                                                     37380099
373900                                                                  37390099
374000     EVALUATE TRUE                                                37400099
374100         WHEN SQLCODE = +0                                        37410099
374200              MOVE DK-STATUS-CDE   TO   PV-TRLR-STATUS            37420099
374300              IF DN-VEH-NBR = -1                                  37430099
374400                 MOVE SPACES       TO   DK-TRLR-NBR               37440099
374500              END-IF                                              37450099
374600         WHEN SQLCODE = +100                                      37460099
374700              MOVE PC-TSYMSG-00954       TO DP020-MSG-NUMBER      37470099
374800              SET  PS-COMMAREA-NOT-VALID TO TRUE                  37480099
374900         WHEN OTHER                                               37490099
375000              MOVE DK-PO-NBR              TO PV-DISP-PO           37500099
375100              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         37510099
375200              STRING  ' SUKCS761- 4150-  '      DELIMITED BY SIZE 37520099
375300                      ' PO- '                   DELIMITED BY SIZE 37530099
375400                      PV-DISP-PO                DELIMITED BY SIZE 37540099
375500                      ' RCVR- '                 DELIMITED BY SIZE 37550099
375600                      PV-DISP-RCVR              DELIMITED BY SIZE 37560099
375700                                     INTO PV-CICS-MSG-AREA        37570099
375800              PERFORM 9900-WRITE-CICS-LOG                         37580099
375900                                                                  37590099
376000              MOVE '4150-GET-TRLR-INFO'  TO DP013-PARAGRAPH       37600099
376100              MOVE 'GET TRLR INFO ' TO DP013-MESSAGE-TEXT(1)      37610099
376200              MOVE DK-PO-NBR  TO PV-ERROR-PO                      37620099
376300              MOVE DK-REC-SEQ-NBR                                 37630099
376400                              TO PV-ERROR-SEQ                     37640099
376500              MOVE PV-ERROR-MSG                                   37650099
376600                              TO DP013-MESSAGE-TEXT (2)           37660099
376700              MOVE SQLCA                 TO DP013-SQLCA           37670099
376800              MOVE 'TVHTRIP '   TO DP013-DB2-TABLE-NAME (1)       37680099
376900              SET DP013-DB2-ABEND                                 37690099
377000                               TO TRUE                            37700099
377100              PERFORM DP013-0000-PROCESS-ABEND                    37710099
377200     END-EVALUATE.                                                37720099
377300                                                                  37730099
377400******************************************************************37740099
377500 4200-GET-MAX-TRLR-STATUS.                                        37750099
377600                                                                  37760099
377700     EXEC SQL                                                     37770099
377800          SELECT TRIP_STATUS_CDE                                  37780099
377900          INTO  :DK-STATUS-CDE                                    37790099
378000          FROM   TTRIPST                                          37800099
378100          WHERE TRIP_ID = :DK-TRIP-ID                             37810099
378200            AND STATUS_DTE IN                                     37820099
378300                 (SELECT MAX(B.STATUS_DTE)                        37830099
378400                    FROM TTRIPST B                                37840099
378500                  WHERE TRIP_ID = :DK-TRIP-ID)                    37850099
378600                    AND STATUS_TME IN                             37860099
378700                       (SELECT MAX(C.STATUS_TME)                  37870099
378800                         FROM TTRIPST C                           37880099
378900                        WHERE TRIP_ID = :DK-TRIP-ID               37890099
379000                          AND C.STATUS_DTE IN                     37900099
379100                              (SELECT MAX(D.STATUS_DTE)           37910099
379200                                 FROM TTRIPST D                   37920099
379300                                WHERE TRIP_ID = :DK-TRIP-ID))     37930099
379400     WITH UR                                                      37940099
379500     END-EXEC                                                     37950099
379600                                                                  37960099
379700     EVALUATE TRUE                                                37970099
379800         WHEN SQLCODE = +0                                        37980099
379900              MOVE DK-STATUS-CDE TO  PV-TRLR-STATUS               37990099
380000         WHEN OTHER                                               38000099
380100              MOVE DK-TRIP-ID             TO PV-DISP-TRIP         38010099
380200              STRING  ' SUKCS761- 4200-  '      DELIMITED BY SIZE 38020099
380300                      ' TRIP- '                 DELIMITED BY SIZE 38030099
380400                      PV-DISP-TRIP              DELIMITED BY SIZE 38040099
380500                                     INTO PV-CICS-MSG-AREA        38050099
380600              PERFORM 9900-WRITE-CICS-LOG                         38060099
380700                                                                  38070099
380800              MOVE '4200-GET-MAX-TRLR-STATUS'                     38080099
380900                               TO DP013-PARAGRAPH                 38090099
381000              MOVE 'GET MAX TRLR STATUS '                         38100099
381100                               TO DP013-MESSAGE-TEXT (1)          38110099
381200              MOVE DK-TRIP-ID  TO DP013-MESSAGE-TEXT (2)          38120099
381300              MOVE SQLCA       TO DP013-SQLCA                     38130099
381400              MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (1)         38140099
381500              SET DP013-DB2-ABEND                                 38150099
381600                               TO TRUE                            38160099
381700              PERFORM DP013-0000-PROCESS-ABEND                    38170099
381800     END-EVALUATE.                                                38180099
381900                                                                  38190099
382000*----------------------------------------------------------------*38200099
382100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *38210099
382200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *38220099
382300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *38230099
382400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *38240099
382500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *38250099
382600*                                                                *38260099
382700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *38270099
382800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *38280099
382900*    UPON INITIALIZATION.                                        *38290099
383000*----------------------------------------------------------------*38300099
383100 4300-READ-ITEMS-FROM-DB.                                         38310099
383200                                                                  38320099
383300     PERFORM                                                      38330099
383400         VARYING PV-READ-COUNT                                    38340099
383500         FROM 1 BY 1                                              38350099
383600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    38360099
383700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         38370099
383800                                                                  38380099
383900         PERFORM 4310-FETCH-CURSOR                                38390099
384000                                                                  38400099
384100         IF  ASC-ITEMS-LEFT-ON-DB                                 38410099
384200             PERFORM 4150-GET-TRLR-INFO                           38420099
384300             PERFORM 3250-GET-SEASET-NAME                         38430099
384400             PERFORM 4340-GET-ACTUAL-CRTN-CNT                     38440099
384500                                                                  38450099
384600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                38460099
384700                 ADD +1            TO ASC-ITEM-SUB                38470099
384800             ELSE                                                 38480099
384900                 ADD +1            TO ASC-BLK-SUB                 38490099
385000                 MOVE +1           TO ASC-ITEM-SUB                38500099
385100                                                                  38510099
385200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         38520099
385300                     MOVE +1       TO ASC-BLK-SUB                 38530099
385400                     SET ASC-BLOCK-MODIFIED (1)                   38540099
385500                                   TO TRUE                        38550099
385600                     PERFORM 5100-WRITE-TEMP-STORAGE              38560099
385700                     MOVE ASC-BLOCK-ENTRIES                       38570099
385800                               (PC-MAX-BLOCKS-IN-ARRAY)           38580099
385900                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 38590099
386000                     ADD +1        TO ASC-BLK-SUB                 38600099
386100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   38610099
386200                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      38620099
386300                                   TO TRUE                        38630099
386400                 END-IF                                           38640099
386500             END-IF                                               38650099
386600                                                                  38660099
386700             PERFORM 4200-GET-MAX-TRLR-STATUS                     38670099
386800                                                                  38680099
386900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    38690099
387000             MOVE ASC-NUMBER-OF-ITEMS-READ                        38700099
387100                                   TO ASC-LIST-ITEM-NUMBER        38710099
387200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38720099
387300             MOVE SPACES                 TO  ASC-ACTION           38730099
387400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38740099
387500             MOVE DK-SCAC            TO ASC-SCAC                  38750099
387600*            MOVE ASC-SCAC-ID        TO ASC-SCAC                  38760099
387700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38770099
387800             MOVE DK-TRLR-NBR        TO ASC-TRLR-NBR              38780099
387900*            MOVE ASC-TRLR-NUMBER    TO ASC-TRLR-NBR              38790099
388000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38800099
388100             MOVE DK-TRIP-ID         TO ASC-TRIP                  38810099
388200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38820099
388300             MOVE PV-TRLR-STATUS     TO ASC-TRLR-LN-STATUS        38830099
388400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38840099
388500             MOVE PV-PO-RECEIVER     TO ASC-PO-RECEIVER           38850099
388600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38860099
388700             PERFORM 4380-CHECK-IF-TRANSCRIBED                    38870099
388800             PERFORM 4385-CHECK-IF-IN-TROUBLE                     38880099
388900             MOVE PV-PACK-TYPE       TO ASC-PACK-TYPE             38890099
389000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38900099
389100             MOVE PURCHS-SEASET-SHRT-NM TO ASC-SEASET-NAME        38910099
389200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38920099
389300             MOVE ENTNME-ENT-NAME-DESC TO ASC-VND-NME             38930099
389400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38940099
389500*** MOVE FOR ACTUAL CTN COUNT                                     38950099
389600             MOVE PV-DB2-COUNT-ACTL-CTN                           38960099
389700                                       TO ASC-ACTL-CART-COUNT     38970099
389800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38980099
389900             MOVE PV-RCVR-CRE-DATE   TO ASC-CREATE-DATE           38990099
390000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 39000099
390100         END-IF                                                   39010099
390200     END-PERFORM.                                                 39020099
390300                                                                  39030099
390400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          39040099
390500         MOVE +1               TO ASC-BLK-SUB                     39050099
390600         PERFORM 5100-WRITE-TEMP-STORAGE                          39060099
390700         ADD +1                TO ASC-BLK-SUB                     39070099
390800         PERFORM 5100-WRITE-TEMP-STORAGE                          39080099
390900                                                                  39090099
391000         MOVE 1                TO ASC-BLK-SUB                     39100099
391100                                  PV-BLOCK-NUMBER                 39110099
391200         PERFORM 4410-READ-TEMP-STORAGE                           39120099
391300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             39130099
391400             MOVE 2            TO ASC-BLK-SUB                     39140099
391500                                  PV-BLOCK-NUMBER                 39150099
391600             PERFORM 4410-READ-TEMP-STORAGE                       39160099
391700         END-IF                                                   39170099
391800     END-IF.                                                      39180099
391900                                                                  39190099
392000*----------------------------------------------------------------*39200099
392100* FETCH CURSOR                                                    39210099
392200*----------------------------------------------------------------*39220099
392300 4310-FETCH-CURSOR.                                               39230099
392400     EVALUATE TRUE                                                39240099
392500         WHEN ASC-CURR-DTE-S-CSR                                  39250099
392600              EXEC SQL                                            39260099
392700                   FETCH CURR-DTE-S-CSR                           39270099
392800                   INTO   :VHTRIP-TRIP-ID                         39280099
392900                        , :VHTRIP-OWNER-SCAC-ID                   39290099
393000                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             39300099
393100                        , :SHIPMT-SHIPT-ID                        39310099
393200                        , :RECEIV-ORD-NBR                         39320099
393300                        , :RECEIV-REC-SEQ-NBR                     39330099
393400                        , :RECEIV-CRE-TMST                        39340099
393500                        , :RECEIV-PKGNG-CDE                       39350099
393600              END-EXEC                                            39360099
393700                                                                  39370099
393800         WHEN ASC-CURR-DTE-A-CSR                                  39380099
393900              EXEC SQL                                            39390099
394000                   FETCH CURR-DTE-A-CSR                           39400099
394100                   INTO   :VHTRIP-TRIP-ID                         39410099
394200                        , :VHTRIP-OWNER-SCAC-ID                   39420099
394300                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             39430099
394400                        , :SHIPMT-SHIPT-ID                        39440099
394500                        , :RECEIV-ORD-NBR                         39450099
394600                        , :RECEIV-REC-SEQ-NBR                     39460099
394700                        , :RECEIV-CRE-TMST                        39470099
394800                        , :RECEIV-PKGNG-CDE                       39480099
394900              END-EXEC                                            39490099
395000                                                                  39500099
395100         WHEN ASC-CURR-DTE-D-CSR                                  39510099
395200              EXEC SQL                                            39520099
395300                   FETCH CURR-DTE-D-CSR                           39530099
395400                   INTO   :VHTRIP-TRIP-ID                         39540099
395500                        , :VHTRIP-OWNER-SCAC-ID                   39550099
395600                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             39560099
395700                        , :SHIPMT-SHIPT-ID                        39570099
395800                        , :RECEIV-ORD-NBR                         39580099
395900                        , :RECEIV-REC-SEQ-NBR                     39590099
396000                        , :RECEIV-CRE-TMST                        39600099
396100                        , :RECEIV-PKGNG-CDE                       39610099
396200              END-EXEC                                            39620099
396300************                                                      39630099
396400         WHEN ASC-DATE-RNGE-S-CSR                                 39640099
396500              EXEC SQL                                            39650099
396600                   FETCH DATE-RNGE-S-CSR                          39660099
396700                   INTO   :VHTRIP-TRIP-ID                         39670099
396800                        , :VHTRIP-OWNER-SCAC-ID                   39680099
396900                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             39690099
397000                        , :SHIPMT-SHIPT-ID                        39700099
397100                        , :RECEIV-ORD-NBR                         39710099
397200                        , :RECEIV-REC-SEQ-NBR                     39720099
397300                        , :RECEIV-CRE-TMST                        39730099
397400                        , :RECEIV-PKGNG-CDE                       39740099
397500              END-EXEC                                            39750099
397600                                                                  39760099
397700         WHEN ASC-DATE-RNGE-A-CSR                                 39770099
397800              EXEC SQL                                            39780099
397900                   FETCH DATE-RNGE-A-CSR                          39790099
398000                   INTO   :VHTRIP-TRIP-ID                         39800099
398100                        , :VHTRIP-OWNER-SCAC-ID                   39810099
398200                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             39820099
398300                        , :SHIPMT-SHIPT-ID                        39830099
398400                        , :RECEIV-ORD-NBR                         39840099
398500                        , :RECEIV-REC-SEQ-NBR                     39850099
398600                        , :RECEIV-CRE-TMST                        39860099
398700                        , :RECEIV-PKGNG-CDE                       39870099
398800              END-EXEC                                            39880099
398900                                                                  39890099
399000         WHEN ASC-DATE-RNGE-D-CSR                                 39900099
399100              EXEC SQL                                            39910099
399200                   FETCH DATE-RNGE-D-CSR                          39920099
399300                   INTO   :VHTRIP-TRIP-ID                         39930099
399400                        , :VHTRIP-OWNER-SCAC-ID                   39940099
399500                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             39950099
399600                        , :SHIPMT-SHIPT-ID                        39960099
399700                        , :RECEIV-ORD-NBR                         39970099
399800                        , :RECEIV-REC-SEQ-NBR                     39980099
399900                        , :RECEIV-CRE-TMST                        39990099
400000                        , :RECEIV-PKGNG-CDE                       40000099
400100              END-EXEC                                            40010099
400200*********************                                             40020099
400300         WHEN ASC-SCAC-TRLR-S-CSR                                 40030099
400400              EXEC SQL                                            40040099
400500                   FETCH SCAC-TRLR-S-CSR                          40050099
400600                   INTO   :VHTRIP-TRIP-ID                         40060099
400700                        , :VHTRIP-OWNER-SCAC-ID                   40070099
400800                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             40080099
400900                        , :SHIPMT-SHIPT-ID                        40090099
401000                        , :RECEIV-ORD-NBR                         40100099
401100                        , :RECEIV-REC-SEQ-NBR                     40110099
401200                        , :RECEIV-CRE-TMST                        40120099
401300                        , :RECEIV-PKGNG-CDE                       40130099
401400              END-EXEC                                            40140099
401500                                                                  40150099
401600         WHEN ASC-SCAC-TRLR-A-CSR                                 40160099
401700              EXEC SQL                                            40170099
401800                   FETCH SCAC-TRLR-A-CSR                          40180099
401900                   INTO   :VHTRIP-TRIP-ID                         40190099
402000                        , :VHTRIP-OWNER-SCAC-ID                   40200099
402100                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             40210099
402200                        , :SHIPMT-SHIPT-ID                        40220099
402300                        , :RECEIV-ORD-NBR                         40230099
402400                        , :RECEIV-REC-SEQ-NBR                     40240099
402500                        , :RECEIV-CRE-TMST                        40250099
402600                        , :RECEIV-PKGNG-CDE                       40260099
402700              END-EXEC                                            40270099
402800                                                                  40280099
402900         WHEN ASC-SCAC-TRLR-D-CSR                                 40290099
403000              EXEC SQL                                            40300099
403100                   FETCH SCAC-TRLR-D-CSR                          40310099
403200                   INTO   :VHTRIP-TRIP-ID                         40320099
403300                        , :VHTRIP-OWNER-SCAC-ID                   40330099
403400                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             40340099
403500                        , :SHIPMT-SHIPT-ID                        40350099
403600                        , :RECEIV-ORD-NBR                         40360099
403700                        , :RECEIV-REC-SEQ-NBR                     40370099
403800                        , :RECEIV-CRE-TMST                        40380099
403900                        , :RECEIV-PKGNG-CDE                       40390099
404000              END-EXEC                                            40400099
404100**********                                                        40410099
404200         WHEN ASC-TRIP-ID-S-CSR                                   40420099
404300              EXEC SQL                                            40430099
404400                   FETCH TRIP-ID-S-CSR                            40440099
404500                   INTO   :SHIPMT-SHIPT-ID                        40450099
404600                        , :RECEIV-ORD-NBR                         40460099
404700                        , :RECEIV-REC-SEQ-NBR                     40470099
404800                        , :RECEIV-CRE-TMST                        40480099
404900                        , :RECEIV-PKGNG-CDE                       40490099
405000                        , :VHTRIP-OWNER-SCAC-ID                   40500099
405100                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             40510099
405200              END-EXEC                                            40520099
405300                                                                  40530099
405400         WHEN ASC-TRIP-ID-A-CSR                                   40540099
405500              EXEC SQL                                            40550099
405600                   FETCH TRIP-ID-A-CSR                            40560099
405700                   INTO   :SHIPMT-SHIPT-ID                        40570099
405800                        , :RECEIV-ORD-NBR                         40580099
405900                        , :RECEIV-REC-SEQ-NBR                     40590099
406000                        , :RECEIV-CRE-TMST                        40600099
406100                        , :RECEIV-PKGNG-CDE                       40610099
406200                        , :VHTRIP-OWNER-SCAC-ID                   40620099
406300                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             40630099
406400              END-EXEC                                            40640099
406500                                                                  40650099
406600         WHEN ASC-TRIP-ID-D-CSR                                   40660099
406700              EXEC SQL                                            40670099
406800                   FETCH TRIP-ID-D-CSR                            40680099
406900                   INTO   :SHIPMT-SHIPT-ID                        40690099
407000                        , :RECEIV-ORD-NBR                         40700099
407100                        , :RECEIV-REC-SEQ-NBR                     40710099
407200                        , :RECEIV-CRE-TMST                        40720099
407300                        , :RECEIV-PKGNG-CDE                       40730099
407400                        , :VHTRIP-OWNER-SCAC-ID                   40740099
407500                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             40750099
407600              END-EXEC                                            40760099
407700*************                                                     40770099
407800         WHEN ASC-PO-CURR-DTE-S-CSR                               40780099
407900              EXEC SQL                                            40790099
408000                   FETCH PO-CURR-DTE-S-CSR                        40800099
408100                   INTO   :SHIPMT-SHIPT-ID                        40810099
408200                        , :RECEIV-ORD-NBR                         40820099
408300                        , :RECEIV-REC-SEQ-NBR                     40830099
408400                        , :RECEIV-CRE-TMST                        40840099
408500                        , :SHIPMT-TRIP-ID                         40850099
408600                        , :RECEIV-PKGNG-CDE                       40860099
408700                        , :VHTRIP-OWNER-SCAC-ID                   40870099
408800                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             40880099
408900              END-EXEC                                            40890099
409000                                                                  40900099
409100         WHEN ASC-PO-CURR-DTE-A-CSR                               40910099
409200              EXEC SQL                                            40920099
409300                   FETCH PO-CURR-DTE-A-CSR                        40930099
409400                   INTO   :SHIPMT-SHIPT-ID                        40940099
409500                        , :RECEIV-ORD-NBR                         40950099
409600                        , :RECEIV-REC-SEQ-NBR                     40960099
409700                        , :RECEIV-CRE-TMST                        40970099
409800                        , :SHIPMT-TRIP-ID                         40980099
409900                        , :RECEIV-PKGNG-CDE                       40990099
410000                        , :VHTRIP-OWNER-SCAC-ID                   41000099
410100                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             41010099
410200              END-EXEC                                            41020099
410300                                                                  41030099
410400         WHEN ASC-PO-CURR-DTE-D-CSR                               41040099
410500              EXEC SQL                                            41050099
410600                   FETCH PO-CURR-DTE-D-CSR                        41060099
410700                   INTO   :SHIPMT-SHIPT-ID                        41070099
410800                        , :RECEIV-ORD-NBR                         41080099
410900                        , :RECEIV-REC-SEQ-NBR                     41090099
411000                        , :RECEIV-CRE-TMST                        41100099
411100                        , :SHIPMT-TRIP-ID                         41110099
411200                        , :RECEIV-PKGNG-CDE                       41120099
411300                        , :VHTRIP-OWNER-SCAC-ID                   41130099
411400                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             41140099
411500              END-EXEC                                            41150099
411600**************                                                    41160099
411700         WHEN ASC-PO-DTE-RNGE-S-CSR                               41170099
411800              EXEC SQL                                            41180099
411900                   FETCH PO-DATE-RNGE-S-CSR                       41190099
412000                   INTO   :SHIPMT-SHIPT-ID                        41200099
412100                        , :RECEIV-ORD-NBR                         41210099
412200                        , :RECEIV-REC-SEQ-NBR                     41220099
412300                        , :RECEIV-CRE-TMST                        41230099
412400                        , :SHIPMT-TRIP-ID                         41240099
412500                        , :RECEIV-PKGNG-CDE                       41250099
412600                        , :VHTRIP-OWNER-SCAC-ID                   41260099
412700                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             41270099
412800              END-EXEC                                            41280099
412900                                                                  41290099
413000         WHEN ASC-PO-DTE-RNGE-A-CSR                               41300099
413100              EXEC SQL                                            41310099
413200                   FETCH PO-DATE-RNGE-A-CSR                       41320099
413300                   INTO   :SHIPMT-SHIPT-ID                        41330099
413400                        , :RECEIV-ORD-NBR                         41340099
413500                        , :RECEIV-REC-SEQ-NBR                     41350099
413600                        , :RECEIV-CRE-TMST                        41360099
413700                        , :SHIPMT-TRIP-ID                         41370099
413800                        , :RECEIV-PKGNG-CDE                       41380099
413900                        , :VHTRIP-OWNER-SCAC-ID                   41390099
414000                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             41400099
414100              END-EXEC                                            41410099
414200                                                                  41420099
414300         WHEN ASC-PO-DTE-RNGE-D-CSR                               41430099
414400              EXEC SQL                                            41440099
414500                   FETCH PO-DATE-RNGE-D-CSR                       41450099
414600                   INTO   :SHIPMT-SHIPT-ID                        41460099
414700                        , :RECEIV-ORD-NBR                         41470099
414800                        , :RECEIV-REC-SEQ-NBR                     41480099
414900                        , :RECEIV-CRE-TMST                        41490099
415000                        , :SHIPMT-TRIP-ID                         41500099
415100                        , :RECEIV-PKGNG-CDE                       41510099
415200                        , :VHTRIP-OWNER-SCAC-ID                   41520099
415300                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             41530099
415400              END-EXEC                                            41540099
415500************                                                      41550099
415600         WHEN ASC-PO-RCVR-S-CSR                                   41560099
415700              EXEC SQL                                            41570099
415800                   FETCH PO-RCVR-S-CSR                            41580099
415900                   INTO   :SHIPMT-SHIPT-ID                        41590099
416000                        , :RECEIV-ORD-NBR                         41600099
416100                        , :RECEIV-REC-SEQ-NBR                     41610099
416200                        , :RECEIV-CRE-TMST                        41620099
416300                        , :SHIPMT-TRIP-ID                         41630099
416400                        , :RECEIV-PKGNG-CDE                       41640099
416500                        , :VHTRIP-OWNER-SCAC-ID                   41650099
416600                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             41660099
416700              END-EXEC                                            41670099
416800                                                                  41680099
416900         WHEN ASC-PO-RCVR-A-CSR                                   41690099
417000              EXEC SQL                                            41700099
417100                   FETCH PO-RCVR-A-CSR                            41710099
417200                   INTO   :SHIPMT-SHIPT-ID                        41720099
417300                        , :RECEIV-ORD-NBR                         41730099
417400                        , :RECEIV-REC-SEQ-NBR                     41740099
417500                        , :RECEIV-CRE-TMST                        41750099
417600                        , :SHIPMT-TRIP-ID                         41760099
417700                        , :RECEIV-PKGNG-CDE                       41770099
417800                        , :VHTRIP-OWNER-SCAC-ID                   41780099
417900                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             41790099
418000              END-EXEC                                            41800099
418100         WHEN ASC-PO-RCVR-D-CSR                                   41810099
418200              EXEC SQL                                            41820099
418300                   FETCH PO-RCVR-D-CSR                            41830099
418400                   INTO   :SHIPMT-SHIPT-ID                        41840099
418500                        , :RECEIV-ORD-NBR                         41850099
418600                        , :RECEIV-REC-SEQ-NBR                     41860099
418700                        , :RECEIV-CRE-TMST                        41870099
418800                        , :SHIPMT-TRIP-ID                         41880099
418900                        , :RECEIV-PKGNG-CDE                       41890099
419000                        , :VHTRIP-OWNER-SCAC-ID                   41900099
419100                        , :VHTRIP-VEH-NBR :DN-VEH-NBR             41910099
419200              END-EXEC                                            41920099
419300     END-EVALUATE                                                 41930099
419400                                                                  41940099
419500     EVALUATE TRUE                                                41950099
419600         WHEN SQLCODE = +0                                        41960099
419700              IF DN-VEH-NBR = -1                                  41970099
419800                 MOVE SPACES       TO   DK-TRLR-NBR               41980099
419900              END-IF                                              41990099
420000                                                                  42000099
420100              MOVE RECEIV-CRE-TMST(6:2) TO PV-CRE-MM              42010099
420200              MOVE RECEIV-CRE-TMST(9:2) TO PV-CRE-DD              42020099
420300              MOVE RECEIV-PKGNG-CDE     TO PV-PACK-TYPE           42030099
420400                                                                  42040099
420500              IF  PV-INNER-PREPK                                  42050099
420600                  MOVE  PC-INNER-PREPACK TO PV-PACK-TYPE          42060099
420700              ELSE                                                42070099
420800              IF  PV-MULTI-SKU-PREPK                              42080099
420900                  MOVE  PC-MULTI-SKU     TO PV-PACK-TYPE          42090099
421000              ELSE                                                42100099
421100              IF  PV-SINGLE-SKU-PREPK                             42110099
421200                  MOVE  PC-SINGLE-SKU    TO PV-PACK-TYPE          42120099
421300              ELSE                                                42130099
421400              IF  PV-CASEPACK                                     42140099
421500                  MOVE  PC-CASEPACK      TO PV-PACK-TYPE          42150099
421600              ELSE                                                42160099
421700              IF  PV-BULK-PACK                                    42170099
421800                  MOVE  PC-BULK          TO PV-PACK-TYPE          42180099
421900              END-IF                                              42190099
422000              IF  PV-PBS                                          42200099
422100                  MOVE  PC-PBS           TO PV-PACK-TYPE          42210099
422200              END-IF                                              42220099
422300              END-IF                                              42230099
422400              END-IF                                              42240099
422500              END-IF                                              42250099
422600              END-IF                                              42260099
422700         WHEN SQLCODE = +100                                      42270099
422800              SET ASC-NO-ITEMS-LEFT-ON-DB                         42280099
422900                                         TO TRUE                  42290099
423000              MOVE PC-FREE-ASTRAY        TO PV-PACK-TYPE          42300099
423100         WHEN OTHER                                               42310099
423200              MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER         42320099
423300              MOVE DK-TRIP-ID             TO PV-DISP-TRIP         42330099
423400              MOVE DK-PO-NBR              TO PV-DISP-PO           42340099
423500              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         42350099
423600              STRING  ' SUKCS761- 4310-  '      DELIMITED BY SIZE 42360099
423700                      ' OPER- '                 DELIMITED BY SIZE 42370099
423800                      PV-DISP-OPER              DELIMITED BY SIZE 42380099
423900                      ' SCAC- '                 DELIMITED BY SIZE 42390099
424000                      DK-SCAC                   DELIMITED BY SIZE 42400099
424100                      ' TRLR- '                 DELIMITED BY SIZE 42410099
424200                      DK-TRLR-NBR               DELIMITED BY SIZE 42420099
424300                      ' TRIP- '                 DELIMITED BY SIZE 42430099
424400                      PV-DISP-TRIP              DELIMITED BY SIZE 42440099
424500                      ' PO-'                    DELIMITED BY SIZE 42450099
424600                      PV-DISP-PO                DELIMITED BY SIZE 42460099
424700                      ' RCVR- '                 DELIMITED BY SIZE 42470099
424800                      PV-DISP-RCVR              DELIMITED BY SIZE 42480099
424900                                     INTO PV-CICS-MSG-AREA        42490099
425000              PERFORM 9900-WRITE-CICS-LOG                         42500099
425100                                                                  42510099
425200              STRING  ' SUKCS761- 4310-  '      DELIMITED BY SIZE 42520099
425300                       ' CURR DTE- '             DELIMITED BY SIZE42530099
425400                       DK-CURR-DATE              DELIMITED BY SIZE42540099
425500                       ' FROM DTE- '             DELIMITED BY SIZE42550099
425600                       DK-FROM-DATE              DELIMITED BY SIZE42560099
425700                       ' TO DTE- '               DELIMITED BY SIZE42570099
425800                       DK-TO-DATE                DELIMITED BY SIZE42580099
425900                                      INTO PV-CICS-MSG-AREA       42590099
426000              PERFORM 9900-WRITE-CICS-LOG                         42600099
426100              MOVE '4310-FETCH-CURSOR'                            42610099
426200                               TO DP013-PARAGRAPH                 42620099
426300              MOVE 'FETCH CURSOR'                                 42630099
426400                               TO DP013-MESSAGE-TEXT (1)          42640099
426500              MOVE 'CURSOR TYPE ' TO PV-ERROR-TEXT1               42650099
426600              MOVE ASC-CURSOR-SW                                  42660099
426700                              TO PV-ERROR-TEXT2                   42670099
426800              MOVE PV-ERROR-MSG                                   42680099
426900                              TO DP013-MESSAGE-TEXT (2)           42690099
427000              MOVE SQLCA       TO DP013-SQLCA                     42700099
427100              SET DP013-DB2-ABEND                                 42710099
427200                               TO TRUE                            42720099
427300              PERFORM DP013-0000-PROCESS-ABEND                    42730099
427400     END-EVALUATE                                                 42740099
427500                                                                  42750099
427600     IF SQLCODE = +0                                              42760099
427700         MOVE RECEIV-ORD-NBR     TO DK-PO-NBR                     42770099
427800                                    PV-PO-NUMBER                  42780099
427900         MOVE RECEIV-REC-SEQ-NBR TO DK-REC-SEQ-NBR                42790099
428000                                    PV-REC-SEQ-NBR                42800099
428100                                                                  42810099
428200         EVALUATE TRUE                                            42820099
428300           WHEN ASC-CURR-DTE-S-CSR                                42830099
428400           WHEN ASC-CURR-DTE-A-CSR                                42840099
428500           WHEN ASC-CURR-DTE-D-CSR                                42850099
428600           WHEN ASC-DATE-RNGE-S-CSR                               42860099
428700           WHEN ASC-DATE-RNGE-A-CSR                               42870099
428800           WHEN ASC-DATE-RNGE-D-CSR                               42880099
428900           WHEN ASC-SCAC-TRLR-S-CSR                               42890099
429000           WHEN ASC-SCAC-TRLR-A-CSR                               42900099
429100           WHEN ASC-SCAC-TRLR-D-CSR                               42910099
429200                                                                  42920099
429300           MOVE VHTRIP-TRIP-ID     TO DK-TRIP-ID                  42930099
429400                                                                  42940099
429500           WHEN ASC-PO-CURR-DTE-S-CSR                             42950099
429600           WHEN ASC-PO-CURR-DTE-A-CSR                             42960099
429700           WHEN ASC-PO-CURR-DTE-D-CSR                             42970099
429800           WHEN ASC-PO-DTE-RNGE-S-CSR                             42980099
429900           WHEN ASC-PO-DTE-RNGE-A-CSR                             42990099
430000           WHEN ASC-PO-DTE-RNGE-D-CSR                             43000099
430100           WHEN ASC-PO-RCVR-S-CSR                                 43010099
430200           WHEN ASC-PO-RCVR-A-CSR                                 43020099
430300           WHEN ASC-PO-RCVR-D-CSR                                 43030099
430400                IF DK-TRIP-ID = ZERO                              43040099
430500                   MOVE SHIPMT-TRIP-ID     TO DK-TRIP-ID          43050099
430600                END-IF                                            43060099
430700         END-EVALUATE                                             43070099
430800                                                                  43080099
430900         PERFORM  5910-GET-ENT-NAME-DESC                          43090099
431000     END-IF.                                                      43100099
431100                                                                  43110099
431200******************************************************************43120099
431300* THIS IS THE COUNT OF ACTUAL SCANNED-IN CARTONS                  43130099
431400******************************************************************43140099
431500 4340-GET-ACTUAL-CRTN-CNT.                                        43150099
431600         EXEC SQL                                                 43160099
431700                SELECT COUNT(C.SHIPT_UNT_ID)                      43170099
431800                INTO  :PV-DB2-COUNT-ACTL-CTN                      43180099
431900                FROM   TPKSLIP A                                  43190099
432000                     , TINPKSU B                                  43200099
432100                     , TSHUNLO C                                  43210099
432200                WHERE   A.PO_NBR       = :DK-PO-NBR               43220099
432300                  AND   A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR          43230099
432400                  AND   A.VER_STAT_CDE = 'A'                      43240099
432500                  AND   A.PO_NBR       = B.PO_NBR                 43250099
432600                  AND   A.SEQ_NBR      = B.SEQ_NBR                43260099
432700                  AND   B.SHIPT_UNT_ID = C.SHIPT_UNT_ID           43270099
432800                  AND   C.SCN_LOC_ID   = 'RECV'                   43280099
432900                  AND   C.TRIP_ID      = :DK-TRIP-ID              43290099
433000         WITH UR                                                  43300099
433100         END-EXEC                                                 43310099
433200                                                                  43320099
433300         EVALUATE TRUE                                            43330099
433400             WHEN SQLCODE = +0                                    43340099
433500                  CONTINUE                                        43350099
433600             WHEN SQLCODE = +100                                  43360099
433700                  MOVE ZEROES TO PV-DB2-COUNT-ACTL-CTN            43370099
433800             WHEN OTHER                                           43380099
433900                  MOVE DK-PO-NBR        TO PV-DISP-PO             43390099
434000                  MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR           43400099
434100                  MOVE DK-TRIP-ID       TO PV-DISP-TRIP           43410099
434200                                                                  43420099
434300               STRING  ' SUKCS761- 4340-  '      DELIMITED BY SIZE43430099
434400                       ' PO-'                    DELIMITED BY SIZE43440099
434500                       PV-DISP-PO                DELIMITED BY SIZE43450099
434600                       ' RCVR- '                 DELIMITED BY SIZE43460099
434700                       PV-DISP-RCVR              DELIMITED BY SIZE43470099
434800                       ' TRIP- '                 DELIMITED BY SIZE43480099
434900                       PV-DISP-TRIP              DELIMITED BY SIZE43490099
435000                                      INTO PV-CICS-MSG-AREA       43500099
435100                  PERFORM 9900-WRITE-CICS-LOG                     43510099
435200                                                                  43520099
435300                  MOVE '4340-GET-ACTUAL-CRTN-CNT'                 43530099
435400                                   TO DP013-PARAGRAPH             43540099
435500                  MOVE 'SELECT-ACTL-CRTN-CNT'                     43550099
435600                                   TO DP013-MESSAGE-TEXT (1)      43560099
435700                  MOVE DK-PO-NBR  TO PV-ERROR-PO                  43570099
435800                  MOVE DK-REC-SEQ-NBR                             43580099
435900                                  TO PV-ERROR-SEQ                 43590099
436000                  MOVE PV-ERROR-MSG                               43600099
436100                                  TO DP013-MESSAGE-TEXT (2)       43610099
436200                  MOVE SQLCA       TO DP013-SQLCA                 43620099
436300                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     43630099
436400                  SET DP013-DB2-ABEND                             43640099
436500                                   TO TRUE                        43650099
436600                  PERFORM DP013-0000-PROCESS-ABEND                43660099
436700         END-EVALUATE.                                            43670099
436800                                                                  43680099
436900****************************************************************  43690099
437000*GET CORRECT OPER AND FACILITY WHEN GOING TO                 ***  43700099
437100*RCVRINQ OR RCVRMNT SCREENS                                  ***  43710099
437200****************************************************************  43720099
437300 4370-CHECK-OPER-AND-FACILTY.                                     43730099
437400                                                                  43740099
437500         EXEC SQL                                                 43750099
437600                SELECT OPER_UNT_ID                                43760099
437700                     , FCLTY_ID                                   43770099
437800                     , STATUS_CDE                                 43780099
437900                INTO  :RECEIV-OPER-UNT-ID                         43790099
438000                     ,:RECEIV-FCLTY-ID                            43800099
438100                     ,:RECEIV-STATUS-CDE                          43810099
438200                FROM    TRECEIV                                   43820099
438300                WHERE   ORD_NBR     = :DK-PO-NBR                  43830099
438400                  AND   REC_SEQ_NBR = :DK-REC-SEQ-NBR             43840099
438500         WITH UR                                                  43850099
438600         END-EXEC                                                 43860099
438700                                                                  43870099
438800         EVALUATE TRUE                                            43880099
438900             WHEN SQLCODE = +0                                    43890099
439000             WHEN SQLCODE = +100                                  43900099
439100                  MOVE RECEIV-OPER-UNT-ID TO ASC-KEY-OPER-UNT-ID  43910099
439200                  MOVE RECEIV-FCLTY-ID    TO ASC-KEY-FCLTY-ID     43920099
439300             WHEN OTHER                                           43930099
439400                  MOVE DK-PO-NBR        TO PV-DISP-PO             43940099
439500                  MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR           43950099
439600                                                                  43960099
439700               STRING  ' SUKCS761- 4370-  '      DELIMITED BY SIZE43970099
439800                       ' PO-'                    DELIMITED BY SIZE43980099
439900                       PV-DISP-PO                DELIMITED BY SIZE43990099
440000                       ' RCVR- '                 DELIMITED BY SIZE44000099
440100                       PV-DISP-RCVR              DELIMITED BY SIZE44010099
440200                                      INTO PV-CICS-MSG-AREA       44020099
440300                  PERFORM 9900-WRITE-CICS-LOG                     44030099
440400                                                                  44040099
440500                  MOVE '4370-CHECK-OPER-AND-FACILTY '             44050099
440600                                   TO DP013-PARAGRAPH             44060099
440700                  MOVE 'FETCH MESSAGE CURSOR'                     44070099
440800                                   TO DP013-MESSAGE-TEXT (1)      44080099
440900                  MOVE DK-PO-NBR  TO PV-ERROR-PO                  44090099
441000                  MOVE DK-REC-SEQ-NBR                             44100099
441100                                  TO PV-ERROR-SEQ                 44110099
441200                  MOVE PV-ERROR-MSG                               44120099
441300                                  TO DP013-MESSAGE-TEXT (2)       44130099
441400                  MOVE SQLCA       TO DP013-SQLCA                 44140099
441500                  SET DP013-DB2-ABEND                             44150099
441600                                   TO TRUE                        44160099
441700                  PERFORM DP013-0000-PROCESS-ABEND                44170099
441800         END-EVALUATE.                                            44180099
441900                                                                  44190099
442000*----------------------------------------------------------------*44200099
442100* CHECK THE PO #/RECV SEQ # TO SEE IF IT HAS BEEN TRANSCRIBED.    44210099
442200*----------------------------------------------------------------*44220099
442300 4380-CHECK-IF-TRANSCRIBED.                                       44230099
442400     EXEC SQL                                                     44240099
442500         SELECT PKSL_STAT_CDE                                     44250099
442600          INTO :PKSLIP-PKSL-STAT-CDE                              44260099
442700          FROM  TPKSLIP                                           44270099
442800          WHERE  PO_NBR           =  :DK-PO-NBR                   44280099
442900          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              44290099
443000          AND    VER_STAT_CDE     =  'A'                          44300099
443100     END-EXEC.                                                    44310099
443200                                                                  44320099
443300     EVALUATE TRUE                                                44330099
443400         WHEN SQLCODE = +0                                        44340099
443500         WHEN SQLCODE = -811                                      44350099
443600            IF PKSLIP-PKSL-STAT-CDE = 'AC'                        44360099
443700                MOVE 'A' TO ASC-CSR-IND (ASC-BLK-SUB ASC-ITEM-SUB)44370099
443800            END-IF                                                44380099
443900         WHEN SQLCODE = +100                                      44390099
444000                MOVE SPACES TO                                    44400099
444100                            ASC-CSR-IND (ASC-BLK-SUB ASC-ITEM-SUB)44410099
444200         WHEN OTHER                                               44420099
444300            MOVE DK-PO-NBR        TO PV-DISP-PO                   44430099
444400            MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                 44440099
444500                                                                  44450099
444600            STRING  ' SUKCS761- 4380-  '      DELIMITED BY SIZE   44460099
444700                    ' PO-'                    DELIMITED BY SIZE   44470099
444800                    PV-DISP-PO                DELIMITED BY SIZE   44480099
444900                    ' RCVR- '                 DELIMITED BY SIZE   44490099
445000                    PV-DISP-RCVR              DELIMITED BY SIZE   44500099
445100                                      INTO PV-CICS-MSG-AREA       44510099
445200            PERFORM 9900-WRITE-CICS-LOG                           44520099
445300     END-EVALUATE.                                                44530099
445400                                                                  44540099
445500*----------------------------------------------------------------*44550099
445600* CHECK IF TROUBLE NOTIFICATION EXISTS FOR THE PO #/RECV SEQ #.  *44560099
445700*----------------------------------------------------------------*44570099
445800 4385-CHECK-IF-IN-TROUBLE.                                        44580099
445900     EXEC SQL                                                     44590099
446000         SELECT B.TRBL_LONG_DESC                                  44600099
446100          INTO :TRBRSN-TRBL-LONG-DESC                             44610099
446200          FROM  TTRBNTF A                                         44620099
446300               ,TTRBRSN B                                         44630099
446400          WHERE  A.PO_NBR           =  :DK-PO-NBR                 44640099
446500          AND    A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR            44650099
446600          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             44660099
446700          AND  ((A.RESOLVED_IND    IN  ('N','I','R')              44670099
446800          AND    B.NOTIF_IND        =  'T')                       44680099
446900           OR    B.TRBL_RSN_CDE     =  803)                       44690099
447000     END-EXEC.                                                    44700099
447100                                                                  44710099
447200     EVALUATE TRUE                                                44720099
447300         WHEN SQLCODE = +0                                        44730099
447400         WHEN SQLCODE = -811                                      44740099
447500            MOVE 'R' TO ASC-RED-IND (ASC-BLK-SUB ASC-ITEM-SUB)    44750099
447600         WHEN SQLCODE = +100                                      44760099
447700            MOVE SPACES TO ASC-RED-IND (ASC-BLK-SUB ASC-ITEM-SUB) 44770099
447800         WHEN OTHER                                               44780099
447900            MOVE DK-PO-NBR        TO PV-DISP-PO                   44790099
448000            MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                 44800099
448100                                                                  44810099
448200            STRING  ' SUKCS761- 4385-  '      DELIMITED BY SIZE   44820099
448300                    ' PO-'                    DELIMITED BY SIZE   44830099
448400                    PV-DISP-PO                DELIMITED BY SIZE   44840099
448500                    ' RCVR- '                 DELIMITED BY SIZE   44850099
448600                    PV-DISP-RCVR              DELIMITED BY SIZE   44860099
448700                                      INTO PV-CICS-MSG-AREA       44870099
448800            PERFORM 9900-WRITE-CICS-LOG                           44880099
448900     END-EVALUATE.                                                44890099
449000                                                                  44900099
449100*----------------------------------------------------------------*44910099
449200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *44920099
449300*----------------------------------------------------------------*44930099
449400 4400-MOVE-COMMAREA-TO-SCREEN.                                    44940099
449500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             44950099
449600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          44960099
449700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          44970099
449800             MOVE +1    TO ASC-BLK-SUB                            44980099
449900             PERFORM 5100-WRITE-TEMP-STORAGE                      44990099
450000             ADD +1     TO ASC-BLK-SUB                            45000099
450100             PERFORM 5100-WRITE-TEMP-STORAGE                      45010099
450200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             45020099
450300                 GIVING PV-BLOCK-NUMBER                           45030099
450400                 REMAINDER PV-REMAINDER                           45040099
450500             IF  PV-REMAINDER > ZERO                              45050099
450600                 ADD +1 TO PV-BLOCK-NUMBER                        45060099
450700             END-IF                                               45070099
450800             MOVE +1    TO ASC-BLK-SUB                            45080099
450900             PERFORM 4410-READ-TEMP-STORAGE                       45090099
451000             ADD +1     TO ASC-BLK-SUB                            45100099
451100                           PV-BLOCK-NUMBER                        45110099
451200             PERFORM 4410-READ-TEMP-STORAGE                       45120099
451300     END-IF.                                                      45130099
451400     MOVE +1            TO ASC-BLK-SUB.                           45140099
451500     COMPUTE ASC-ITEM-SUB =                                       45150099
451600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              45160099
451700         + PC-ITEMS-PER-PANEL).                                   45170099
451800                                                                  45180099
451900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        45190099
452000         ADD +1         TO ASC-BLK-SUB                            45200099
452100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            45210099
452200     END-IF.                                                      45220099
452300                                                                  45230099
452400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           45240099
452500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                45250099
452600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        45260099
452700     PERFORM 4420-FORMAT-LIST-LINES                               45270099
452800         VARYING PV-SUB                                           45280099
452900         FROM PC-ITEMS-PER-PANEL BY -1                            45290099
453000         UNTIL PV-SUB < +1.                                       45300099
453100                                                                  45310099
453200     COMPUTE ASC-ITEMS-DISPLAYED =                                45320099
453300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          45330099
453400     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    45340099
453500                                      ASTRTITO.                   45350099
453600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    45360099
453700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    45370099
453800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            45380099
453900                                   TO ASELITO.                    45390099
454000     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     45400099
454100     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    45410099
454200     MOVE ASC-FCLTY-NME            TO AFDESCO.                    45420099
454300                                                                  45430099
454400     MOVE ASC-LIST-SEQ-IND         TO ALSTSEQO.                   45440099
454500                                                                  45450099
454600     IF  DP020-MSG-NUMBER-X = SPACE                               45460099
454700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  45470099
454800*            --- MORE ITEMS TO DISPLAY ----                       45480099
454900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            45490099
455000             SET DP020-MSG-INFORMATIONAL TO TRUE                  45500099
455100         END-IF                                                   45510099
455200     END-IF.                                                      45520099
455300                                                                  45530099
455400*----------------------------------------------------------------*45540099
455500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *45550099
455600*----------------------------------------------------------------*45560099
455700 4410-READ-TEMP-STORAGE.                                          45570099
455800                                                                  45580099
455900     EXEC CICS                                                    45590099
456000         READQ TS                                                 45600099
456100             QUEUE (ASC-LIST-QUEUE-NAME)                          45610099
456200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               45620099
456300             ITEM  (PV-BLOCK-NUMBER)                              45630099
456400             RESP  (PV-CICS-RESP)                                 45640099
456500     END-EXEC.                                                    45650099
456600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       45660099
456700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     45670099
456800         CONTINUE                                                 45680099
456900     ELSE                                                         45690099
457000         SET DP013-CICS-ABEND     TO TRUE                         45700099
457100         SET DP013-NO-ROLLBACK    TO TRUE                         45710099
457200         MOVE '4410-READ-TEMP-STORAGE'                            45720099
457300                                  TO DP013-PARAGRAPH              45730099
457400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      45740099
457500                                  TO DP013-MESSAGE-TEXT(1)        45750099
457600         PERFORM DP013-0000-PROCESS-ABEND                         45760099
457700     END-IF.                                                      45770099
457800                                                                  45780099
457900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             45790099
458000                                                                  45800099
458100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         45810099
458200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               45820099
458300     END-IF.                                                      45830099
458400                                                                  45840099
458500*----------------------------------------------------------------*45850099
458600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *45860099
458700*----------------------------------------------------------------*45870099
458800 4420-FORMAT-LIST-LINES.                                          45880099
458900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      45890099
459000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                45900099
459100         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           45910099
459200         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           45920099
459300         MOVE SPACE              TO MR-ACTION  (PV-SUB)           45930099
459400                                    MR-SELECTI (PV-SUB)           45940099
459500                                    MR-SCAC    (PV-SUB)           45950099
459600                                    MR-TRLR-NBR  (PV-SUB)         45960099
459700                                    MR-TRIP-ID (PV-SUB)           45970099
459800                                    MR-TRLR-STATUS (PV-SUB)       45980099
459900                                    MR-PO-RCVR (PV-SUB)           45990099
460000                                    MR-PACK-TYPE (PV-SUB)         46000099
460100                                    MR-SEASET-NAME (PV-SUB)       46010099
460200                                    MR-VND-NME (PV-SUB)           46020099
460300                                    MR-ACTL-CART-COUNT-X (PV-SUB) 46030099
460400                                    MR-CREATE-DATE (PV-SUB)       46040099
460500     ELSE                                                         46050099
460600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      46060099
460700                                                   > SPACE        46070099
460800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 46080099
460900                                 TO MR-SELECTI (PV-SUB)           46090099
461000         ELSE                                                     46100099
461100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      46110099
461200                                 TO MR-SELECTI (PV-SUB)           46120099
461300         END-IF                                                   46130099
461400                                                                  46140099
461500         IF  DP030-SET-CURSOR-TRAILER                             46150099
461600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)46160099
461700                 > SPACE)                                         46170099
461800               OR (PV-SUB = 1))                                   46180099
461900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               46190099
462000                MOVE -1          TO MR-SELECTL (PV-SUB)           46200099
462100             END-IF                                               46210099
462200         END-IF                                                   46220099
462300                                                                  46230099
462400         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           46240099
462500             IF ASC-CSR-IND (ASC-BLK-SUB ASC-ITEM-SUB) = 'A'      46250099
462600                 MOVE DP015-BLUE   TO MR-ACTIONC (PV-SUB)         46260099
462700                                      MR-SCACC (PV-SUB)           46270099
462800                                      MR-TRLR-NBRC (PV-SUB)       46280099
462900                                      MR-TRIP-IDC (PV-SUB)        46290099
463000                                      MR-TRLR-STATUSC (PV-SUB)    46300099
463100                                      MR-PO-RCVRC (PV-SUB)        46310099
463200                                      MR-PACK-TYPEC (PV-SUB)      46320099
463300                                      MR-SEASET-NAMEC (PV-SUB)    46330099
463400                                      MR-VND-NMEC (PV-SUB)        46340099
463500                                      MR-ACTL-CART-COUNTC (PV-SUB)46350099
463600                                      MR-CREATE-DATEC (PV-SUB)    46360099
463700             ELSE                                                 46370099
463800                 MOVE DP015-YELLOW TO MR-ACTIONC (PV-SUB)         46380099
463900                                      MR-SCACC (PV-SUB)           46390099
464000                                      MR-TRLR-NBRC (PV-SUB)       46400099
464100                                      MR-TRIP-IDC (PV-SUB)        46410099
464200                                      MR-TRLR-STATUSC (PV-SUB)    46420099
464300                                      MR-PO-RCVRC (PV-SUB)        46430099
464400                                      MR-PACK-TYPEC (PV-SUB)      46440099
464500                                      MR-SEASET-NAMEC (PV-SUB)    46450099
464600                                      MR-VND-NMEC (PV-SUB)        46460099
464700                                      MR-ACTL-CART-COUNTC (PV-SUB)46470099
464800                                      MR-CREATE-DATEC (PV-SUB)    46480099
464900             END-IF                                               46490099
465000             IF ASC-RED-IND (ASC-BLK-SUB ASC-ITEM-SUB) = 'R'      46500099
465100                  MOVE DP015-RED TO   MR-PO-RCVRC (PV-SUB)        46510099
465200             END-IF                                               46520099
465300*HERE IS WHERE THE LIST LINES ARE MOVED TO THE SCREEN             46530099
465400             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           46540099
465500                                 TO MR-ACTION (PV-SUB)            46550099
465600             MOVE ASC-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)             46560099
465700                                 TO MR-SCAC (PV-SUB)              46570099
465800             MOVE ASC-TRLR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         46580099
465900                                 TO MR-TRLR-NBR (PV-SUB)          46590099
466000             MOVE ASC-TRIP (ASC-BLK-SUB ASC-ITEM-SUB)             46600099
466100                                 TO MR-TRIP-ID (PV-SUB)           46610099
466200             MOVE ASC-TRLR-LN-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)   46620099
466300                                 TO MR-TRLR-STATUS (PV-SUB)       46630099
466400             MOVE ASC-PO-RECEIVER  (ASC-BLK-SUB ASC-ITEM-SUB)     46640099
466500                                 TO MR-PO-RCVR (PV-SUB)           46650099
466600             MOVE ASC-PACK-TYPE    (ASC-BLK-SUB ASC-ITEM-SUB)     46660099
466700                                 TO MR-PACK-TYPE (PV-SUB)         46670099
466800             MOVE ASC-SEASET-NAME  (ASC-BLK-SUB ASC-ITEM-SUB)     46680099
466900                                 TO MR-SEASET-NAME (PV-SUB)       46690099
467000             MOVE ASC-VND-NME      (ASC-BLK-SUB ASC-ITEM-SUB)     46700099
467100                                 TO MR-VND-NME (PV-SUB)           46710099
467200             MOVE ASC-ACTL-CART-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)  46720099
467300                                 TO MR-ACTL-CART-COUNT (PV-SUB)   46730099
467400             MOVE ASC-CREATE-DATE   (ASC-BLK-SUB ASC-ITEM-SUB)    46740099
467500                                 TO MR-CREATE-DATE (PV-SUB)       46750099
467600         ELSE                                                     46760099
467700             IF ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    46770099
467800                 MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)       46780099
467900                                     TO MR-ACTION (PV-SUB)        46790099
468000             END-IF                                               46800099
468100         END-IF                                                   46810099
468200     END-IF.                                                      46820099
468300     SUBTRACT +1 FROM ASC-ITEM-SUB                                46830099
468400     IF  ASC-ITEM-SUB < + 1                                       46840099
468500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  46850099
468600         MOVE +1                 TO ASC-BLK-SUB                   46860099
468700     END-IF.                                                      46870099
468800******************************************************************46880099
468900** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **46890099
469000** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **46900099
469100** ISSUE A WARNING.                                             **46910099
469200******************************************************************46920099
469300 4430-CHECK-FOR-BEGIN-AND-END.                                    46930099
469400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       46940099
469500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     46950099
469600*            -- NO END-OF-RANGE SPECFIED ---                      46960099
469700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            46970099
469800             SET DP020-MSG-WARNING TO TRUE                        46980099
469900             PERFORM 4431-POSITION-AT-WARNING                     46990099
470000         END-IF                                                   47000099
470100     ELSE                                                         47010099
470200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     47020099
470300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                47030099
470400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            47040099
470500             SET DP020-MSG-WARNING TO TRUE                        47050099
470600             PERFORM 4431-POSITION-AT-WARNING                     47060099
470700         END-IF                                                   47070099
470800     END-IF.                                                      47080099
470900******************************************************************47090099
471000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **47100099
471100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **47110099
471200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **47120099
471300** POSITION THE CURSOR THERE.                                   **47130099
471400******************************************************************47140099
471500 4431-POSITION-AT-WARNING.                                        47150099
471600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 47160099
471700                    - PV-TOP-ITEM + 1.                            47170099
471800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      47180099
471900         CONTINUE                                                 47190099
472000     ELSE                                                         47200099
472100         SET DP030-SET-CURSOR-APPL-1                              47210099
472200                                   TO TRUE                        47220099
472300         MOVE -1                   TO MR-SELECTL (PV-SUB)         47230099
472400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         47240099
472500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         47250099
472600     END-IF.                                                      47260099
472700                                                                  47270099
472800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   47280099
472900                    - PV-TOP-ITEM + 1.                            47290099
473000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      47300099
473100         CONTINUE                                                 47310099
473200     ELSE                                                         47320099
473300         SET DP030-SET-CURSOR-APPL-1                              47330099
473400                                   TO TRUE                        47340099
473500         MOVE -1                   TO MR-SELECTL (PV-SUB)         47350099
473600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         47360099
473700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         47370099
473800     END-IF.                                                      47380099
473900                                                                  47390099
474000*----------------------------------------------------------------*47400099
474100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *47410099
474200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *47420099
474300* FOR THE SELECTED ITEMS QUEUE.                                  *47430099
474400*                                                                *47440099
474500* DETERMINE WHICH COPYBOOK WILL BE USED TO PREPARE THE SELECTION *47450099
474600* QUEUE BASED ON THE FUNCTION SELECTED (FUCN02 AND FUNC03 GO TO  *47460099
474700* RC LISTS WHICH USE A DIFFERENT COPYBOOK                        *47470099
474800*                                                                *47480099
474900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *47490099
475000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *47500099
475100* THE ARRAY IS FULL.                                             *47510099
475200*----------------------------------------------------------------*47520099
475300 5000-PREPARE-SEL-QUEUE.                                          47530099
475400                                                                  47540099
475500     MOVE +1                   TO  ASC-BLK-SUB.                   47550099
475600     PERFORM 5100-WRITE-TEMP-STORAGE.                             47560099
475700     ADD +1                    TO  ASC-BLK-SUB.                   47570099
475800     PERFORM 5100-WRITE-TEMP-STORAGE.                             47580099
475900                                                                  47590099
476000     EVALUATE TRUE                                                47600099
476100       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR             47610099
476200            DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) OR             47620099
476300            DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                47630099
476400               MOVE ASC-SEL-QUEUE-NAME TO RC015-SEL-QUEUE-NAME    47640099
476500                                                                  47650099
476600       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                47660099
476700               MOVE ASC-SEL-QUEUE-NAME TO PC236-SEL-QUEUE-NAME    47670099
476800                                                                  47680099
476900       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                47690099
477000               MOVE ASC-SEL-QUEUE-NAME TO RC815-SEL-QUEUE-NAME    47700099
477100                                                                  47710099
477200       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR             47720099
477300            DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                47730099
477400               MOVE ASC-SEL-QUEUE-NAME TO SU003-SEL-QUEUE-NAME    47740099
477500                                                                  47750099
477600       WHEN OTHER                                                 47760099
477700               MOVE ASC-SEL-QUEUE-NAME TO SU003-SEL-QUEUE-NAME    47770099
477800     END-EVALUATE.                                                47780099
477900                                                                  47790099
478000     PERFORM 6010-DELETE-SEL-QUEUE.                               47800099
478100                                                                  47810099
478200     SET ASC-UPDATE-TSQ        TO  TRUE.                          47820099
478300                                                                  47830099
478400     EVALUATE TRUE                                                47840099
478500       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR             47850099
478600            DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) OR             47860099
478700            DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                47870099
478800               SET RC013-IDX         TO  1                        47880099
478900               MOVE ZERO             TO RC015-NUMBER-OF-TS-ITEMS  47890099
479000               INITIALIZE RC013-SELECTED-ITEM-ARRAY               47900099
479100                                                                  47910099
479200       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                47920099
479300               SET PC237-IDX         TO  1                        47930099
479400               MOVE ZERO             TO PC236-NUMBER-OF-TS-ITEMS  47940099
479500               INITIALIZE PC237-SELECTED-ITEM-ARRAY               47950099
479600                                                                  47960099
479700       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                47970099
479800               SET RC816-IDX         TO  1                        47980099
479900               MOVE ZERO             TO RC815-NUMBER-OF-TS-ITEMS  47990099
480000               INITIALIZE RC816-SELECTED-ITEM-ARRAY               48000099
480100                                                                  48010099
480200       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR             48020099
480300            DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                48030099
480400               SET SU004-IDX           TO 1                       48040099
480500               MOVE ZERO               TO SU003-NUMBER-OF-TS-ITEMS48050099
480600               INITIALIZE SU004-SELECTED-ITEM-ARRAY               48060099
480700                                                                  48070099
480800       WHEN OTHER                                                 48080099
480900               SET SU004-IDX         TO  1                        48090099
481000               MOVE ZERO             TO SU003-NUMBER-OF-TS-ITEMS  48100099
481100               INITIALIZE SU004-SELECTED-ITEM-ARRAY               48110099
481200     END-EVALUATE.                                                48120099
481300                                                                  48130099
481400     EVALUATE TRUE                                                48140099
481500       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR             48150099
481600            DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) OR             48160099
481700            DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                48170099
481800               SET PS-NO-VERIFIED-RECEIVER TO TRUE                48180099
481900               PERFORM 5300-FILL-SEL-QUEUE-RECORD                 48190099
482000                 VARYING PV-ITEM FROM 1 BY 1                      48200099
482100                   UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      48210099
482200                                                                  48220099
482300       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                48230099
482400               SET PS-NO-VERIFIED-RECEIVER TO TRUE                48240099
482500               PERFORM 5400-FILL-SEL-QUEUE-RECORD                 48250099
482600                 VARYING PV-ITEM FROM 1 BY 1                      48260099
482700                   UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      48270099
482800                                                                  48280099
482900       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                48290099
483000               SET PS-NO-VERIFIED-RECEIVER TO TRUE                48300099
483100               PERFORM 5500-FILL-SEL-QUEUE-RECORD                 48310099
483200                 VARYING PV-ITEM FROM 1 BY 1                      48320099
483300                   UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      48330099
483400                                                                  48340099
483500       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR             48350099
483600            DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                48360099
483700               SET PS-NO-VERIFIED-RECEIVER TO TRUE                48370099
483800               PERFORM 5600-FILL-SEL-QUEUE-RECORD                 48380099
483900                 VARYING PV-ITEM FROM 1 BY 1                      48390099
484000                   UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      48400099
484100                                                                  48410099
484200       WHEN OTHER                                                 48420099
484300            PERFORM 5200-FILL-SEL-QUEUE-RECORD                    48430099
484400              VARYING PV-ITEM FROM 1 BY 1                         48440099
484500                UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN         48450099
484600     END-EVALUATE.                                                48460099
484700                                                                  48470099
484800     EVALUATE TRUE                                                48480099
484900       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR             48490099
485000            DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) OR             48500099
485100            DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                48510099
485200               IF RC013-IDX > 1                                   48520099
485300                  PERFORM 5305-WRITE-SEL-QUEUE                    48530099
485400                  ADD +1 TO RC015-NUMBER-OF-TS-ITEMS              48540099
485500               END-IF                                             48550099
485600                                                                  48560099
485700       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                48570099
485800               IF PC237-IDX > 1                                   48580099
485900                  PERFORM 5405-WRITE-SEL-QUEUE                    48590099
486000                  ADD +1 TO PC236-NUMBER-OF-TS-ITEMS              48600099
486100               END-IF                                             48610099
486200                                                                  48620099
486300       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                48630099
486400               IF RC816-IDX > 1                                   48640099
486500                  PERFORM 5505-WRITE-SEL-QUEUE                    48650099
486600                  ADD +1 TO RC815-NUMBER-OF-TS-ITEMS              48660099
486700               END-IF                                             48670099
486800                                                                  48680099
486900       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR             48690099
487000            DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                48700099
487100               IF SU004-IDX > 1                                   48710099
487200                  PERFORM 5605-WRITE-SEL-QUEUE                    48720099
487300                  ADD +1 TO SU003-NUMBER-OF-TS-ITEMS              48730099
487400               END-IF                                             48740099
487500                                                                  48750099
487600       WHEN OTHER                                                 48760099
487700               IF SU004-IDX > 1                                   48770099
487800                  PERFORM 5205-WRITE-SEL-QUEUE                    48780099
487900                  ADD +1 TO SU003-NUMBER-OF-TS-ITEMS              48790099
488000               END-IF                                             48800099
488100     END-EVALUATE.                                                48810099
488200                                                                  48820099
488300*----------------------------------------------------------------*48830099
488400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *48840099
488500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *48850099
488600*----------------------------------------------------------------*48860099
488700 5100-WRITE-TEMP-STORAGE.                                         48870099
488800     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     48880099
488900                                   TO PV-LIST-ITEM-NUMBER.        48890099
489000     COMPUTE PV-BLOCK-NUMBER =                                    48900099
489100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    48910099
489200                                                                  48920099
489300     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             48930099
489400     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             48940099
489500         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      48950099
489600             PERFORM 5105-REWRITE-ASC-LISTQ                       48960099
489700         END-IF                                                   48970099
489800     ELSE                                                         48980099
489900         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       48990099
490000         ASC-HIGHEST-BLOCK-WRITTEN + 1                            49000099
490100         PERFORM 5110-WRITE-ASC-LISTQ                             49010099
490200         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   49020099
490300     END-IF.                                                      49030099
490400                                                                  49040099
490500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             49050099
490600******************************************************************49060099
490700** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **49070099
490800** SPECIFIC COMMAREA.                                           **49080099
490900******************************************************************49090099
491000 5105-REWRITE-ASC-LISTQ.                                          49100099
491100     EXEC CICS                                                    49110099
491200         WRITEQ TS                                                49120099
491300             QUEUE (ASC-LIST-QUEUE-NAME)                          49130099
491400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               49140099
491500             ITEM  (PV-BLOCK-NUMBER)                              49150099
491600             REWRITE                                              49160099
491700             RESP  (PV-CICS-RESP)                                 49170099
491800     END-EXEC.                                                    49180099
491900                                                                  49190099
492000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           49200099
492100         CONTINUE                                                 49210099
492200     ELSE                                                         49220099
492300         SET DP013-CICS-ABEND            TO TRUE                  49230099
492400         SET DP013-NO-ROLLBACK           TO TRUE                  49240099
492500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       49250099
492600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     49260099
492700                                         TO DP013-MESSAGE-TEXT(1) 49270099
492800         PERFORM DP013-0000-PROCESS-ABEND                         49280099
492900     END-IF.                                                      49290099
493000                                                                  49300099
493100******************************************************************49310099
493200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **49320099
493300** SPECIFIC COMMAREA.                                           **49330099
493400******************************************************************49340099
493500 5110-WRITE-ASC-LISTQ.                                            49350099
493600     EXEC CICS                                                    49360099
493700         WRITEQ TS                                                49370099
493800             QUEUE (ASC-LIST-QUEUE-NAME)                          49380099
493900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               49390099
494000             ITEM  (PV-BLOCK-NUMBER)                              49400099
494100             RESP  (PV-CICS-RESP)                                 49410099
494200     END-EXEC.                                                    49420099
494300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      49430099
494400         SET DP013-CICS-ABEND      TO TRUE                        49440099
494500         SET DP013-NO-ROLLBACK     TO TRUE                        49450099
494600         MOVE '5110-WRITE-ASC-LISTQ'                              49460099
494700                                   TO DP013-PARAGRAPH             49470099
494800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           49480099
494900                                   TO DP013-MESSAGE-TEXT(1)       49490099
495000         PERFORM DP013-0000-PROCESS-ABEND                         49500099
495100     END-IF.                                                      49510099
495200                                                                  49520099
495300*----------------------------------------------------------------*49530099
495400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *49540099
495500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *49550099
495600*----------------------------------------------------------------*49560099
495700 5200-FILL-SEL-QUEUE-RECORD.                                      49570099
495800                                                                  49580099
495900     PERFORM 6112-READ-LIST-QUEUE.                                49590099
496000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       49600099
496100         PERFORM                                                  49610099
496200         VARYING LQW-IDX                                          49620099
496300         FROM 1 BY 1                                              49630099
496400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            49640099
496500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          49650099
496600             IF  LQW-SELECT (LQW-IDX)                             49660099
496700               MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)                49670099
496800                                 TO SU004-ITEM (SU004-IDX)        49680099
496900               MOVE SPACE        TO SU004-ACTION-SW (SU004-IDX)   49690099
497000               MOVE LQW-PO-NBR (LQW-IDX)                          49700099
497100                                 TO SU004-PO-NBR (SU004-IDX)      49710099
497200               MOVE LQW-RECEIVER (LQW-IDX)                        49720099
497300                                 TO SU004-REC-SEQ-NBR (SU004-IDX) 49730099
497400                 SET SU004-IDX UP BY 1                            49740099
497500                 IF  SU004-IDX > SU004-MAX-ITEMS                  49750099
497600                     PERFORM 5205-WRITE-SEL-QUEUE                 49760099
497700                     ADD +1        TO SU003-NUMBER-OF-TS-ITEMS    49770099
497800                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         49780099
497900                     SET SU004-IDX TO  1                          49790099
498000                 END-IF                                           49800099
498100             END-IF                                               49810099
498200         END-PERFORM                                              49820099
498300     END-IF.                                                      49830099
498400                                                                  49840099
498500*----------------------------------------------------------------*49850099
498600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *49860099
498700*----------------------------------------------------------------*49870099
498800 5205-WRITE-SEL-QUEUE.                                            49880099
498900                                                                  49890099
499000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            49900099
499100                                   TO SU004-SELECTED-ITEMS.       49910099
499200                                                                  49920099
499300     EXEC CICS                                                    49930099
499400          WRITEQ TS                                               49940099
499500              QUEUE (ASC-SEL-QUEUE-NAME)                          49950099
499600              FROM  (SU004-DC-SELECT-RECORD)                      49960099
499700              ITEM  (PV-SEL-QUEUE-ITEM)                           49970099
499800              RESP  (PV-CICS-RESP)                                49980099
499900     END-EXEC.                                                    49990099
500000                                                                  50000099
500100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          50010099
500200         CONTINUE                                                 50020099
500300     ELSE                                                         50030099
500400         SET DP013-CICS-ABEND      TO TRUE                        50040099
500500         SET DP013-NO-ROLLBACK     TO TRUE                        50050099
500600         MOVE '5205-WRITE-SEL-QUEUE'                              50060099
500700                                   TO DP013-PARAGRAPH             50070099
500800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          50080099
500900                                   TO DP013-MESSAGE-TEXT(1)       50090099
501000         PERFORM DP013-0000-PROCESS-ABEND                         50100099
501100     END-IF.                                                      50110099
501200*----------------------------------------------------------------*50120099
501300 5300-FILL-SEL-QUEUE-RECORD.                                      50130099
501400                                                                  50140099
501500     PERFORM 6112-READ-LIST-QUEUE.                                50150099
501600                                                                  50160099
501700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        50170099
501800         PERFORM                                                  50180099
501900           VARYING LQW-IDX FROM 1 BY 1                            50190099
502000             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   50200099
502100                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          50210099
502200                                                                  50220099
502300             IF LQW-SELECT (LQW-IDX)                              50230099
502400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              50240099
502500                            TO RC013-ITEM (RC013-IDX)             50250099
502600                 MOVE SPACE TO RC013-ACTION-SW (RC013-IDX)        50260099
502700                 MOVE LQW-PO-NBR (LQW-IDX)                        50270099
502800                            TO RC013-PO-NBR   (RC013-IDX)         50280099
502900                               RC015-PO-NBR                       50290099
503000                               DK-PO-NBR                          50300099
503100                 MOVE LQW-RECEIVER (LQW-IDX)                      50310099
503200                            TO RC013-REC-SEQ-NBR (RC013-IDX)      50320099
503300                               RC015-REC-SEQ-NBR                  50330099
503400                               DK-REC-SEQ-NBR                     50340099
503500                                                                  50350099
503600                 PERFORM 4370-CHECK-OPER-AND-FACILTY              50360099
503700                                                                  50370099
503800                 IF RECEIV-STATUS-CDE = 'VE'                      50380099
503900                     SET PS-VERIFIED-RECEIVER TO TRUE             50390099
504000                     MOVE PC-ERR TO LQW-ACTION (LQW-IDX)          50400099
504100                 END-IF                                           50410099
504200                 MOVE ASC-KEY-OPER-UNT-ID                         50420099
504300                            TO RC013-OPER-UNT-ID (RC013-IDX)      50430099
504400                 MOVE ASC-KEY-FCLTY-ID                            50440099
504500                            TO RC013-FCLTY-ID (RC013-IDX)         50450099
504600                                                                  50460099
504700                 IF LQW-RECEIVER(LQW-IDX) = ZERO                  50470099
504800                    SET PS-RECEIVER-DOESNT-EXIST TO TRUE          50480099
504900                 END-IF                                           50490099
505000                                                                  50500099
505100                 SET RC013-IDX UP BY 1                            50510099
505200                 IF RC013-IDX > RC013-MAX-ITEMS                   50520099
505300                     PERFORM 5305-WRITE-SEL-QUEUE                 50530099
505400                     ADD +1  TO RC015-NUMBER-OF-TS-ITEMS          50540099
505500                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         50550099
505600                     SET RC013-IDX TO 1                           50560099
505700                 END-IF                                           50570099
505800             END-IF                                               50580099
505900         END-PERFORM                                              50590099
506000     END-IF.                                                      50600099
506100     IF PS-VERIFIED-RECEIVER                                      50610099
506200         PERFORM 6113-WRITE-LIST-QUEUE                            50620099
506300     END-IF.                                                      50630099
506400                                                                  50640099
506500*----------------------------------------------------------------*50650099
506600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *50660099
506700*----------------------------------------------------------------*50670099
506800 5305-WRITE-SEL-QUEUE.                                            50680099
506900                                                                  50690099
507000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC013-SELECTED-ITEMS.   50700099
507100                                                                  50710099
507200     EXEC CICS                                                    50720099
507300          WRITEQ TS                                               50730099
507400              QUEUE (ASC-SEL-QUEUE-NAME)                          50740099
507500              FROM  (RC013-DC-SELECT-RECORD)                      50750099
507600              ITEM  (PV-SEL-QUEUE-ITEM)                           50760099
507700              RESP  (PV-CICS-RESP)                                50770099
507800     END-EXEC.                                                    50780099
507900     IF PV-CICS-RESP = DFHRESP (NORMAL)                           50790099
508000         CONTINUE                                                 50800099
508100     ELSE                                                         50810099
508200         SET DP013-CICS-ABEND        TO TRUE                      50820099
508300         SET DP013-NO-ROLLBACK       TO TRUE                      50830099
508400         MOVE '5305-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           50840099
508500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          50850099
508600                                     TO DP013-MESSAGE-TEXT(1)     50860099
508700         PERFORM DP013-0000-PROCESS-ABEND                         50870099
508800     END-IF.                                                      50880099
508900                                                                  50890099
509000*----------------------------------------------------------------*50900099
509100 5400-FILL-SEL-QUEUE-RECORD.                                      50910099
509200                                                                  50920099
509300     PERFORM 6112-READ-LIST-QUEUE.                                50930099
509400                                                                  50940099
509500     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        50950099
509600         PERFORM                                                  50960099
509700           VARYING LQW-IDX FROM 1 BY 1                            50970099
509800             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   50980099
509900                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          50990099
510000                                                                  51000099
510100             IF LQW-SELECT (LQW-IDX)                              51010099
510200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              51020099
510300                            TO PC237-ITEM (PC237-IDX)             51030099
510400                 MOVE SPACE TO PC237-ACTION-SW (PC237-IDX)        51040099
510500                 MOVE LQW-PO-NBR (LQW-IDX)                        51050099
510600                            TO PC237-PO-NBR   (PC237-IDX)         51060099
510700                               DK-PO-NBR                          51070099
510800                 MOVE LQW-RECEIVER (LQW-IDX)                      51080099
510900                            TO PC237-REC-SEQ-NBR (PC237-IDX)      51090099
511000                               DK-REC-SEQ-NBR                     51100099
511100                                                                  51110099
511200                 PERFORM 4370-CHECK-OPER-AND-FACILTY              51120099
511300                                                                  51130099
511400                 IF RECEIV-STATUS-CDE = 'VE'                      51140099
511500                     SET PS-VERIFIED-RECEIVER TO TRUE             51150099
511600                     MOVE PC-ERR TO LQW-ACTION (LQW-IDX)          51160099
511700                 END-IF                                           51170099
511800                 MOVE ASC-KEY-OPER-UNT-ID                         51180099
511900                            TO PC237-OPER-UNT-ID (PC237-IDX)      51190099
512000                 MOVE ASC-KEY-FCLTY-ID                            51200099
512100                            TO PC237-FCLTY-ID (PC237-IDX)         51210099
512200                                                                  51220099
512300                 IF LQW-RECEIVER(LQW-IDX) = ZERO                  51230099
512400                    SET PS-RECEIVER-DOESNT-EXIST TO TRUE          51240099
512500                 END-IF                                           51250099
512600                                                                  51260099
512700                 SET PC237-IDX UP BY 1                            51270099
512800                 IF PC237-IDX > PC237-MAX-ITEMS                   51280099
512900                     PERFORM 5405-WRITE-SEL-QUEUE                 51290099
513000                     ADD +1  TO PC236-NUMBER-OF-TS-ITEMS          51300099
513100                     INITIALIZE PC237-SELECTED-ITEM-ARRAY         51310099
513200                     SET PC237-IDX TO 1                           51320099
513300                 END-IF                                           51330099
513400             END-IF                                               51340099
513500         END-PERFORM                                              51350099
513600     END-IF.                                                      51360099
513700     IF PS-VERIFIED-RECEIVER                                      51370099
513800         PERFORM 6113-WRITE-LIST-QUEUE                            51380099
513900     END-IF.                                                      51390099
514000                                                                  51400099
514100*----------------------------------------------------------------*51410099
514200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *51420099
514300*----------------------------------------------------------------*51430099
514400 5405-WRITE-SEL-QUEUE.                                            51440099
514500                                                                  51450099
514600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO PC237-SELECTED-ITEMS.   51460099
514700                                                                  51470099
514800     EXEC CICS                                                    51480099
514900          WRITEQ TS                                               51490099
515000              QUEUE (ASC-SEL-QUEUE-NAME)                          51500099
515100              FROM  (PC237-DC-SELECT-RECORD)                      51510099
515200              ITEM  (PV-SEL-QUEUE-ITEM)                           51520099
515300              RESP  (PV-CICS-RESP)                                51530099
515400     END-EXEC.                                                    51540099
515500     IF PV-CICS-RESP = DFHRESP (NORMAL)                           51550099
515600         CONTINUE                                                 51560099
515700     ELSE                                                         51570099
515800         SET DP013-CICS-ABEND        TO TRUE                      51580099
515900         SET DP013-NO-ROLLBACK       TO TRUE                      51590099
516000         MOVE '5405-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           51600099
516100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          51610099
516200                                     TO DP013-MESSAGE-TEXT(1)     51620099
516300         PERFORM DP013-0000-PROCESS-ABEND                         51630099
516400     END-IF.                                                      51640099
516500                                                                  51650099
516600*----------------------------------------------------------------*51660099
516700*FILL SELECT QUEUE FOR RECEIVER UPDATE                            51670099
516800 5500-FILL-SEL-QUEUE-RECORD.                                      51680099
516900                                                                  51690099
517000     PERFORM 6112-READ-LIST-QUEUE.                                51700099
517100                                                                  51710099
517200     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        51720099
517300         PERFORM                                                  51730099
517400           VARYING LQW-IDX FROM 1 BY 1                            51740099
517500             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   51750099
517600                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          51760099
517700                                                                  51770099
517800             IF LQW-SELECT (LQW-IDX)                              51780099
517900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              51790099
518000                                         TO RC816-ITEM (RC816-IDX)51800099
518100                 MOVE SPACE TO RC816-ACTION-SW (RC816-IDX)        51810099
518200                 MOVE LQW-PO-NBR (LQW-IDX)                        51820099
518300                                       TO RC816-PO-NBR (RC816-IDX)51830099
518400                                          DK-PO-NBR               51840099
518500                 MOVE LQW-RECEIVER (LQW-IDX)                      51850099
518600                                     TO RC816-RCVR-NBR (RC816-IDX)51860099
518700                                        DK-REC-SEQ-NBR            51870099
518800                 MOVE LQW-VND-NME (LQW-IDX)                       51880099
518900                                       TO RC816-VENDOR (RC816-IDX)51890099
519000                 IF LQW-CSR-IND (LQW-IDX) = 'A'                   51900099
519100                      SET PS-NO-FREE-ASTRAY  TO TRUE              51910099
519200                 ELSE                                             51920099
519300                     SET PS-FREE-ASTRAY     TO TRUE               51930099
519400                 END-IF                                           51940099
519500                 MOVE LQW-PACK-TYPE (LQW-IDX)                     51950099
519600                                     TO RC816-PKG-CODE (RC816-IDX)51960099
519700                 MOVE LQW-ACTL-CART-COUNT     (LQW-IDX)           51970099
519800                              TO RC816-ACTL-CART-COUNT (RC816-IDX)51980099
519900                                                                  51990099
520000                 PERFORM 4370-CHECK-OPER-AND-FACILTY              52000099
520100                                                                  52010099
520200                 IF RECEIV-STATUS-CDE = 'VE'                      52020099
520300                     SET PS-VERIFIED-RECEIVER TO TRUE             52030099
520400*                    MOVE PC-ERR TO LQW-ACTION (LQW-IDX)          52040099
520500                 END-IF                                           52050099
520600                                                                  52060099
520700                 IF LQW-RECEIVER(LQW-IDX) = ZERO                  52070099
520800                     SET PS-RECEIVER-DOESNT-EXIST TO TRUE         52080099
520900                 END-IF                                           52090099
521000                                                                  52100099
521100                 SET RC816-IDX UP BY 1                            52110099
521200                 IF RC816-IDX > RC816-MAX-ITEMS                   52120099
521300                     PERFORM 5505-WRITE-SEL-QUEUE                 52130099
521400                     ADD +1  TO RC815-NUMBER-OF-TS-ITEMS          52140099
521500                     INITIALIZE RC816-SELECTED-ITEM-ARRAY         52150099
521600                     SET RC816-IDX TO 1                           52160099
521700                 END-IF                                           52170099
521800             END-IF                                               52180099
521900         END-PERFORM                                              52190099
522000     END-IF.                                                      52200099
522100     IF PS-VERIFIED-RECEIVER                                      52210099
522200         PERFORM 6113-WRITE-LIST-QUEUE                            52220099
522300     END-IF.                                                      52230099
522400                                                                  52240099
522500*----------------------------------------------------------------*52250099
522600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *52260099
522700*----------------------------------------------------------------*52270099
522800 5505-WRITE-SEL-QUEUE.                                            52280099
522900                                                                  52290099
523000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC816-SELECTED-ITEMS.   52300099
523100                                                                  52310099
523200     EXEC CICS                                                    52320099
523300          WRITEQ TS                                               52330099
523400              QUEUE (ASC-SEL-QUEUE-NAME)                          52340099
523500              FROM  (RC816-SELECT-RECORD)                         52350099
523600              ITEM  (PV-SEL-QUEUE-ITEM)                           52360099
523700              RESP  (PV-CICS-RESP)                                52370099
523800     END-EXEC.                                                    52380099
523900     IF PV-CICS-RESP = DFHRESP (NORMAL)                           52390099
524000         CONTINUE                                                 52400099
524100     ELSE                                                         52410099
524200         SET DP013-CICS-ABEND        TO TRUE                      52420099
524300         SET DP013-NO-ROLLBACK       TO TRUE                      52430099
524400         MOVE '5505-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           52440099
524500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          52450099
524600                                     TO DP013-MESSAGE-TEXT(1)     52460099
524700         PERFORM DP013-0000-PROCESS-ABEND                         52470099
524800     END-IF.                                                      52480099
524900                                                                  52490099
525000*----------------------------------------------------------------*52500099
525100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *52510099
525200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *52520099
525300* CARTON ASSIGN LIST - QUEUE                                     *52530099
525400*----------------------------------------------------------------*52540099
525500 5600-FILL-SEL-QUEUE-RECORD.                                      52550099
525600                                                                  52560099
525700     PERFORM 6112-READ-LIST-QUEUE.                                52570099
525800                                                                  52580099
525900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       52590099
526000         PERFORM                                                  52600099
526100         VARYING LQW-IDX                                          52610099
526200         FROM 1 BY 1                                              52620099
526300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            52630099
526400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          52640099
526500                                                                  52650099
526600             IF  LQW-SELECT (LQW-IDX)                             52660099
526700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              52670099
526800                                  TO SU004-ITEM        (SU004-IDX)52680099
526900                 MOVE ASC-OPER-UNT-ID                             52690099
527000                                  TO SU004-OPER-UNT-ID (SU004-IDX)52700099
527100                 MOVE ASC-FCLTY-ID                                52710099
527200                                  TO SU004-FCLTY-ID    (SU004-IDX)52720099
527300                 MOVE LQW-PO-NBR (LQW-IDX)                        52730099
527400                                  TO SU004-PO-NBR      (SU004-IDX)52740099
527500                 MOVE LQW-RECEIVER (LQW-IDX)                      52750099
527600                                  TO SU004-REC-SEQ-NBR (SU004-IDX)52760099
527700                 MOVE SPACES      TO SU004-ACTION-SW   (SU004-IDX)52770099
527800                 MOVE LQW-SCAC (LQW-IDX)                          52780099
527900                                  TO SU004-SCAC-CDE    (SU004-IDX)52790099
528000                 MOVE LQW-TRLR-NBR (LQW-IDX)                      52800099
528100                                  TO SU004-VEH-NBR     (SU004-IDX)52810099
528200                 MOVE SPACES      TO SU004-CSR-IND     (SU004-IDX)52820099
528300                 MOVE LQW-TRIP-ID (LQW-IDX)                       52830099
528400                                      TO SU004-TRIP-ID (SU004-IDX)52840099
528500                 MOVE ZEROES      TO SU004-SHIPT-UNT-ID(SU004-IDX)52850099
528600                                                                  52860099
528700                 SET SU004-IDX UP BY 1                            52870099
528800                 IF  SU004-IDX > SU004-MAX-ITEMS                  52880099
528900                     PERFORM 5605-WRITE-SEL-QUEUE                 52890099
529000                     ADD  +1  TO  SU003-NUMBER-OF-TS-ITEMS        52900099
529100                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         52910099
529200                     SET SU004-IDX TO  1                          52920099
529300                 END-IF                                           52930099
529400             END-IF                                               52940099
529500         END-PERFORM                                              52950099
529600     END-IF.                                                      52960099
529700                                                                  52970099
529800*----------------------------------------------------------------*52980099
529900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *52990099
530000*                                                                *53000099
530100* THIS QUEUE IS USED FOR CARTON ASSIGN LIST                      *53010099
530200*----------------------------------------------------------------*53020099
530300 5605-WRITE-SEL-QUEUE.                                            53030099
530400                                                                  53040099
530500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            53050099
530600                                   TO SU004-SELECTED-ITEMS.       53060099
530700                                                                  53070099
530800     EXEC CICS                                                    53080099
530900          WRITEQ TS                                               53090099
531000              QUEUE (ASC-SEL-QUEUE-NAME)                          53100099
531100              FROM  (SU004-DC-SELECT-RECORD)                      53110099
531200              ITEM  (PV-SEL-QUEUE-ITEM)                           53120099
531300              RESP  (PV-CICS-RESP)                                53130099
531400     END-EXEC.                                                    53140099
531500                                                                  53150099
531600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          53160099
531700         CONTINUE                                                 53170099
531800     ELSE                                                         53180099
531900         SET DP013-CICS-ABEND      TO TRUE                        53190099
532000         SET DP013-NO-ROLLBACK     TO TRUE                        53200099
532100         MOVE '5605-WRITE-SEL-QUEUE'                              53210099
532200                                   TO DP013-PARAGRAPH             53220099
532300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          53230099
532400                                   TO DP013-MESSAGE-TEXT(1)       53240099
532500         PERFORM DP013-0000-PROCESS-ABEND                         53250099
532600     END-IF.                                                      53260099
532700                                                                  53270099
532800*----------------------------------------------------------------*53280099
532900*  RETRIEVE THE PRIMARY VENDOR NAME                               53290099
533000*----------------------------------------------------------------*53300099
533100 5910-GET-ENT-NAME-DESC.                                          53310099
533200                                                                  53320099
533300         EXEC SQL                                                 53330099
533400              SELECT B.ENT_NAME_DESC                              53340099
533500                INTO :ENTNME-ENT-NAME-DESC                        53350099
533600                FROM TPURCHS A                                    53360099
533700                    ,TENTNME B                                    53370099
533800               WHERE A.PO_NBR         = :DK-PO-NBR                53380099
533900                 AND A.VER_STATUS_CDE = 'A'                       53390099
534000                 AND B.TYPE_CDE       = '01'                      53400099
534100                 AND A.ENT_ID         = B.ENT_ID                  53410099
534200         WITH UR                                                  53420099
534300         END-EXEC                                                 53430099
534400                                                                  53440099
534500         EVALUATE TRUE                                            53450099
534600             WHEN SQLCODE = +0                                    53460099
534700               CONTINUE                                           53470099
534800             WHEN SQLCODE = +100                                  53480099
534900               MOVE PC-UNKNWN-VND-NME TO ENTNME-ENT-NAME-DESC     53490099
535000             WHEN OTHER                                           53500099
535100               MOVE DK-PO-NBR              TO PV-DISP-PO          53510099
535200               MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR        53520099
535300               STRING  ' SUKCS761- 5910-  '      DELIMITED BY SIZE53530099
535400                       ' PO- '                   DELIMITED BY SIZE53540099
535500                       PV-DISP-PO                DELIMITED BY SIZE53550099
535600                                      INTO PV-CICS-MSG-AREA       53560099
535700               PERFORM 9900-WRITE-CICS-LOG                        53570099
535800                                                                  53580099
535900               MOVE '5910-GET-ENT-NAME-DESC'                      53590099
536000                               TO DP013-PARAGRAPH                 53600099
536100               MOVE 'UNSUCCESSFUL SELECT ENTERPRISE NAME'         53610099
536200                               TO DP013-MESSAGE-TEXT (1)          53620099
536300               MOVE SQLCA      TO DP013-SQLCA                     53630099
536400               MOVE DK-PO-NBR  TO PV-ERROR-PO                     53640099
536500               MOVE DK-REC-SEQ-NBR                                53650099
536600                               TO PV-ERROR-SEQ                    53660099
536700               MOVE PV-ERROR-MSG                                  53670099
536800                               TO DP013-MESSAGE-TEXT (2)          53680099
536900               MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (1)        53690099
537000               SET DP013-DB2-ABEND                                53700099
537100                   DP013-XCTL-DISPLAY-RESTART                     53710099
537200                               TO TRUE                            53720099
537300               PERFORM DP013-0000-PROCESS-ABEND                   53730099
537400         END-EVALUATE.                                            53740099
537500                                                                  53750099
537600******************************************************************53760099
537700 6000-REFRESH-PANEL-FROM-TEMP.                                    53770099
537800     IF  ASC-UPDATE-TSQ AND                                       53780099
537900         ((ASC-FUNC01-RETURN-YES OR                               53790099
538000           ASC-FUNC02-RETURN-YES OR                               53800099
538100           ASC-FUNC03-RETURN-YES OR                               53810099
538200           ASC-FUNC04-RETURN-YES OR                               53820099
538300           ASC-FUNC05-RETURN-YES OR                               53830099
538400           ASC-FUNC06-RETURN-YES OR                               53840099
538500           ASC-FUNC07-RETURN-YES OR                               53850099
538600           ASC-FUNC08-RETURN-YES) OR                              53860099
538700          SU003-UPDATE-TSQ)                                       53870099
538800         SET ASC-NO-TSQ-UPDATE TO TRUE                            53880099
538900         MOVE ZERO                 TO PV-SAVE-ITEM                53890099
539000                                      PV-SEL-QUEUE-ITEM           53900099
539100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        53910099
539200                                   TO PV-HOLD-SELECTED-ITEMS      53920099
539300         MOVE +1                   TO PV-ITEMS-PROCESSED          53930099
539400                                                                  53940099
539500                                                                  53950099
539600         EVALUATE TRUE                                            53960099
539700            WHEN ASC-FUNC01-RETURN-YES OR                         53970099
539800                 ASC-FUNC02-RETURN-YES OR                         53980099
539900                 ASC-FUNC05-RETURN-YES                            53990099
540000               PERFORM 6200-UPDATE-TSQ                            54000099
540100                 UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS54010099
540200                                                                  54020099
540300            WHEN ASC-FUNC04-RETURN-YES                            54030099
540400               PERFORM 6300-UPDATE-TSQ                            54040099
540500                 UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS54050099
540600                                                                  54060099
540700            WHEN ASC-FUNC06-RETURN-YES                            54070099
540800               PERFORM 6400-UPDATE-TSQ                            54080099
540900                 UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS54090099
541000                                                                  54100099
541100            WHEN ASC-FUNC07-RETURN-YES                            54110099
541200               PERFORM 6500-UPDATE-TSQ                            54120099
541300                 UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS54130099
541400                                                                  54140099
541500            WHEN OTHER                                            54150099
541600               PERFORM 6100-UPDATE-TSQ                            54160099
541700                 UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS54170099
541800         END-EVALUATE                                             54180099
541900                                                                  54190099
542000         SET ASC-FUNC02-RETURN-NO TO TRUE                         54200099
542100         SET ASC-FUNC03-RETURN-NO TO TRUE                         54210099
542200         SET ASC-FUNC05-RETURN-NO TO TRUE                         54220099
542300         SET ASC-FUNC06-RETURN-NO TO TRUE                         54230099
542400                                                                  54240099
542500                                                                  54250099
542600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         54260099
542700                    ASC-BLOCK-ENTRIES (2)                         54270099
542800     END-IF.                                                      54280099
542900                                                                  54290099
543000*----------------------------------------------------------------*54300099
543100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *54310099
543200*----------------------------------------------------------------*54320099
543300 6010-DELETE-SEL-QUEUE.                                           54330099
543400                                                                  54340099
543500     EXEC CICS                                                    54350099
543600         DELETEQ TS                                               54360099
543700             QUEUE (ASC-SEL-QUEUE-NAME)                           54370099
543800             RESP  (PV-CICS-RESP)                                 54380099
543900     END-EXEC.                                                    54390099
544000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      54400099
544100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         54410099
544200         CONTINUE                                                 54420099
544300     ELSE                                                         54430099
544400         SET DP013-CICS-ABEND TO TRUE                             54440099
544500         SET DP013-NO-ROLLBACK TO TRUE                            54450099
544600         MOVE '6010-DELETE-SEL-QUEUE'                             54460099
544700                        TO DP013-PARAGRAPH                        54470099
544800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         54480099
544900                        TO DP013-MESSAGE-TEXT (1)                 54490099
545000         PERFORM DP013-0000-PROCESS-ABEND                         54500099
545100     END-IF.                                                      54510099
545200                                                                  54520099
545300*----------------------------------------------------------------*54530099
545400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *54540099
545500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *54550099
545600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *54560099
545700*    THE TEMP QUEUE.                                             *54570099
545800*----------------------------------------------------------------*54580099
545900 6100-UPDATE-TSQ.                                                 54590099
546000                                                                  54600099
546100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             54610099
546200     PERFORM 6105-READ-SEL-QUEUE.                                 54620099
546300     PERFORM                                                      54630099
546400         VARYING SU004-IDX                                        54640099
546500         FROM 1 BY 1                                              54650099
546600         UNTIL ((PV-ITEMS-PROCESSED >                             54660099
546700                              PV-HOLD-SELECTED-ITEMS)             54670099
546800         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             54680099
546900         IF  SU004-ACTION-SW (SU004-IDX) > SPACE                  54690099
547000             PERFORM 6110-PROCESS-ITEMS                           54700099
547100         END-IF                                                   54710099
547200         ADD +1                TO PV-ITEMS-PROCESSED              54720099
547300     END-PERFORM.                                                 54730099
547400     PERFORM 6111-WRITE-LIST-QUEUE.                               54740099
547500                                                                  54750099
547600*----------------------------------------------------------------*54760099
547700*    READ THE LIST QUEUE RECORD.                                 *54770099
547800*----------------------------------------------------------------*54780099
547900 6105-READ-SEL-QUEUE.                                             54790099
548000                                                                  54800099
548100     EXEC CICS                                                    54810099
548200          READQ TS                                                54820099
548300              QUEUE (ASC-SEL-QUEUE-NAME)                          54830099
548400              INTO  (SU004-DC-SELECT-RECORD)                      54840099
548500              ITEM  (PV-SEL-QUEUE-ITEM)                           54850099
548600              RESP  (PV-CICS-RESP)                                54860099
548700     END-EXEC.                                                    54870099
548800*                                                                 54880099
548900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          54890099
549000         CONTINUE                                                 54900099
549100     ELSE                                                         54910099
549200         SET DP013-CICS-ABEND      TO  TRUE                       54920099
549300         SET DP013-NO-ROLLBACK     TO  TRUE                       54930099
549400         MOVE '6105-READ-SEL-QUEUE'                               54940099
549500                                   TO  DP013-PARAGRAPH            54950099
549600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           54960099
549700                                   TO  DP013-MESSAGE-TEXT(1)      54970099
549800         PERFORM DP013-0000-PROCESS-ABEND                         54980099
549900     END-IF.                                                      54990099
550000                                                                  55000099
550100*----------------------------------------------------------------*55010099
550200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*55020099
550300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*55030099
550400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *55040099
550500*----------------------------------------------------------------*55050099
550600 6110-PROCESS-ITEMS.                                              55060099
550700                                                                  55070099
550800     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          55080099
550900                     / PC-ITEMS-PER-PANEL).                       55090099
551000                                                                  55100099
551100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           55110099
551200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          55120099
551300             PERFORM 6111-WRITE-LIST-QUEUE                        55130099
551400         END-IF                                                   55140099
551500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    55150099
551600                                                                  55160099
551700         PERFORM 6112-READ-LIST-QUEUE                             55170099
551800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               55180099
551900             CONTINUE                                             55190099
552000         END-IF                                                   55200099
552100     END-IF.                                                      55210099
552200                                                                  55220099
552300     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     55230099
552400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              55240099
552500     SET LQW-DESELECT (PV-SUB) TO    TRUE                         55250099
552600     MOVE LQW-SELECTED-SW (PV-SUB)                                55260099
552700                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  55270099
552800     EVALUATE TRUE                                                55280099
552900         WHEN SU004-INQ (SU004-IDX)                               55290099
553000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             55300099
553100                                                                  55310099
553200         WHEN SU004-UPD (SU004-IDX)                               55320099
553300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             55330099
553400                                                                  55340099
553500         WHEN SU004-DEL (SU004-IDX)                               55350099
553600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             55360099
553700                                                                  55370099
553800         WHEN SU004-ERR (SU004-IDX)                               55380099
553900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             55390099
554000     END-EVALUATE.                                                55400099
554100                                                                  55410099
554200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                55420099
554300                                                                  55430099
554400*----------------------------------------------------------------*55440099
554500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *55450099
554600*----------------------------------------------------------------*55460099
554700 6111-WRITE-LIST-QUEUE.                                           55470099
554800                                                                  55480099
554900     EXEC CICS                                                    55490099
555000         WRITEQ TS                                                55500099
555100             QUEUE (ASC-LIST-QUEUE-NAME)                          55510099
555200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     55520099
555300             ITEM  (PV-SAVE-ITEM)                                 55530099
555400             REWRITE                                              55540099
555500             RESP  (PV-CICS-RESP)                                 55550099
555600     END-EXEC.                                                    55560099
555700*                                                                 55570099
555800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          55580099
555900         CONTINUE                                                 55590099
556000     ELSE                                                         55600099
556100         SET DP013-CICS-ABEND  TO  TRUE                           55610099
556200         SET DP013-NO-ROLLBACK TO  TRUE                           55620099
556300         MOVE '6111-WRITE-LIST-QUEUE'                             55630099
556400                               TO  DP013-PARAGRAPH                55640099
556500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  55650099
556600                               TO  DP013-MESSAGE-TEXT(1)          55660099
556700         PERFORM DP013-0000-PROCESS-ABEND                         55670099
556800     END-IF.                                                      55680099
556900                                                                  55690099
557000                                                                  55700099
557100*----------------------------------------------------------------*55710099
557200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*55720099
557300*----------------------------------------------------------------*55730099
557400 6112-READ-LIST-QUEUE.                                            55740099
557500                                                                  55750099
557600     EXEC CICS                                                    55760099
557700         READQ TS                                                 55770099
557800             QUEUE (ASC-LIST-QUEUE-NAME)                          55780099
557900             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     55790099
558000             ITEM  (PV-ITEM)                                      55800099
558100             RESP  (PV-CICS-RESP)                                 55810099
558200     END-EXEC.                                                    55820099
558300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          55830099
558400         CONTINUE                                                 55840099
558500     ELSE                                                         55850099
558600         SET DP013-CICS-ABEND        TO TRUE                      55860099
558700         SET DP013-NO-ROLLBACK       TO TRUE                      55870099
558800         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           55880099
558900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    55890099
559000                                     TO DP013-MESSAGE-TEXT(1)     55900099
559100         PERFORM DP013-0000-PROCESS-ABEND                         55910099
559200     END-IF.                                                      55920099
559300                                                                  55930099
559400*----------------------------------------------------------------*55940099
559500*    WRITE THE TS QUEUE RECORD                                   *55950099
559600*----------------------------------------------------------------*55960099
559700                                                                  55970099
559800 6113-WRITE-LIST-QUEUE.                                           55980099
559900                                                                  55990099
560000     EXEC CICS                                                    56000099
560100         WRITEQ TS                                                56010099
560200             QUEUE (ASC-LIST-QUEUE-NAME)                          56020099
560300             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     56030099
560400             ITEM  (PV-ITEM)                                      56040099
560500             REWRITE                                              56050099
560600             RESP  (PV-CICS-RESP)                                 56060099
560700     END-EXEC.                                                    56070099
560800*                                                                 56080099
560900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          56090099
561000         CONTINUE                                                 56100099
561100     ELSE                                                         56110099
561200         SET DP013-CICS-ABEND  TO  TRUE                           56120099
561300         SET DP013-NO-ROLLBACK TO  TRUE                           56130099
561400         MOVE '6113-WRITE-LIST-QUEUE'                             56140099
561500                               TO  DP013-PARAGRAPH                56150099
561600         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  56160099
561700                               TO  DP013-MESSAGE-TEXT(1)          56170099
561800         PERFORM DP013-0000-PROCESS-ABEND                         56180099
561900     END-IF.                                                      56190099
562000                                                                  56200099
562100*----------------------------------------------------------------*56210099
562200 6200-UPDATE-TSQ.                                                 56220099
562300                                                                  56230099
562400     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  56240099
562500     PERFORM 6205-READ-SEL-QUEUE.                                 56250099
562600                                                                  56260099
562700     PERFORM                                                      56270099
562800       VARYING RC013-IDX FROM 1 BY 1                              56280099
562900         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     56290099
563000            OR (RC013-IDX > RC013-MAX-ITEMS))                     56300099
563100                                                                  56310099
563200         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   56320099
563300             PERFORM 6210-PROCESS-ITEMS                           56330099
563400         END-IF                                                   56340099
563500                                                                  56350099
563600         ADD +1 TO PV-ITEMS-PROCESSED                             56360099
563700     END-PERFORM.                                                 56370099
563800                                                                  56380099
563900     PERFORM 6111-WRITE-LIST-QUEUE.                               56390099
564000                                                                  56400099
564100*----------------------------------------------------------------*56410099
564200*    READ THE LIST QUEUE RECORD.                                 *56420099
564300*----------------------------------------------------------------*56430099
564400 6205-READ-SEL-QUEUE.                                             56440099
564500                                                                  56450099
564600     EXEC CICS                                                    56460099
564700          READQ TS                                                56470099
564800              QUEUE (ASC-SEL-QUEUE-NAME)                          56480099
564900              INTO  (RC013-DC-SELECT-RECORD)                      56490099
565000              ITEM  (PV-SEL-QUEUE-ITEM)                           56500099
565100              RESP  (PV-CICS-RESP)                                56510099
565200     END-EXEC.                                                    56520099
565300                                                                  56530099
565400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           56540099
565500         CONTINUE                                                 56550099
565600     ELSE                                                         56560099
565700         SET DP013-CICS-ABEND       TO  TRUE                      56570099
565800         SET DP013-NO-ROLLBACK      TO  TRUE                      56580099
565900         MOVE '6205-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           56590099
566000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           56600099
566100                                    TO  DP013-MESSAGE-TEXT(1)     56610099
566200                                                                  56620099
566300         PERFORM DP013-0000-PROCESS-ABEND                         56630099
566400     END-IF.                                                      56640099
566500                                                                  56650099
566600*----------------------------------------------------------------*56660099
566700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*56670099
566800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*56680099
566900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *56690099
567000*----------------------------------------------------------------*56700099
567100 6210-PROCESS-ITEMS.                                              56710099
567200                                                                  56720099
567300     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          56730099
567400                     / PC-ITEMS-PER-PANEL).                       56740099
567500                                                                  56750099
567600     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            56760099
567700         IF PV-SAVE-ITEM NOT EQUAL ZERO                           56770099
567800             PERFORM 6111-WRITE-LIST-QUEUE                        56780099
567900         END-IF                                                   56790099
568000                                                                  56800099
568100         MOVE PV-ITEM TO PV-SAVE-ITEM                             56810099
568200                                                                  56820099
568300         PERFORM 6112-READ-LIST-QUEUE                             56830099
568400                                                                  56840099
568500         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                56850099
568600             CONTINUE                                             56860099
568700         END-IF                                                   56870099
568800     END-IF.                                                      56880099
568900                                                                  56890099
569000     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     56900099
569100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              56910099
569200                                                                  56920099
569300     SET LQW-DESELECT (PV-SUB) TO TRUE                            56930099
569400     MOVE LQW-SELECTED-SW (PV-SUB)                                56940099
569500                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  56950099
569600                                                                  56960099
569700     EVALUATE TRUE                                                56970099
569800         WHEN RC013-INQ (RC013-IDX)                               56980099
569900              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             56990099
570000                                                                  57000099
570100         WHEN RC013-UPD (RC013-IDX)                               57010099
570200              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             57020099
570300                                                                  57030099
570400         WHEN RC013-DEL (RC013-IDX)                               57040099
570500              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             57050099
570600                                                                  57060099
570700         WHEN RC013-ERR (RC013-IDX)                               57070099
570800              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             57080099
570900     END-EVALUATE.                                                57090099
571000                                                                  57100099
571100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                57110099
571200                                                                  57120099
571300*----------------------------------------------------------------*57130099
571400 6300-UPDATE-TSQ.                                                 57140099
571500                                                                  57150099
571600     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  57160099
571700     PERFORM 6305-READ-SEL-QUEUE.                                 57170099
571800                                                                  57180099
571900     PERFORM                                                      57190099
572000       VARYING PC237-IDX FROM 1 BY 1                              57200099
572100         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     57210099
572200            OR (PC237-IDX > PC237-MAX-ITEMS))                     57220099
572300                                                                  57230099
572400         IF PC237-ACTION-SW (PC237-IDX) > SPACE                   57240099
572500             PERFORM 6310-PROCESS-ITEMS                           57250099
572600         END-IF                                                   57260099
572700                                                                  57270099
572800         ADD +1 TO PV-ITEMS-PROCESSED                             57280099
572900     END-PERFORM.                                                 57290099
573000                                                                  57300099
573100     PERFORM 6111-WRITE-LIST-QUEUE.                               57310099
573200                                                                  57320099
573300                                                                  57330099
573400*----------------------------------------------------------------*57340099
573500*    READ THE LIST QUEUE RECORD.                                 *57350099
573600*----------------------------------------------------------------*57360099
573700 6305-READ-SEL-QUEUE.                                             57370099
573800                                                                  57380099
573900     EXEC CICS                                                    57390099
574000          READQ TS                                                57400099
574100              QUEUE (ASC-SEL-QUEUE-NAME)                          57410099
574200              INTO  (PC237-DC-SELECT-RECORD)                      57420099
574300              ITEM  (PV-SEL-QUEUE-ITEM)                           57430099
574400              RESP  (PV-CICS-RESP)                                57440099
574500     END-EXEC.                                                    57450099
574600                                                                  57460099
574700     IF PV-CICS-RESP = DFHRESP (NORMAL)                           57470099
574800         CONTINUE                                                 57480099
574900     ELSE                                                         57490099
575000         SET DP013-CICS-ABEND       TO  TRUE                      57500099
575100         SET DP013-NO-ROLLBACK      TO  TRUE                      57510099
575200         MOVE '6305-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           57520099
575300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           57530099
575400                                    TO  DP013-MESSAGE-TEXT(1)     57540099
575500                                                                  57550099
575600         PERFORM DP013-0000-PROCESS-ABEND                         57560099
575700     END-IF.                                                      57570099
575800                                                                  57580099
575900                                                                  57590099
576000*----------------------------------------------------------------*57600099
576100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*57610099
576200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*57620099
576300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *57630099
576400*----------------------------------------------------------------*57640099
576500 6310-PROCESS-ITEMS.                                              57650099
576600                                                                  57660099
576700     COMPUTE PV-ITEM = 1 + ((PC237-ITEM (PC237-IDX) - 1)          57670099
576800                     / PC-ITEMS-PER-PANEL).                       57680099
576900                                                                  57690099
577000     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            57700099
577100         IF PV-SAVE-ITEM NOT EQUAL ZERO                           57710099
577200             PERFORM 6111-WRITE-LIST-QUEUE                        57720099
577300         END-IF                                                   57730099
577400                                                                  57740099
577500         MOVE PV-ITEM TO PV-SAVE-ITEM                             57750099
577600                                                                  57760099
577700         PERFORM 6112-READ-LIST-QUEUE                             57770099
577800                                                                  57780099
577900         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                57790099
578000             CONTINUE                                             57800099
578100         END-IF                                                   57810099
578200     END-IF.                                                      57820099
578300                                                                  57830099
578400     COMPUTE PV-SUB = (PC237-ITEM (PC237-IDX)                     57840099
578500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              57850099
578600                                                                  57860099
578700     SET LQW-DESELECT (PV-SUB) TO TRUE                            57870099
578800     MOVE LQW-SELECTED-SW (PV-SUB)                                57880099
578900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  57890099
579000                                                                  57900099
579100     EVALUATE TRUE                                                57910099
579200         WHEN PC237-INQ (PC237-IDX)                               57920099
579300              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             57930099
579400                                                                  57940099
579500         WHEN PC237-UPD (PC237-IDX)                               57950099
579600              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             57960099
579700                                                                  57970099
579800         WHEN PC237-DEL (PC237-IDX)                               57980099
579900              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             57990099
580000                                                                  58000099
580100         WHEN PC237-ERR (PC237-IDX)                               58010099
580200              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             58020099
580300     END-EVALUATE.                                                58030099
580400                                                                  58040099
580500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                58050099
580600                                                                  58060099
580700*----------------------------------------------------------------*58070099
580800 6400-UPDATE-TSQ.                                                 58080099
580900                                                                  58090099
581000     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  58100099
581100     PERFORM 6405-READ-SEL-QUEUE.                                 58110099
581200                                                                  58120099
581300     PERFORM                                                      58130099
581400       VARYING RC816-IDX FROM 1 BY 1                              58140099
581500         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     58150099
581600            OR (RC816-IDX > RC816-MAX-ITEMS))                     58160099
581700                                                                  58170099
581800         IF RC816-ACTION-SW (RC816-IDX) > SPACE                   58180099
581900             PERFORM 6410-PROCESS-ITEMS                           58190099
582000         END-IF                                                   58200099
582100                                                                  58210099
582200         ADD +1 TO PV-ITEMS-PROCESSED                             58220099
582300     END-PERFORM.                                                 58230099
582400                                                                  58240099
582500     PERFORM 6111-WRITE-LIST-QUEUE.                               58250099
582600                                                                  58260099
582700*----------------------------------------------------------------*58270099
582800*    READ THE LIST QUEUE RECORD.                                 *58280099
582900*----------------------------------------------------------------*58290099
583000 6405-READ-SEL-QUEUE.                                             58300099
583100                                                                  58310099
583200     EXEC CICS                                                    58320099
583300          READQ TS                                                58330099
583400              QUEUE (ASC-SEL-QUEUE-NAME)                          58340099
583500              INTO  (RC816-SELECT-RECORD)                         58350099
583600              ITEM  (PV-SEL-QUEUE-ITEM)                           58360099
583700              RESP  (PV-CICS-RESP)                                58370099
583800     END-EXEC.                                                    58380099
583900                                                                  58390099
584000     IF PV-CICS-RESP = DFHRESP (NORMAL)                           58400099
584100         CONTINUE                                                 58410099
584200     ELSE                                                         58420099
584300         SET DP013-CICS-ABEND       TO  TRUE                      58430099
584400         SET DP013-NO-ROLLBACK      TO  TRUE                      58440099
584500         MOVE '6405-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           58450099
584600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           58460099
584700                                    TO  DP013-MESSAGE-TEXT(1)     58470099
584800         PERFORM DP013-0000-PROCESS-ABEND                         58480099
584900     END-IF.                                                      58490099
585000                                                                  58500099
585100*----------------------------------------------------------------*58510099
585200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*58520099
585300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*58530099
585400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *58540099
585500*----------------------------------------------------------------*58550099
585600 6410-PROCESS-ITEMS.                                              58560099
585700                                                                  58570099
585800     COMPUTE PV-ITEM = 1 + ((RC816-ITEM (RC816-IDX) - 1)          58580099
585900                     / PC-ITEMS-PER-PANEL).                       58590099
586000                                                                  58600099
586100     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            58610099
586200         IF PV-SAVE-ITEM NOT EQUAL ZERO                           58620099
586300             PERFORM 6111-WRITE-LIST-QUEUE                        58630099
586400         END-IF                                                   58640099
586500                                                                  58650099
586600         MOVE PV-ITEM TO PV-SAVE-ITEM                             58660099
586700                                                                  58670099
586800         PERFORM 6112-READ-LIST-QUEUE                             58680099
586900                                                                  58690099
587000         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                58700099
587100             CONTINUE                                             58710099
587200         END-IF                                                   58720099
587300     END-IF.                                                      58730099
587400                                                                  58740099
587500     COMPUTE PV-SUB = (RC816-ITEM (RC816-IDX)                     58750099
587600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              58760099
587700                                                                  58770099
587800     SET LQW-DESELECT (PV-SUB) TO TRUE                            58780099
587900     MOVE LQW-SELECTED-SW (PV-SUB)                                58790099
588000                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  58800099
588100                                                                  58810099
588200     EVALUATE TRUE                                                58820099
588300         WHEN RC816-INQ (RC816-IDX)                               58830099
588400              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             58840099
588500                                                                  58850099
588600         WHEN RC816-UPD (RC816-IDX)                               58860099
588700              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             58870099
588800                                                                  58880099
588900         WHEN RC816-DEL (RC816-IDX)                               58890099
589000              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             58900099
589100                                                                  58910099
589200         WHEN RC816-ERR (RC816-IDX)                               58920099
589300              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             58930099
589400     END-EVALUATE.                                                58940099
589500                                                                  58950099
589600     MOVE RC816-ACTL-CART-COUNT (RC816-IDX)                       58960099
589700                               TO LQW-ACTL-CART-COUNT (PV-SUB).   58970099
589800                                                                  58980099
589900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                58990099
590000                                                                  59000099
590100*----------------------------------------------------------------*59010099
590200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *59020099
590300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *59030099
590400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *59040099
590500*                                                                *59050099
590600*    THIS QUEUE IS USED FOR CARTON ASSIGNED LIST                 *59060099
590700*----------------------------------------------------------------*59070099
590800 6500-UPDATE-TSQ.                                                 59080099
590900     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             59090099
591000     PERFORM 6505-READ-SEL-QUEUE.                                 59100099
591100     PERFORM                                                      59110099
591200         VARYING SU004-IDX                                        59120099
591300         FROM 1 BY 1                                              59130099
591400         UNTIL ((PV-ITEMS-PROCESSED >                             59140099
591500                              PV-HOLD-SELECTED-ITEMS)             59150099
591600         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             59160099
591700         IF  SU004-ACTION-SW (SU004-IDX) > SPACE                  59170099
591800             PERFORM 6510-PROCESS-ITEMS                           59180099
591900         END-IF                                                   59190099
592000         ADD +1                TO PV-ITEMS-PROCESSED              59200099
592100     END-PERFORM.                                                 59210099
592200     PERFORM 6111-WRITE-LIST-QUEUE.                               59220099
592300                                                                  59230099
592400                                                                  59240099
592500*----------------------------------------------------------------*59250099
592600*    READ THE LIST QUEUE RECORD.                                 *59260099
592700*                                                                *59270099
592800*    THIS QUEUE IS USED FOR THE CARTON  ASSGN LIST               *59280099
592900*----------------------------------------------------------------*59290099
593000 6505-READ-SEL-QUEUE.                                             59300099
593100     EXEC CICS                                                    59310099
593200          READQ TS                                                59320099
593300              QUEUE (ASC-SEL-QUEUE-NAME)                          59330099
593400              INTO  (SU004-DC-SELECT-RECORD)                      59340099
593500              ITEM  (PV-SEL-QUEUE-ITEM)                           59350099
593600              RESP  (PV-CICS-RESP)                                59360099
593700     END-EXEC.                                                    59370099
593800                                                                  59380099
593900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59390099
594000         CONTINUE                                                 59400099
594100     ELSE                                                         59410099
594200         SET DP013-CICS-ABEND      TO  TRUE                       59420099
594300         SET DP013-NO-ROLLBACK     TO  TRUE                       59430099
594400         MOVE '6505-READ-SEL-QUEUE'                               59440099
594500                                   TO  DP013-PARAGRAPH            59450099
594600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           59460099
594700                                   TO  DP013-MESSAGE-TEXT(1)      59470099
594800         PERFORM DP013-0000-PROCESS-ABEND                         59480099
594900     END-IF.                                                      59490099
595000                                                                  59500099
595100*----------------------------------------------------------------*59510099
595200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*59520099
595300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*59530099
595400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *59540099
595500*                                                                *59550099
595600*    THIS QUEUE IS USED FOR THE CARTON ASSIGN LIST               *59560099
595700*----------------------------------------------------------------*59570099
595800 6510-PROCESS-ITEMS.                                              59580099
595900     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          59590099
596000                     / PC-ITEMS-PER-PANEL).                       59600099
596100                                                                  59610099
596200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           59620099
596300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          59630099
596400             PERFORM 6111-WRITE-LIST-QUEUE                        59640099
596500         END-IF                                                   59650099
596600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    59660099
596700                                                                  59670099
596800         PERFORM 6112-READ-LIST-QUEUE                             59680099
596900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               59690099
597000             CONTINUE                                             59700099
597100         END-IF                                                   59710099
597200     END-IF.                                                      59720099
597300                                                                  59730099
597400     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     59740099
597500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              59750099
597600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         59760099
597700     MOVE LQW-SELECTED-SW (PV-SUB)                                59770099
597800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  59780099
597900     EVALUATE TRUE                                                59790099
598000         WHEN SU004-INQ (SU004-IDX)                               59800099
598100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             59810099
598200                                                                  59820099
598300         WHEN SU004-UPD (SU004-IDX)                               59830099
598400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             59840099
598500                                                                  59850099
598600         WHEN SU004-DEL (SU004-IDX)                               59860099
598700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             59870099
598800                                                                  59880099
598900         WHEN SU004-ERR (SU004-IDX)                               59890099
599000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             59900099
599100     END-EVALUATE.                                                59910099
599200                                                                  59920099
599300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                59930099
599400                                                                  59940099
599500 7000-FORMAT-COMMAREA.                                            59950099
599600                                                                  59960099
599700     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            59970099
599800        MOVE 1                   TO PV-BLOCK-NUMBER               59980099
599900     ELSE                                                         59990099
600000        MOVE 2                   TO PV-BLOCK-NUMBER               60000099
600100     END-IF.                                                      60010099
600200                                                                  60020099
600300     PERFORM VARYING PV-SUB FROM 1 BY 1                           60030099
600400             UNTIL  PV-SUB > PC-ITEMS-PER-PANEL                   60040099
600500         IF  ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'      60050099
600600             MOVE ASC-RECEIVER    (PV-BLOCK-NUMBER PV-SUB)        60060099
600700                                  TO RC015-REC-SEQ-NBR            60070099
600800             COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1              60080099
600900         END-IF                                                   60090099
601000     END-PERFORM.                                                 60100099
601100                                                                  60110099
601200     MOVE ASC-PO-NUMBER       TO RC015-PO-NBR.                    60120099
601300                                                                  60130099
601400***************************************************************** 60140099
601500 9100-READ-SEL-QUEUE.                                             60150099
601600     EXEC CICS                                                    60160099
601700         READQ TS                                                 60170099
601800             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        60180099
601900             INTO  (SU004-DC-SELECT-RECORD)                       60190099
602000             ITEM  (ASC-SEL-ITEM)                                 60200099
602100             RESP  (PV-CICS-RESP)                                 60210099
602200     END-EXEC.                                                    60220099
602300     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        60230099
602400         CONTINUE                                                 60240099
602500     ELSE                                                         60250099
602600         SET DP013-LOGIC-ABEND                                    60260099
602700             DP013-NO-ROLLBACK   TO   TRUE                        60270099
602800         MOVE '9100-READ-SEL-QUEUE'                               60280099
602900                                 TO   DP013-PARAGRAPH             60290099
603000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   60300099
603100                                 TO   DP013-MESSAGE-TEXT (1)      60310099
603200         PERFORM DP013-0000-PROCESS-ABEND                         60320099
603300     END-IF.                                                      60330099
603400                                                                  60340099
603500***************************************************************** 60350099
603600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *60360099
603700***************************************************************** 60370099
603800 9200-REWRITE-SEL-QUEUE.                                          60380099
603900                                                                  60390099
604000     EXEC CICS                                                    60400099
604100          WRITEQ TS                                               60410099
604200              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      60420099
604300              FROM   (SU004-DC-SELECT-RECORD)                     60430099
604400              ITEM   (ASC-SEL-ITEM)                               60440099
604500              RESP   (PV-CICS-RESP)                               60450099
604600              REWRITE                                             60460099
604700     END-EXEC.                                                    60470099
604800                                                                  60480099
604900     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   60490099
605000         SET DP013-CICS-ABEND                                     60500099
605100             DP013-NO-ROLLBACK     TO TRUE                        60510099
605200         MOVE '9200-REWRITE-SEL-QUEUE'                            60520099
605300                                   TO DP013-PARAGRAPH             60530099
605400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   60540099
605500                                   TO DP013-MESSAGE-TEXT (1)      60550099
605600         PERFORM DP013-0000-PROCESS-ABEND                         60560099
605700     END-IF.                                                      60570099
605800                                                                  60580099
605900*----------------------------------------------------------------*60590099
606000*    ABEND PROCESSOR MODULE                                      *60600099
606100*----------------------------------------------------------------*60610099
606200     COPY DPPD013.                                                60620099
606300                                                                  60630099
606400 9900-WRITE-CICS-LOG.                                             60640099
606500                                                                  60650099
606600     MOVE LENGTH OF PV-CICS-MSG-AREA                              60660099
606700          TO PV-COMMAREA-LENGTH                                   60670099
606800                                                                  60680099
606900     EXEC CICS                                                    60690099
607000         WRITEQ TD                                                60700099
607100             QUEUE  ('CSSL')                                      60710099
607200             FROM   (PV-CICS-MSG-AREA)                            60720099
607300             LENGTH (PV-COMMAREA-LENGTH)                          60730099
607400             RESP   (PV-CICS-RESP)                                60740099
607500     END-EXEC.                                                    60750099
607600                                                                  60760099
607700     MOVE SPACES TO PV-CICS-MSG-AREA.                             60770099
607800*                                                                 60780099
