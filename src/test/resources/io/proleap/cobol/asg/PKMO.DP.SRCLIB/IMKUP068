       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.             IMKUP068.                                        
       AUTHOR.                 PAUL KEBER.                                      
       INSTALLATION.           KOHLS DEPARTMENT STORES.                         
       DATE-WRITTEN.           04/03/2007.                                      
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *  IMKUP068 - CUSTOMER INTERFACE DESCRIPTION CHARACTERISTIC CHANGE        
      ******************************************************************        
      *  THIS PROGRAM READS THE IMT_CHARTC_CHG DATABASE THAT CONTAINS           
      *  SHORT DESCRIPTION CHANGES FOR DEFAULT MAINTENANCE                      
      *  CHARACTERISTIC VALUES.  FOR EACH CHARACTERISTIC VALUE CHANGE,          
      *  FIND ALL STYLES THAT CONTAIN THAT CHARACTERISTIC VALUE.  THE           
      *  CUSTOMER INTERFACE DESCRIPTION IS REBUILT FOR EACH STYLE BY            
      *  ACCESSING THE SPECIFIC SUBCLASS, MAJOR CLASS, OR DEPARTMENT            
      *  RULE ON IMT_CHARTC_RULDESC FOR THAT STYLE.  IF NO BUSINESS RULE        
      *  IS FOUND ON IMT_CHARTC_RULDESC FOR THE STYLE BEING PROCESSED,          
      *  DETERMINE IF A VALID DEFAULT BRAND/HIERARCHY CUSTOMER INTERFACE        
      *  DESCRIPTION CAN BE CREATED.  IF THE NEW CUSTOMER INTERFACE             
      *  DESCRIPTION IS DIFFERENT FROM THE DESCRIPTION ON TMDARVS, THE          
      *  TMDARVS ROW CUSTOMER INTERFACE DESCRIPTION WILL BEUPDATED FOR          
      *  THAT STYLE.  THE IMT_CHARTC_CHG ROW BEING PROCESSED WILL BE            
      *  DELETED ONCE ALL STYLES HAVE BEEN PROCESSED.  THIS PROGRAM WILL        
      *  TAKE CHECKPOINTS AT A TCKRSTCNTL.CKPT_FRQNCY_QTY SECONDS TIME          
      *  INTERVAL.                                                              
      ******************************************************************        
      *  CHANGE LOG:                                                            
      *                                                                         
      *  04/03/07 - PAUL KEBER.  WR #31557                                      
      *             NEW PROGRAM FOR THE CUSTOMER INTERFACE DESCRIPTION          
      *             PROJECT.                                                    
W35681******************************************************************        
W35681*  09/28/10 - BRUCE GRAHAM - KFORCE                                       
W35681*             WR35681, WR37044, WR37184, WR38861 ETL                      
W35681*             CUSTOMER DESCRIPTION CHANGE NEW TMDARVS ATTRIBUTES          
      ******************************************************************        
                                                                                
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
      ******************************************************************        
                                                                                
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER.                        IBM-3090.                        
       OBJECT-COMPUTER.                        IBM-3090.                        
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
                                                                                
           SELECT CHARACTR-CHGS-BKUP-FILE                                       
               ASSIGN TO OUT01.                                                 
                                                                                
      ******************************************************************        
       DATA DIVISION.                                                           
      ******************************************************************        
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  CHARACTR-CHGS-BKUP-FILE                                              
           RECORDING MODE F                                                     
           LABEL RECORDS OMITTED                                                
           BLOCK CONTAINS  0 RECORDS.                                           
       01  CHARACTR-CHGS-BKUP-REC        PIC X(24).                             
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
      ******************************************************************        
      * PROGRAM ACCUMULATORS                                           *        
      ******************************************************************        
                                                                                
       01  PA-PROGRAM-ACCUMULATORS.                                             
           05  PA-CHARTC-CHGS-WRITE-COUNT    PIC S9(09)   VALUE +0 COMP.        
           05  PA-NBR-CHARTC-CHG-DELETES     PIC S9(09)   VALUE +0 COMP.        
           05  PA-NBR-BUS-RULES-PROCESSED    PIC S9(09)   VALUE +0 COMP.        
           05  PA-NBR-STYLES-PROCESSED       PIC S9(09)   VALUE +0 COMP.        
           05  PA-NBR-TMDARVS-UPDATES        PIC S9(09)   VALUE +0 COMP.        
           05  PA-NBR-COMMITS-TAKEN          PIC S9(09)   VALUE +0 COMP.        
                                                                                
      ******************************************************************        
      * PROGRAM CONSTANTS                                              *        
      ******************************************************************        
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-PROGRAM-NAME               PIC  X(08)    VALUE                
                                                           'IMKUP068'.          
           05  PC-JOB-NAME                   PIC  X(06)    VALUE                
                                                           'IMK011'.            
           05  PC-BUSINESS-GROUP-DESC        PIC  9(02)    VALUE 5.             
           05  PC-BUS-GRP-CHARTC-CDE         PIC S9(04)    VALUE +5             
                                                           COMP.                
           05  PC-MAXIMUM-RETRY-COUNT        PIC S9(04)    VALUE +3             
                                                           COMP SYNC.           
           05  PC-ATTR-BRAND                 PIC S9(04)    VALUE +3             
                                                           COMP.                
           05  PC-ATTR-HIER                  PIC S9(04)    VALUE +21            
                                                           COMP.                
W35681     05  PC-ATTR-CTG                   PIC S9(04)    VALUE +36            
W35681                                                     COMP.                
                                                                                
      ******************************************************************        
      * PROGRAM VARIABLES                                              *        
      ******************************************************************        
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-RETRY-COUNT                PIC S9(04)   VALUE +0 COMP.        
           05  PV-END-SPACE-CNT              PIC S9(04)   VALUE +0 COMP.        
           05  PV-END-SPACE-CNT-1            PIC S9(04)   VALUE +0 COMP.        
           05  PV-END-SPACE-CNT-2            PIC S9(04)   VALUE +0 COMP.        
           05  PV-END-SPACE-CNT-3            PIC S9(04)   VALUE +0 COMP.        
           05  PV-PREV-LBL-SEQ-NBR           PIC S9(04)   VALUE +0 COMP.        
           05  PV-PREV-RPT-HIER-SEQ-NBR      PIC S9(04)   VALUE +0 COMP.        
           05  PV-PREV-BDY-STYL-SEQ-NBR      PIC S9(04)   VALUE +0 COMP.        
           05  PV-PREV-SLHTT-SEQ-NBR         PIC S9(04)   VALUE +0 COMP.        
           05  PV-PREV-FUNC-SEQ-NBR          PIC S9(04)   VALUE +0 COMP.        
           05  PV-PREV-GNDR-SEQ-NBR          PIC S9(04)   VALUE +0 COMP.        
           05  PV-PREV-FBRCN-SEQ-NBR         PIC S9(04)   VALUE +0 COMP.        
           05  PV-PREV-PATRN-SEQ-NBR         PIC S9(04)   VALUE +0 COMP.        
W35681     05  PV-PREV-CTG-SEQ-NBR           PIC S9(04)   VALUE +0 COMP.        
W35681     05  PV-PREV-MAJ-CTG-SEQ-NBR       PIC S9(04)   VALUE +0 COMP.        
W35681     05  PV-PREV-MTRL-SEQ-NBR          PIC S9(04)   VALUE +0 COMP.        
W35681     05  PV-PREV-ATTR-1-SEQ-NBR        PIC S9(04)   VALUE +0 COMP.        
W35681     05  PV-PREV-ATTR-2-SEQ-NBR        PIC S9(04)   VALUE +0 COMP.        
W35681     05  PV-PREV-NW-SLHTT-SEQ-NBR      PIC S9(04)   VALUE +0 COMP.        
           05  PV-CHARTC-CHG-CDE             PIC S9(04)   VALUE +0 COMP.        
               88  PV-CHARTC-CHG-FABRICATION              VALUE +1.             
               88  PV-CHARTC-CHG-BRAND                    VALUE +3.             
               88  PV-CHARTC-CHG-PATTERN                  VALUE +7.             
               88  PV-CHARTC-CHG-HIERARCHY                VALUE +21.            
               88  PV-CHARTC-CHG-FUNCTION                 VALUE +22.            
               88  PV-CHARTC-CHG-SILHOUETTE               VALUE +23.            
               88  PV-CHARTC-CHG-BODYSTYLE                VALUE +24.            
               88  PV-CHARTC-CHG-GENDER                   VALUE +26.            
W35681         88  PV-CHARTC-CHG-CTG                      VALUE +36.            
W35681         88  PV-CHARTC-CHG-MAJ-CTG                  VALUE +37.            
W35681         88  PV-CHARTC-CHG-NW-SILH                  VALUE +38.            
W35681         88  PV-CHARTC-CHG-MTRL                     VALUE +39.            
W35681         88  PV-CHARTC-CHG-ATTR-1                   VALUE +42.            
W35681         88  PV-CHARTC-CHG-ATTR-2                   VALUE +43.            
           05  PV-CHARTC-CDE                 PIC S9(04)   VALUE +0 COMP.        
               88  IM-CHARTC-CDE                          VALUES                
                                                           +1, +3,              
                                                           +7, +21,             
                                                          +22, +23,             
                                                          +24, +26,             
W35681                                                    +36, +37,             
W35681                                                    +38, +39,             
W35681                                                    +42, +43.             
               88  BG-CHARTC-CDE                          VALUE +5.             
           05  PV-CHARTC-CDE-TYPE            PIC S9(04)   VALUE +0 COMP.        
               88  PV-ATTR-FABRICATION                    VALUE +1.             
               88  PV-ATTR-BRAND                          VALUE +3.             
               88  PV-ATTR-PATTERN                        VALUE +7.             
               88  PV-ATTR-HIER                           VALUE +21.            
               88  PV-ATTR-FUNC                           VALUE +22.            
               88  PV-ATTR-SILH                           VALUE +23.            
               88  PV-ATTR-BDYSTL                         VALUE +24.            
               88  PV-ATTR-GNDR                           VALUE +26.            
               88  PV-ATTR-BUSGRP                         VALUE +5.             
W35681         88  PV-ATTR-CTG                            VALUE +36.            
W35681         88  PV-ATTR-MAJ-CTG                        VALUE +37.            
W35681         88  PV-ATTR-NW-SILH                        VALUE +38.            
W35681         88  PV-ATTR-MTRL                           VALUE +39.            
W35681         88  PV-ATTR-ATTR-1                         VALUE +42.            
W35681         88  PV-ATTR-ATTR-2                         VALUE +43.            
           05  PV-CHARTC-CHG-SEQ-NBR         PIC S9(04)   VALUE +0 COMP.        
                                                                                
           05  PV-PREV-DEPT-NBR              PIC S9(4)V   VALUE +0              
                                                          COMP-3.               
           05  PV-PREV-MAJ-CL-NBR            PIC S9(4)V   VALUE +0              
                                                          COMP-3.               
           05  PV-PREV-SUB-CL-NBR            PIC S9(4)V   VALUE +0              
                                                          COMP-3.               
           05  PV-CURR-DEPT                  PIC  X(03)   VALUE SPACES.         
           05  PV-CURR-DEPT-9    REDEFINES PV-CURR-DEPT                         
                                             PIC  9(03).                        
           05  PV-CURR-MCL                   PIC  X(02)   VALUE SPACES.         
           05  PV-CURR-MCL-9     REDEFINES PV-CURR-MCL                          
                                             PIC  9(02).                        
           05  PV-CURR-SCL                   PIC  X(03)   VALUE SPACES.         
           05  PV-CURR-SCL-9     REDEFINES PV-CURR-SCL                          
                                             PIC  9(03).                        
                                                                                
           05  PV-BUSRULE-MISSING-DEPT       PIC X(3)     VALUE SPACES.         
           05  PV-PREV-BUSGP-DEPT            PIC X(3)     VALUE SPACES.         
           05  PV-PREV-MDSELV-CDE            PIC X(3)     VALUE SPACES.         
           05  PV-CUST-DESC                  PIC X(26)    VALUE SPACES.         
           05  PV-CUST-DESC-PART-1           PIC X(8)     VALUE SPACES.         
           05  PV-CUST-DESC-PART-2           PIC X(8)     VALUE SPACES.         
           05  PV-CUST-DESC-PART-3           PIC X(8)     VALUE SPACES.         
           05  PV-CUST-DESC-DFLT-BRND        PIC X(8)     VALUE SPACES.         
           05  PV-CUST-DESC-DFLT-HIER        PIC X(8)     VALUE SPACES.         
W35681     05  PV-CUST-DESC-DFLT-CTG         PIC X(8)     VALUE SPACES.         
           05  PV-CUST-DESC-EDITED           PIC X(26)    VALUE SPACES.         
           05  PV-SAVED-BUS-GRP-DESC         PIC X(8)     VALUE SPACES.         
           05  PV-SHORT-DESC                 PIC X(8)     VALUE SPACES.         
           05  PV-NBR-BLANK-ATTRS            PIC S9(1)    VALUE ZEROES.         
           05  PV-CNT-TRAILING-SPACES        PIC X(8)     VALUE SPACES.         
           05  PV-7-TRAILING-SPCS  REDEFINES                                    
               PV-CNT-TRAILING-SPACES.                                          
               10  FILLER                    PIC  X(1).                         
               10  PV-7-TRLNG-SPCS           PIC  X(7).                         
           05  PV-6-TRAILING-SPCS  REDEFINES                                    
               PV-CNT-TRAILING-SPACES.                                          
               10  FILLER                    PIC  X(2).                         
               10  PV-6-TRLNG-SPCS           PIC  X(6).                         
           05  PV-5-TRAILING-SPCS  REDEFINES                                    
               PV-CNT-TRAILING-SPACES.                                          
               10  FILLER                    PIC  X(3).                         
               10  PV-5-TRLNG-SPCS           PIC  X(5).                         
           05  PV-4-TRAILING-SPCS  REDEFINES                                    
               PV-CNT-TRAILING-SPACES.                                          
               10  FILLER                    PIC  X(4).                         
               10  PV-4-TRLNG-SPCS           PIC  X(4).                         
           05  PV-3-TRAILING-SPCS  REDEFINES                                    
               PV-CNT-TRAILING-SPACES.                                          
               10  FILLER                    PIC  X(5).                         
               10  PV-3-TRLNG-SPCS           PIC  X(3).                         
           05  PV-2-TRAILING-SPCS  REDEFINES                                    
               PV-CNT-TRAILING-SPACES.                                          
               10  FILLER                    PIC  X(6).                         
               10  PV-2-TRLNG-SPCS           PIC  X(2).                         
           05  PV-1-TRAILING-SPCS  REDEFINES                                    
               PV-CNT-TRAILING-SPACES.                                          
               10  FILLER                    PIC  X(7).                         
               10  PV-1-TRLNG-SPCS           PIC  X(1).                         
                                                                                
           05  PV-NBR-BUS-GRP-SELECTS        PIC S9(9)    VALUE ZEROES          
                                                          COMP-3.               
           05  PV-DB2-OPERATION-ATTEMPTED    PIC X(30)    VALUE SPACE.          
           05  PV-PARAGRAPH-NAME             PIC X(30)    VALUE SPACE.          
           05  PV-CURRENT-TIMESTAMP          PIC X(26)    VALUE SPACES.         
           05  PV-COMMIT-TIMESTAMP           PIC X(26)    VALUE SPACES.         
           05  PV-DISPLAY-COUNT              PIC ZZZ,ZZZ,ZZ9                    
                                                          VALUE ZEROES.         
           05  PV-DISPLAY-SQLCODE            PIC ZZ999-   VALUE ZEROES.         
                                                                                
      ******************************************************************        
      * PROGRAM SWITCHES                                               *        
      ******************************************************************        
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-END-OF-BUS-RULE-CSR-SW     PIC X(1)     VALUE 'N'.            
               88  PS-END-OF-BUS-RULE-CSR                 VALUE 'Y'.            
               88  PS-NOT-END-OF-BUS-RULE-CSR             VALUE 'N'.            
W35681     05  PS-BRAND-CTG-HIER-DFLT-FND-SW                                    
                                             PIC X(1)     VALUE 'N'.            
W35681         88  PS-BRAND-CTG-HIER-DFLT-FND                 VALUE 'Y'.        
           05  PS-BUS-RULE-FOUND-SW          PIC X(1)     VALUE 'N'.            
               88  PS-BUS-RULE-FOUND                      VALUE 'Y'.            
               88  PS-BUS-RULE-NOT-FOUND                  VALUE 'N'.            
           05  PS-END-OF-BG-DEPTS-CSR-SW     PIC X(1)     VALUE 'N'.            
               88  PS-END-OF-BG-DEPTS-CSR                 VALUE 'Y'.            
           05  PS-END-OF-CHARTC-CHG-CSR-SW   PIC X(1)     VALUE 'N'.            
               88  PS-END-OF-CHARTC-CHG-CSR               VALUE 'Y'.            
           05  PS-NEXT-DEPT-SW               PIC X(1)     VALUE 'N'.            
               88  PS-NEXT-DEPT                           VALUE 'Y'.            
           05  PS-BUS-RULE-LVL-SW            PIC X(1)     VALUE ' '.            
               88  PS-DEPT-LVL-RULE                       VALUE 'D'.            
               88  PS-MCL-LVL-RULE                        VALUE 'M'.            
               88  PS-SCL-LVL-RULE                        VALUE 'S'.            
           05  PS-END-OF-STYLE-CSR-SW        PIC X(1)     VALUE 'N'.            
               88  PS-END-OF-STYLE-CSR                    VALUE 'Y'.            
           05  PS-DFLT-BRND-IS-BLANK-SW      PIC X(1)     VALUE 'N'.            
               88  PS-DFLT-BRND-IS-BLANK                  VALUE 'Y'.            
           05  PS-DFLT-HIER-IS-BLANK-SW      PIC X(1)     VALUE 'N'.            
               88  PS-DFLT-HIER-IS-BLANK                  VALUE 'Y'.            
W35681     05  PS-DFLT-CTG-IS-BLANK-SW       PIC X(1)     VALUE 'N'.            
W35681         88  PS-DFLT-CTG-IS-BLANK                   VALUE 'Y'.            
           05  PS-ERROR-FOUND-SW             PIC X(01)    VALUE 'N'.            
               88  PS-NO-ERROR-FOUND                      VALUE 'N'.            
               88  PS-ERROR-FOUND                         VALUE 'Y'.            
                                                                                
       01  ABEND-CODE                        PIC S9(04)    VALUE +0             
                                                           COMP SYNC.           
                                                                                
      *****************************************************************         
      *  CHARACTERISTIC CHANGES BACKUP OUTPUT FILE RECORD                       
      *****************************************************************         
       01  WS-CHAR-CHGS-BKUP-REC.                                               
           05  WS-CCBR-CHARTC-CDE        PIC 9(4)    VALUE ZERO.                
           05  WS-CCBR-CHARTC-SEQ-NBR    PIC 9(4)    VALUE ZERO.                
           05  WS-CCBR-CHARTC-SHRT-DESC  PIC X(8)    VALUE SPACES.              
           05  WS-CCBR-OLD-CHARSHRT-DESC PIC X(8)    VALUE SPACES.              
                                                                                
      * VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004                 
           COPY DPWS004.                                                        
                                                                                
      *****************************************************************         
      *  TABLE DCLGEN - IMT_CHARTC_CHG                                          
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE IMT00023                                                 
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      *  TABLE DCLGEN - IMT_CHARTC_RULDESC                                      
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE IMT00022                                                 
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      *  TABLE DCLGEN - TMDSEAR                                                 
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE TMDSEAR                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      *  TABLE DCLGEN - TMDSEBG                                                 
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE TMDSEBG                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      *  TABLE DCLGEN - TVNDSTL                                                 
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE TVNDSTL                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      *  TABLE DCLGEN - TMDARVS                                                 
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE TMDARVS                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      *  TABLE DCLGEN - TVSCHVL                                                 
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE TVSCHVL                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      *  TABLE DCLGEN - TMDSEDP                                                 
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE TMDSEDP                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DB2 CHECKPOINT RESTART CONTROL TABLE                                    
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE TCKRSTCN                                                 
           END-EXEC.                                                            
                                                                                
      *  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                        
                                                                                
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
           COPY SQLCA2.                                                         
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL CUSTOMER INTERFACE DESCRIPTION                  
      *  CHARACTERISTIC CHANGES                                                 
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE CHARTC_CHG_CSR CURSOR WITH HOLD FOR                        
               SELECT CHARTC_CDE                                                
                     ,CHARTC_SEQ_NBR                                            
                     ,CHARTC_SHRT_DESC                                          
                     ,OLD_CHARSHRT_DESC                                         
                 FROM IMT_CHARTC_CHG                                            
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC FABRICATION        
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE FABRCTN_STYLES_CSR CURSOR WITH HOLD FOR                    
                SELECT SUB_CL_MDSEAR_ID                                         
                     , VS_ID                                                    
                     , DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
                     , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
                  FROM TMDARVS                                                  
                 WHERE ACTV_IND      = 'Y'                                      
                   AND FBRCN_SEQ_NBR = :PV-CHARTC-CHG-SEQ-NBR                   
              ORDER BY DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC BRAND              
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE BRAND_STYLES_CSR CURSOR WITH HOLD FOR                      
                SELECT SUB_CL_MDSEAR_ID                                         
                     , VS_ID                                                    
                     , DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
                     , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
                  FROM TMDARVS                                                  
                 WHERE ACTV_IND    = 'Y'                                        
                   AND LBL_SEQ_NBR = :PV-CHARTC-CHG-SEQ-NBR                     
              ORDER BY DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC PATTERN            
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE PATTERN_STYLES_CSR CURSOR WITH HOLD FOR                    
                SELECT SUB_CL_MDSEAR_ID                                         
                     , VS_ID                                                    
                     , DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
                     , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
                  FROM TMDARVS                                                  
                 WHERE ACTV_IND      = 'Y'                                      
                   AND PATRN_SEQ_NBR = :PV-CHARTC-CHG-SEQ-NBR                   
              ORDER BY DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC HIERARCHY          
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE HIERCHY_STYLES_CSR CURSOR WITH HOLD FOR                    
                SELECT SUB_CL_MDSEAR_ID                                         
                     , VS_ID                                                    
                     , DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
                     , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
                  FROM TMDARVS                                                  
                 WHERE ACTV_IND         = 'Y'                                   
                   AND RPT_HIER_SEQ_NBR = :PV-CHARTC-CHG-SEQ-NBR                
              ORDER BY DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC FUNCTION           
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE FUNCTN_STYLES_CSR CURSOR WITH HOLD FOR                     
                SELECT SUB_CL_MDSEAR_ID                                         
                     , VS_ID                                                    
                     , DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
                     , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
                  FROM TMDARVS                                                  
                 WHERE ACTV_IND     = 'Y'                                       
                   AND FUNC_SEQ_NBR = :PV-CHARTC-CHG-SEQ-NBR                    
              ORDER BY DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC SILHOUETTE         
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE SILHTT_STYLES_CSR CURSOR WITH HOLD FOR                     
                SELECT SUB_CL_MDSEAR_ID                                         
                     , VS_ID                                                    
                     , DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
                     , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
                  FROM TMDARVS                                                  
                 WHERE ACTV_IND      = 'Y'                                      
                   AND SLHTT_SEQ_NBR = :PV-CHARTC-CHG-SEQ-NBR                   
              ORDER BY DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC BODY STYLE         
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE BODYSTY_STYLES_CSR CURSOR WITH HOLD FOR                    
                SELECT SUB_CL_MDSEAR_ID                                         
                     , VS_ID                                                    
                     , DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
                     , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
                  FROM TMDARVS                                                  
                 WHERE ACTV_IND         = 'Y'                                   
                   AND BDY_STYL_SEQ_NBR = :PV-CHARTC-CHG-SEQ-NBR                
              ORDER BY DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC GENDER             
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE GENDER_STYLES_CSR CURSOR WITH HOLD FOR                     
                SELECT SUB_CL_MDSEAR_ID                                         
                     , VS_ID                                                    
                     , DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
                     , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
                  FROM TMDARVS                                                  
                 WHERE ACTV_IND     = 'Y'                                       
                   AND GNDR_SEQ_NBR = :PV-CHARTC-CHG-SEQ-NBR                    
              ORDER BY DEPT_NBR                                                 
                     , MAJ_CL_NBR                                               
                     , SUB_CL_NBR                                               
                     , LBL_SEQ_NBR                                              
                     , RPT_HIER_SEQ_NBR                                         
                     , BDY_STYL_SEQ_NBR                                         
                     , SLHTT_SEQ_NBR                                            
                     , FUNC_SEQ_NBR                                             
                     , GNDR_SEQ_NBR                                             
                     , FBRCN_SEQ_NBR                                            
                     , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
           END-EXEC.                                                            
                                                                                
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC CTG                
W35681******************************************************************        
W35681     EXEC SQL                                                             
W35681       DECLARE CTG_CSR    CURSOR WITH HOLD FOR                            
W35681          SELECT SUB_CL_MDSEAR_ID                                         
W35681               , VS_ID                                                    
W35681               , DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681            FROM TMDARVS                                                  
W35681           WHERE ACTV_IND     = 'Y'                                       
W35681             AND CTG_SEQ_NBR                                              
W35681                              = :PV-CHARTC-CHG-SEQ-NBR                    
W35681        ORDER BY DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681     END-EXEC.                                                            
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC MAJ_CTG            
W35681******************************************************************        
W35681     EXEC SQL                                                             
W35681       DECLARE MAJ_CTG_CSR    CURSOR WITH HOLD FOR                        
W35681          SELECT SUB_CL_MDSEAR_ID                                         
W35681               , VS_ID                                                    
W35681               , DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681            FROM TMDARVS                                                  
W35681           WHERE ACTV_IND     = 'Y'                                       
W35681             AND MAJ_CTG_SEQ_NBR                                          
W35681                              = :PV-CHARTC-CHG-SEQ-NBR                    
W35681        ORDER BY DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681     END-EXEC.                                                            
W35681                                                                          
W35681******************************************************************        
W35681*  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC MTRL               
W35681******************************************************************        
W35681     EXEC SQL                                                             
W35681       DECLARE MTRL_CSR    CURSOR WITH HOLD FOR                           
W35681          SELECT SUB_CL_MDSEAR_ID                                         
W35681               , VS_ID                                                    
W35681               , DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681            FROM TMDARVS                                                  
W35681           WHERE ACTV_IND     = 'Y'                                       
W35681             AND MTRL_SEQ_NBR                                             
W35681                              = :PV-CHARTC-CHG-SEQ-NBR                    
W35681        ORDER BY DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681     END-EXEC.                                                            
W35681                                                                          
W35681******************************************************************        
W35681*  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC ATTR-1             
W35681******************************************************************        
W35681     EXEC SQL                                                             
W35681       DECLARE ATTR_1_CSR    CURSOR WITH HOLD FOR                         
W35681          SELECT SUB_CL_MDSEAR_ID                                         
W35681               , VS_ID                                                    
W35681               , DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681            FROM TMDARVS                                                  
W35681           WHERE ACTV_IND     = 'Y'                                       
W35681             AND ATTR_1_SEQ_NBR                                           
W35681                              = :PV-CHARTC-CHG-SEQ-NBR                    
W35681        ORDER BY DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681     END-EXEC.                                                            
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC ATTR-2             
W35681******************************************************************        
W35681     EXEC SQL                                                             
W35681       DECLARE ATTR_2_CSR    CURSOR WITH HOLD FOR                         
W35681          SELECT SUB_CL_MDSEAR_ID                                         
W35681               , VS_ID                                                    
W35681               , DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681            FROM TMDARVS                                                  
W35681           WHERE ACTV_IND     = 'Y'                                       
W35681             AND ATTR_2_SEQ_NBR                                           
W35681                              = :PV-CHARTC-CHG-SEQ-NBR                    
W35681        ORDER BY DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681     END-EXEC.                                                            
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CURSOR TO RETRIEVE ALL STYLES CONTAINING A SPECIFIC NW-SLHTT           
W35681******************************************************************        
W35681     EXEC SQL                                                             
W35681       DECLARE NW_SILH_CSR    CURSOR WITH HOLD FOR                        
W35681          SELECT SUB_CL_MDSEAR_ID                                         
W35681               , VS_ID                                                    
W35681               , DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CUST_INTFC_DESC                                          
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , PRIM_TRND_SEQ_NBR                                        
W35681               , SEC_TRND_SEQ_NBR                                         
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681            FROM TMDARVS                                                  
W35681           WHERE ACTV_IND     = 'Y'                                       
W35681             AND NW_SLHTT_SEQ_NBR                                         
W35681                              = :PV-CHARTC-CHG-SEQ-NBR                    
W35681        ORDER BY DEPT_NBR                                                 
W35681               , MAJ_CL_NBR                                               
W35681               , SUB_CL_NBR                                               
W35681               , LBL_SEQ_NBR                                              
W35681               , RPT_HIER_SEQ_NBR                                         
W35681               , BDY_STYL_SEQ_NBR                                         
W35681               , SLHTT_SEQ_NBR                                            
W35681               , FUNC_SEQ_NBR                                             
W35681               , GNDR_SEQ_NBR                                             
W35681               , FBRCN_SEQ_NBR                                            
W35681               , PATRN_SEQ_NBR                                            
W35681               , CTG_SEQ_NBR                                              
W35681               , MAJ_CTG_SEQ_NBR                                          
W35681               , MTRL_SEQ_NBR                                             
W35681               , ATTR_1_SEQ_NBR                                           
W35681               , ATTR_2_SEQ_NBR                                           
W35681               , NW_SLHTT_SEQ_NBR                                         
W35681     END-EXEC.                                                            
W35681                                                                          
      ******************************************************************        
      *  CURSOR TO RETRIEVE THE CUSTOMER INTERFACE DESCRIPTION BUSINESS         
      *  RULE FOR A SPECIFIC DEPARTMENT, MAJOR CLASS, OR SUBCLASS               
      *  WITHIN THE DEPARTMENT.                                                 
      ******************************************************************        
           EXEC SQL                                                             
             DECLARE BUS_RULE_CSR CURSOR WITH HOLD FOR                          
               SELECT B.MDSELV_CDE                                              
                    , B.MAJ_CL_NBR                                              
                    , B.SUB_CL_NBR                                              
                    , A.POS1_VS_CHARTC_CDE                                      
                    , A.POS2_VS_CHARTC_CDE                                      
                    , A.POS3_VS_CHARTC_CDE                                      
                 FROM IMT_CHARTC_RULDESC A                                      
                    , TMDSEAR B                                                 
                WHERE B.DEPT_NBR = :MDSEAR-DEPT-NBR                             
                  AND A.MDSEAR_ID = B.MDSEAR_DKEY                               
                  AND (B.MDSELV_CDE = 'DPT'                                     
                       OR B.MDSELV_CDE = 'MCL'                                  
                       OR B.MDSELV_CDE = 'SCL')                                 
                  AND CURRENT DATE BETWEEN B.STRT_DTE AND B.END_DTE             
             ORDER BY B.MDSELV_CDE DESC                                         
                    , B.MAJ_CL_NBR ASC                                          
                    , B.SUB_CL_NBR ASC                                          
           END-EXEC.                                                            
                                                                                
                                                                                
       LINKAGE SECTION.                                                         
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
                                                                                
      ******************************************************************        
      * MAINLINE.                                                               
      ******************************************************************        
       0000-MAINLINE.                                                           
                                                                                
           PERFORM 1000-INITIALIZATION.                                         
                                                                                
           PERFORM 2000-PROCESS-CHARTC-CHGS                                     
               UNTIL PS-END-OF-CHARTC-CHG-CSR.                                  
                                                                                
           PERFORM 9000-EOJ-ROUTINE.                                            
                                                                                
           IF PS-NO-ERROR-FOUND                                                 
               MOVE +0    TO RETURN-CODE                                        
           ELSE                                                                 
               MOVE +4095 TO RETURN-CODE                                        
           END-IF.                                                              
                                                                                
           GOBACK.                                                              
                                                                                
      ******************************************************************        
      * INITIALIZATION                                                          
      ******************************************************************        
                                                                                
       1000-INITIALIZATION.                                                     
                                                                                
           OPEN OUTPUT CHARACTR-CHGS-BKUP-FILE.                                 
           MOVE SPACES TO PV-PREV-BUSGP-DEPT.                                   
                                                                                
           PERFORM 7300-GET-COMMIT-TIMESTAMP.                                   
           DISPLAY 'COMMITS WILL BE TAKEN EVERY ',                              
                TCKRSTCNTL-CKPT-FRQNCY-QTY, ' SECONDS.'.                        
                                                                                
           PERFORM 5000-OPEN-CHARTC-CHG-CSR.                                    
           PERFORM 5010-FETCH-CHARTC-CHG-CSR.                                   
                                                                                
                                                                                
      ******************************************************************        
      *  FOR EACH CHARACTERISTIC CHANGES CURSOR ROW, FIND ALL OF THE            
      *  IMPACTED STYLES AND UPDATE THE CUSTOMER INTERFACE DESCRIPTION.         
      ******************************************************************        
       2000-PROCESS-CHARTC-CHGS.                                                
                                                                                
           DISPLAY 'PROCESSING IMT_CHARTC_CHG CDE: ' IMT00023-CHARTC-CDE        
                   ', SEQ NBR: '   IMT00023-CHARTC-SEQ-NBR                      
                   ', SHRT DESC: ' IMT00023-CHARTC-SHRT-DESC                    
                   ', OLD SHRT DESC: '                                          
                                   IMT00023-OLD-CHARSHRT-DESC.                  
                                                                                
           MOVE SPACES TO PV-BUSRULE-MISSING-DEPT.                              
                                                                                
           MOVE IMT00023-CHARTC-CDE     TO PV-CHARTC-CHG-CDE.                   
           MOVE IMT00023-CHARTC-SEQ-NBR TO PV-CHARTC-CHG-SEQ-NBR.               
           MOVE 'N' TO PS-END-OF-STYLE-CSR-SW.                                  
                                                                                
           EVALUATE TRUE                                                        
               WHEN PV-CHARTC-CHG-FABRICATION                                   
                   PERFORM 6000-OPEN-FABRICTN-STYLES-CSR                        
                   PERFORM 6010-FETCH-FABRICTN-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-BRAND                                         
                   PERFORM 6100-OPEN-BRAND-STYLES-CSR                           
                   PERFORM 6110-FETCH-BRAND-STYLES-CSR                          
               WHEN PV-CHARTC-CHG-PATTERN                                       
                   PERFORM 6200-OPEN-PATTERN-STYLES-CSR                         
                   PERFORM 6210-FETCH-PATTERN-STYLES-CSR                        
               WHEN PV-CHARTC-CHG-HIERARCHY                                     
                   PERFORM 6300-OPEN-HIERACHY-STYLES-CSR                        
                   PERFORM 6310-FETCH-HIERACHY-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-FUNCTION                                      
                   PERFORM 6400-OPEN-FUNCTION-STYLES-CSR                        
                   PERFORM 6410-FETCH-FUNCTION-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-SILHOUETTE                                    
                   PERFORM 6500-OPEN-SILHOUET-STYLES-CSR                        
                   PERFORM 6510-FETCH-SILHOUET-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-BODYSTYLE                                     
                   PERFORM 6600-OPEN-BODYSTYL-STYLES-CSR                        
                   PERFORM 6610-FETCH-BODYSTYL-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-GENDER                                        
                   PERFORM 6700-OPEN-GENDER-STYLES-CSR                          
                   PERFORM 6710-FETCH-GENDER-STYLES-CSR                         
W35681         WHEN PV-CHARTC-CHG-CTG                                           
W35681             PERFORM 6810-OPEN-CTG-CSR                                    
W35681             PERFORM 6815-FETCH-CTG-CSR                                   
W35681         WHEN PV-CHARTC-CHG-MAJ-CTG                                       
W35681             PERFORM 6820-OPEN-MAJ-CTG-CSR                                
W35681             PERFORM 6825-FETCH-MAJ-CTG-CSR                               
W35681         WHEN PV-CHARTC-CHG-NW-SILH                                       
W35681             PERFORM 6830-OPEN-NW-SILH-CSR                                
W35681             PERFORM 6835-FETCH-NW-SILH-CSR                               
W35681         WHEN PV-CHARTC-CHG-MTRL                                          
W35681             PERFORM 6840-OPEN-MTRL-CSR                                   
W35681             PERFORM 6845-FETCH-MTRL-CSR                                  
W35681         WHEN PV-CHARTC-CHG-ATTR-1                                        
W35681             PERFORM 6870-OPEN-ATTR-1-CSR                                 
W35681             PERFORM 6875-FETCH-ATTR-1-CSR                                
W35681         WHEN PV-CHARTC-CHG-ATTR-2                                        
W35681             PERFORM 6880-OPEN-ATTR-2-CSR                                 
W35681             PERFORM 6885-FETCH-ATTR-2-CSR                                
               WHEN OTHER                                                       
                   DISPLAY 'INVALID CHARACTERISTIC CHANGE CODE: '               
                         PV-CHARTC-CHG-CDE                                      
                   DISPLAY 'IMT_CHARTC_CHG CDE: ' IMT00023-CHARTC-CDE           
                           ', SEQ NBR: '   IMT00023-CHARTC-SEQ-NBR              
                           ', SHRT DESC: ' IMT00023-CHARTC-SHRT-DESC            
                           ', OLD SHRT DESC: '                                  
                                           IMT00023-OLD-CHARSHRT-DESC           
                   SET PS-ERROR-FOUND TO TRUE                                   
                   SET PS-END-OF-STYLE-CSR TO TRUE                              
           END-EVALUATE.                                                        
                                                                                
           PERFORM 2100-PROCESS-STYLES                                          
               UNTIL PS-END-OF-STYLE-CSR.                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN PV-CHARTC-CHG-FABRICATION                                   
                   PERFORM 6020-CLOSE-FABRICTN-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-BRAND                                         
                   PERFORM 6120-CLOSE-BRAND-STYLES-CSR                          
               WHEN PV-CHARTC-CHG-PATTERN                                       
                   PERFORM 6220-CLOSE-PATTERN-STYLES-CSR                        
               WHEN PV-CHARTC-CHG-HIERARCHY                                     
                   PERFORM 6320-CLOSE-HIERACHY-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-FUNCTION                                      
                   PERFORM 6420-CLOSE-FUNCTION-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-SILHOUETTE                                    
                   PERFORM 6520-CLOSE-SILHOUET-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-BODYSTYLE                                     
                   PERFORM 6620-CLOSE-BODYSTYL-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-GENDER                                        
                   PERFORM 6720-CLOSE-GENDER-STYLES-CSR                         
W35681         WHEN PV-CHARTC-CHG-CTG                                           
W35681             PERFORM 6816-CLOSE-CTG-CSR                                   
W35681         WHEN PV-CHARTC-CHG-MAJ-CTG                                       
W35681             PERFORM 6826-CLOSE-MAJ-CTG-CSR                               
W35681         WHEN PV-CHARTC-CHG-NW-SILH                                       
W35681             PERFORM 6836-CLOSE-NW-SILH-CSR                               
W35681         WHEN PV-CHARTC-CHG-MTRL                                          
W35681             PERFORM 6846-CLOSE-MTRL-CSR                                  
W35681         WHEN PV-CHARTC-CHG-ATTR-1                                        
W35681             PERFORM 6876-CLOSE-ATTR-1-CSR                                
W35681         WHEN PV-CHARTC-CHG-ATTR-2                                        
W35681             PERFORM 6886-CLOSE-ATTR-2-CSR                                
               WHEN OTHER                                                       
                   CONTINUE                                                     
           END-EVALUATE.                                                        
                                                                                
           PERFORM 5800-DELETE-CHARTC-CHG.                                      
           PERFORM 4000-WRITE-CHARACTR-CHGS-REC.                                
           PERFORM 7700-COMMIT-PROCESSING.                                      
                                                                                
           PERFORM 5010-FETCH-CHARTC-CHG-CSR.                                   
                                                                                
      ******************************************************************        
      *  BUILD THE NEW CUSTOMER INTERFACE DESCRIPTION FOR EACH STYLE            
      *  IMPACTED BY THE CHARACTERISTIC CHANGE, AND UPDATE THE CUSTOMER         
      *  INTERFACE DESCRIPTION IN TABLE TMDARVS.                                
      ******************************************************************        
       2100-PROCESS-STYLES.                                                     
                                                                                
           IF (PS-DEPT-LVL-RULE                                                 
               AND MDARVS-DEPT-NBR = PV-PREV-DEPT-NBR)                          
             OR (PS-MCL-LVL-RULE                                                
                 AND MDARVS-DEPT-NBR = PV-PREV-DEPT-NBR                         
                 AND MDARVS-MAJ-CL-NBR = PV-PREV-MAJ-CL-NBR)                    
             OR (PS-SCL-LVL-RULE                                                
                 AND MDARVS-DEPT-NBR = PV-PREV-DEPT-NBR                         
                 AND MDARVS-MAJ-CL-NBR = PV-PREV-MAJ-CL-NBR                     
                 AND MDARVS-SUB-CL-NBR = PV-PREV-SUB-CL-NBR)                    
      ****     THIS STYLE IS USING THE SAME BUSINESS RULE AS THE LAST           
      ****     STYLE                                                            
               CONTINUE                                                         
           ELSE                                                                 
               PERFORM 2110-GET-BUSINESS-RULE                                   
           END-IF.                                                              
                                                                                
           IF  MDARVS-LBL-SEQ-NBR      = PV-PREV-LBL-SEQ-NBR                    
           AND MDARVS-RPT-HIER-SEQ-NBR = PV-PREV-RPT-HIER-SEQ-NBR               
           AND MDARVS-BDY-STYL-SEQ-NBR = PV-PREV-BDY-STYL-SEQ-NBR               
           AND MDARVS-SLHTT-SEQ-NBR    = PV-PREV-SLHTT-SEQ-NBR                  
           AND MDARVS-FUNC-SEQ-NBR     = PV-PREV-FUNC-SEQ-NBR                   
           AND MDARVS-GNDR-SEQ-NBR     = PV-PREV-GNDR-SEQ-NBR                   
           AND MDARVS-FBRCN-SEQ-NBR    = PV-PREV-FBRCN-SEQ-NBR                  
           AND MDARVS-PATRN-SEQ-NBR    = PV-PREV-PATRN-SEQ-NBR                  
W35681     AND MDARVS-CTG-SEQ-NBR      = PV-PREV-CTG-SEQ-NBR                    
W35681     AND MDARVS-MAJ-CTG-SEQ-NBR  = PV-PREV-MAJ-CTG-SEQ-NBR                
W35681     AND MDARVS-MTRL-SEQ-NBR     = PV-PREV-MTRL-SEQ-NBR                   
W35681     AND MDARVS-ATTR-1-SEQ-NBR   = PV-PREV-ATTR-1-SEQ-NBR                 
W35681     AND MDARVS-ATTR-2-SEQ-NBR   = PV-PREV-ATTR-2-SEQ-NBR                 
W35681     AND MDARVS-NW-SLHTT-SEQ-NBR = PV-PREV-NW-SLHTT-SEQ-NBR               
      ****     IF ALL OF THE ATTRIBUTES ARE THE SAME, USE THE SAME              
      ****     CUSTOMER INTERFACE DESCRIPTION THAT WAS JUST BUILT               
               CONTINUE                                                         
           ELSE                                                                 
W35681         MOVE 'N' TO PS-BRAND-CTG-HIER-DFLT-FND-SW                        
               IF PS-BUS-RULE-FOUND                                             
                   PERFORM 2140-BUILD-CUST-DESC                                 
               ELSE                                                             
      ****         IF NO BUSINESS RULE FOUND AND THIS IS A BRAND OR             
W35861****         OR CATAGORY OR                                               
      ****         HIERARCHY ATTRIBUTE CHANGE, DETERMINE IF THE STYLE           
W35861****         CAN USE THE BRAND/CATAGORY DEFAULT OR                        
W35861****         THE BRAND/HIERARCHY DEFAULT                                  
W35681             IF ((PV-CHARTC-CHG-BRAND                                     
W38681                 OR PV-CHARTC-CHG-HIERARCHY)                              
W35681                       AND (MDARVS-LBL-SEQ-NBR > 0                        
W35681                       AND MDARVS-RPT-HIER-SEQ-NBR > 0))                  
W35681                                OR                                        
W35681                ((PV-CHARTC-CHG-BRAND                                     
W35681                 OR PV-CHARTC-CHG-CTG)                                    
W35681                       AND (MDARVS-LBL-SEQ-NBR > 0                        
W35681                       AND MDARVS-CTG-SEQ-NBR > 0))                       
W35681                    PERFORM 2300-PROCESS-NO-RULES-STYLE                   
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF PV-CUST-DESC-EDITED NOT = MDARVS-CUST-INTFC-DESC                  
             AND (PS-BUS-RULE-FOUND                                             
W35861            OR PS-BRAND-CTG-HIER-DFLT-FND)                                
               PERFORM 5500-UPDATE-CUST-DESC                                    
               PERFORM 7700-COMMIT-PROCESSING                                   
           END-IF.                                                              
                                                                                
           MOVE MDARVS-DEPT-NBR         TO PV-PREV-DEPT-NBR.                    
           MOVE MDARVS-MAJ-CL-NBR       TO PV-PREV-MAJ-CL-NBR.                  
           MOVE MDARVS-SUB-CL-NBR       TO PV-PREV-SUB-CL-NBR.                  
           MOVE MDARVS-LBL-SEQ-NBR      TO PV-PREV-LBL-SEQ-NBR.                 
           MOVE MDARVS-RPT-HIER-SEQ-NBR TO PV-PREV-RPT-HIER-SEQ-NBR.            
           MOVE MDARVS-BDY-STYL-SEQ-NBR TO PV-PREV-BDY-STYL-SEQ-NBR.            
           MOVE MDARVS-SLHTT-SEQ-NBR    TO PV-PREV-SLHTT-SEQ-NBR.               
           MOVE MDARVS-FUNC-SEQ-NBR     TO PV-PREV-FUNC-SEQ-NBR.                
           MOVE MDARVS-GNDR-SEQ-NBR     TO PV-PREV-GNDR-SEQ-NBR.                
           MOVE MDARVS-FBRCN-SEQ-NBR    TO PV-PREV-FBRCN-SEQ-NBR.               
           MOVE MDARVS-PATRN-SEQ-NBR    TO PV-PREV-PATRN-SEQ-NBR.               
W35681     MOVE MDARVS-CTG-SEQ-NBR      TO PV-PREV-CTG-SEQ-NBR.                 
W35681     MOVE MDARVS-MAJ-CTG-SEQ-NBR  TO PV-PREV-MAJ-CTG-SEQ-NBR.             
W35681     MOVE MDARVS-MTRL-SEQ-NBR     TO PV-PREV-MTRL-SEQ-NBR.                
W35681     MOVE MDARVS-ATTR-1-SEQ-NBR   TO PV-PREV-ATTR-1-SEQ-NBR.              
W35681     MOVE MDARVS-ATTR-2-SEQ-NBR   TO PV-PREV-ATTR-2-SEQ-NBR.              
W35681     MOVE MDARVS-NW-SLHTT-SEQ-NBR TO PV-PREV-NW-SLHTT-SEQ-NBR.            
                                                                                
           EVALUATE TRUE                                                        
               WHEN PV-CHARTC-CHG-FABRICATION                                   
                   PERFORM 6010-FETCH-FABRICTN-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-BRAND                                         
                   PERFORM 6110-FETCH-BRAND-STYLES-CSR                          
               WHEN PV-CHARTC-CHG-PATTERN                                       
                   PERFORM 6210-FETCH-PATTERN-STYLES-CSR                        
               WHEN PV-CHARTC-CHG-HIERARCHY                                     
                   PERFORM 6310-FETCH-HIERACHY-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-FUNCTION                                      
                   PERFORM 6410-FETCH-FUNCTION-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-SILHOUETTE                                    
                   PERFORM 6510-FETCH-SILHOUET-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-BODYSTYLE                                     
                   PERFORM 6610-FETCH-BODYSTYL-STYLES-CSR                       
               WHEN PV-CHARTC-CHG-GENDER                                        
                   PERFORM 6710-FETCH-GENDER-STYLES-CSR                         
W35681         WHEN PV-CHARTC-CHG-CTG                                           
W35681             PERFORM 6815-FETCH-CTG-CSR                                   
W35681         WHEN PV-CHARTC-CHG-MAJ-CTG                                       
W35681             PERFORM 6825-FETCH-MAJ-CTG-CSR                               
W35681         WHEN PV-CHARTC-CHG-NW-SILH                                       
W35681             PERFORM 6835-FETCH-NW-SILH-CSR                               
W35681         WHEN PV-CHARTC-CHG-MTRL                                          
W35681             PERFORM 6845-FETCH-MTRL-CSR                                  
W35681         WHEN PV-CHARTC-CHG-ATTR-1                                        
W35681             PERFORM 6875-FETCH-ATTR-1-CSR                                
W35681         WHEN PV-CHARTC-CHG-ATTR-2                                        
W35681             PERFORM 6885-FETCH-ATTR-2-CSR                                
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      *  GET THE BUSINESS RULE IN TABLE IMT_CHARTC_RULDESC FOR THE              
      *  IMPACTED STYLE.                                                        
      ******************************************************************        
       2110-GET-BUSINESS-RULE.                                                  
                                                                                
           MOVE +0  TO PV-PREV-LBL-SEQ-NBR                                      
                       PV-PREV-RPT-HIER-SEQ-NBR                                 
                       PV-PREV-BDY-STYL-SEQ-NBR                                 
                       PV-PREV-SLHTT-SEQ-NBR                                    
                       PV-PREV-FUNC-SEQ-NBR                                     
                       PV-PREV-GNDR-SEQ-NBR                                     
                       PV-PREV-FBRCN-SEQ-NBR                                    
                       PV-PREV-PATRN-SEQ-NBR                                    
W35681                 PV-PREV-CTG-SEQ-NBR                                      
W35681                 PV-PREV-MAJ-CTG-SEQ-NBR                                  
W35681                 PV-PREV-MTRL-SEQ-NBR                                     
W35681                 PV-PREV-ATTR-1-SEQ-NBR                                   
W35681                 PV-PREV-ATTR-2-SEQ-NBR                                   
W35681                 PV-PREV-NW-SLHTT-SEQ-NBR.                                
           MOVE SPACES TO PV-PREV-BUSGP-DEPT.                                   
           MOVE SPACE  TO PS-BUS-RULE-LVL-SW.                                   
                                                                                
           MOVE MDARVS-DEPT-NBR   TO PV-CURR-DEPT-9.                            
           MOVE PV-CURR-DEPT      TO MDSEAR-DEPT-NBR.                           
           SET PS-NOT-END-OF-BUS-RULE-CSR TO TRUE.                              
                                                                                
           PERFORM 5100-OPEN-BUS-RULE-CSR.                                      
           PERFORM 5110-FETCH-BUS-RULE-CSR.                                     
                                                                                
           IF PS-NOT-END-OF-BUS-RULE-CSR                                        
               IF MDSEAR-MDSELV-CDE = 'SCL'                                     
      *            ALL STYLES IN THIS DEPARTMENT MUST CHECK FOR A SUB           
      *            CLASS BUSINESS RULE                                          
                   SET PS-SCL-LVL-RULE TO TRUE                                  
                   MOVE MDARVS-SUB-CL-NBR TO PV-CURR-SCL-9                      
                   MOVE MDARVS-MAJ-CL-NBR TO PV-CURR-MCL-9                      
                   PERFORM 5110-FETCH-BUS-RULE-CSR                              
                       UNTIL MDSEAR-MDSELV-CDE = 'DPT'                          
                          OR (MDSEAR-MDSELV-CDE = 'MCL'                         
                              AND MDSEAR-MAJ-CL-NBR = PV-CURR-MCL)              
                          OR (MDSEAR-MDSELV-CDE = 'SCL'                         
                              AND MDSEAR-SUB-CL-NBR = PV-CURR-SCL)              
                          OR PS-END-OF-BUS-RULE-CSR                             
               ELSE                                                             
                   IF MDSEAR-MDSELV-CDE = 'MCL'                                 
      *                ALL STYLES IN THIS DEPARTMENT MUST CHECK FOR A           
      *                MAJOR CLASS BUSINESS RULE                                
                       SET PS-MCL-LVL-RULE TO TRUE                              
                       MOVE MDARVS-MAJ-CL-NBR TO PV-CURR-MCL-9                  
                       PERFORM 5110-FETCH-BUS-RULE-CSR                          
                           UNTIL MDSEAR-MDSELV-CDE = 'DPT'                      
                              OR (MDSEAR-MDSELV-CDE = 'MCL'                     
                                  AND MDSEAR-MAJ-CL-NBR = PV-CURR-MCL)          
                              OR PS-END-OF-BUS-RULE-CSR                         
                   ELSE                                                         
                       IF MDSEAR-MDSELV-CDE = 'DPT'                             
      *                    ALL STYLES IN THIS DEPARTMENT CAN USE THE            
      *                    SAME BUSINESS RULE                                   
                           SET PS-DEPT-LVL-RULE TO TRUE                         
                       END-IF                                                   
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
           PERFORM 5120-CLOSE-BUS-RULE-CSR.                                     
                                                                                
           IF PS-NOT-END-OF-BUS-RULE-CSR                                        
               SET PS-BUS-RULE-FOUND TO TRUE                                    
               DISPLAY 'PROCESSING BUSINESS RULE FOR DEPT: '                    
                     MDSEAR-DEPT-NBR                                            
                       ' MAJOR CLASS: ' MDSEAR-MAJ-CL-NBR                       
                       ' SUB CLASS: ' MDSEAR-SUB-CL-NBR                         
                       ' AT BUSINESS LEVEL: ' PS-BUS-RULE-LVL-SW                
           ELSE                                                                 
               SET PS-BUS-RULE-NOT-FOUND TO TRUE                                
               SET PS-DEPT-LVL-RULE TO TRUE                                     
               IF MDSEAR-DEPT-NBR NOT = PV-BUSRULE-MISSING-DEPT                 
                   DISPLAY 'PROCESSING NO BUSINESS RULE DEPARTMENT: '           
                         MDSEAR-DEPT-NBR                                        
                   MOVE MDSEAR-DEPT-NBR TO PV-BUSRULE-MISSING-DEPT              
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  BUILD THE 26-CHARACTER CUSTOMER INTERFACE DESCRIPTION                  
      ******************************************************************        
       2140-BUILD-CUST-DESC.                                                    
                                                                                
           MOVE SPACES TO  PV-CUST-DESC                                         
                           PV-CUST-DESC-PART-1                                  
                           PV-CUST-DESC-PART-2                                  
                           PV-CUST-DESC-PART-3                                  
                           PV-CUST-DESC-DFLT-BRND                               
W35681                     PV-CUST-DESC-DFLT-HIER                               
W35681                     PV-CUST-DESC-DFLT-CTG.                               
           MOVE ZERO   TO  PV-NBR-BLANK-ATTRS.                                  
           MOVE 'N'    TO  PS-DFLT-BRND-IS-BLANK-SW                             
W35681                     PS-DFLT-HIER-IS-BLANK-SW                             
W35681                     PS-DFLT-CTG-IS-BLANK-SW.                             
                                                                                
           PERFORM 2141-GET-CUST-DESC-PART-1.                                   
           PERFORM 2142-GET-CUST-DESC-PART-2.                                   
                                                                                
W35681***  IF TWO OF THREE PARTS OF THE CUST DESC ARE                           
W35681***  BLANK AND NEITHER OF THEM IS BRAND OR CATEGORY                       
W35681***  TRY TO USE BRAND + CATEGORY DEFAULT                                  
W35681***  AS THE DEFAULT DESCRIPTION.                                          
W35681***  IF TWO OF THREE PARTS OF THE CUST DESC ARE                           
W35681***  BLANK AND NEITHER OF THEM IS BRAND OR HIERARCHY                      
W35681***  TRY TO USE BRAND + HIERARCHY DEFAULT                                 
W35681***  AS THE DEFAULT DESCRIPTION .                                         
W35681***  IF THAT DOESN'T WORK, DEFAULT TO                                     
W35681***  BUSINESS GROUP AS THE DEFAULT DESCRIPTION                            
W35681                                                                          
W35681     IF  PV-NBR-BLANK-ATTRS = 2                                           
W35681         PERFORM 2160-APPLY-DEFAULTS                                      
W35681     ELSE                                                                 
W35681***      IF AT LEAST ONE OF THE FIRST TWO PARTS OF THE CUST DESC          
W35681***      IS NOT BLANK, GO AHEAD AND RETRIEVE THE THIRD PART               
W35681         PERFORM 2143-GET-CUST-DESC-PART-3                                
W35681         IF  PV-NBR-BLANK-ATTRS = 2                                       
W35681             PERFORM 2160-APPLY-DEFAULTS                                  
W35681         END-IF                                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681     PERFORM 2150-EDIT-CUST-DESC.                                         
W35681                                                                          
W35681************************************************************              
W35681*     ALL OF THE COMMENTED OUT CODE BELOW WAS REPLACED     *              
W35681*     BY THE LOGIC ABOVE AND THE PERFORMED ROUTINES        *              
W35681************************************************************              
      **********************************************************                
      ***  IF TWO OF THREE PARTS OF THE CUST DESC ARE                           
      ***  BLANK AND ONE OF THEM IS BRAND OR HIERARCHY,                         
      ***  USE BUSINESS GROUP AS THE DEFAULT DESCRIPTION                        
      ***                                                                       
      ***  IF TWO OF THREE PARTS OF THE CUST DESC ARE BLANK                     
      ***  AND NEITHER OF THEM IS BRAND OR HIERARCHY, USE THE                   
      ***  DEFAULT RULE OF BRAND + HIERARCHY                                    
      ***                                                                       
      ***  IF  PV-NBR-BLANK-ATTRS = 2                                           
      ***      IF  PS-DFLT-BRND-IS-BLANK                                        
      ***      OR  PS-DFLT-HIER-IS-BLANK                                        
      ***          PERFORM 2165-DEFAULT-BUS-GRP                                 
      ***      ELSE                                                             
      ***          PERFORM 2160-DEFAULT-BRND-HIER                               
      ***      END-IF                                                           
      ***  ELSE                                                                 
      ***      IF AT LEAST ONE OF THE FIRST TWO PARTS OF THE CUST DESC          
      ***      IS NOT BLANK, GO AHEAD AND RETRIEVE THE THIRD PART               
      ***      PERFORM 2143-GET-CUST-DESC-PART-3                                
      ***      IF  PV-NBR-BLANK-ATTRS = 2                                       
      ***          IF  PS-DFLT-BRND-IS-BLANK                                    
      ***          OR  PS-DFLT-HIER-IS-BLANK                                    
      ***              PERFORM 2165-DEFAULT-BUS-GRP                             
      ***          ELSE                                                         
      ***              PERFORM 2160-DEFAULT-BRND-HIER                           
      ***          END-IF                                                       
      ***      END-IF                                                           
      ***  END-IF.                                                              
                                                                                
W35681*****PERFORM 2150-EDIT-CUST-DESC.                                         
                                                                                
                                                                                
      ******************************************************************        
      *  GET THE FIRST OF THREE 8-CHAR SHORT DESCRIPTIONS THAT WILL             
      *  BE USED TO BUILD THE CUSTOMER INTERFACE DESCRIPTION.                   
      ******************************************************************        
       2141-GET-CUST-DESC-PART-1.                                               
                                                                                
           MOVE IMT00022-POS1-VS-CHARTC-CDE TO PV-CHARTC-CDE                    
                                               PV-CHARTC-CDE-TYPE.              
                                                                                
           PERFORM 2200-GET-SHORT-DESC.                                         
                                                                                
           MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-1.                           
                                                                                
           IF  PV-CUST-DESC-PART-1 = SPACES                                     
               ADD +1 TO PV-NBR-BLANK-ATTRS                                     
               IF  PV-ATTR-BRAND                                                
                   SET PS-DFLT-BRND-IS-BLANK TO TRUE                            
               ELSE                                                             
W35618             IF  PV-ATTR-CTG                                              
W35618                 SET PS-DFLT-CTG-IS-BLANK TO TRUE                         
W35618             ELSE                                                         
W35618                 IF  PV-ATTR-HIER                                         
W35618                     SET PS-DFLT-HIER-IS-BLANK TO TRUE                    
W35618                 END-IF                                                   
W35618             END-IF                                                       
W35618         END-IF                                                           
           ELSE                                                                 
               IF  PV-ATTR-BRAND                                                
                   MOVE PV-CUST-DESC-PART-1 TO PV-CUST-DESC-DFLT-BRND           
               ELSE                                                             
W35618             IF  PV-ATTR-CTG                                              
W35618                 MOVE PV-CUST-DESC-PART-1                                 
W35618                                      TO PV-CUST-DESC-DFLT-CTG            
W35618             ELSE                                                         
W35618                 IF  PV-ATTR-HIER                                         
W35618                     MOVE PV-CUST-DESC-PART-1                             
W35618                                      TO PV-CUST-DESC-DFLT-HIER           
W35618                 END-IF                                                   
W35618             END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  GET THE SECOND OF THREE 8-CHAR SHORT DESCRIPTIONS THAT WILL            
      *  BE USED TO BUILD THE CUSTOMER INTERFACE DESCRIPTION.                   
      ******************************************************************        
       2142-GET-CUST-DESC-PART-2.                                               
                                                                                
           MOVE IMT00022-POS2-VS-CHARTC-CDE TO PV-CHARTC-CDE                    
                                               PV-CHARTC-CDE-TYPE.              
                                                                                
           PERFORM 2200-GET-SHORT-DESC.                                         
                                                                                
           MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-2.                           
                                                                                
           IF  PV-CUST-DESC-PART-2 = SPACES                                     
               ADD +1 TO PV-NBR-BLANK-ATTRS                                     
               IF  PV-ATTR-BRAND                                                
                   SET PS-DFLT-BRND-IS-BLANK TO TRUE                            
               ELSE                                                             
W35618             IF  PV-ATTR-CTG                                              
W35618                 SET PS-DFLT-CTG-IS-BLANK TO TRUE                         
W35618             ELSE                                                         
W35618                 IF  PV-ATTR-HIER                                         
W35618                     SET PS-DFLT-HIER-IS-BLANK TO TRUE                    
W35618                 END-IF                                                   
W35618             END-IF                                                       
W35618         END-IF                                                           
           ELSE                                                                 
               IF  PV-ATTR-BRAND                                                
                   MOVE PV-CUST-DESC-PART-2 TO PV-CUST-DESC-DFLT-BRND           
               ELSE                                                             
W35618             IF  PV-ATTR-CTG                                              
W35618                 MOVE PV-CUST-DESC-PART-2                                 
W35618                                      TO PV-CUST-DESC-DFLT-CTG            
W35618             ELSE                                                         
W35618                 IF  PV-ATTR-HIER                                         
W35618                     MOVE PV-CUST-DESC-PART-2                             
W35618                                      TO PV-CUST-DESC-DFLT-HIER           
W35618                 END-IF                                                   
W35618             END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  GET THE THIRD OF THREE 8-CHAR SHORT DESCRIPTIONS THAT WILL             
      *  BE USED TO BUILD THE CUSTOMER INTERFACE DESCRIPTION.                   
      ******************************************************************        
       2143-GET-CUST-DESC-PART-3.                                               
                                                                                
           MOVE IMT00022-POS3-VS-CHARTC-CDE TO PV-CHARTC-CDE                    
                                               PV-CHARTC-CDE-TYPE.              
                                                                                
           PERFORM 2200-GET-SHORT-DESC.                                         
                                                                                
           MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-3.                           
                                                                                
           IF  PV-CUST-DESC-PART-3 = SPACES                                     
               ADD +1 TO PV-NBR-BLANK-ATTRS                                     
               IF  PV-ATTR-BRAND                                                
                   SET PS-DFLT-BRND-IS-BLANK TO TRUE                            
               ELSE                                                             
W35618             IF  PV-ATTR-CTG                                              
W35618                 SET PS-DFLT-CTG-IS-BLANK TO TRUE                         
W35618             ELSE                                                         
W35618                 IF  PV-ATTR-HIER                                         
W35618                     SET PS-DFLT-HIER-IS-BLANK TO TRUE                    
W35618                 END-IF                                                   
W35618             END-IF                                                       
W35618         END-IF                                                           
           ELSE                                                                 
               IF  PV-ATTR-BRAND                                                
                   MOVE PV-CUST-DESC-PART-3 TO PV-CUST-DESC-DFLT-BRND           
               ELSE                                                             
W35618             IF  PV-ATTR-CTG                                              
W35618                 MOVE PV-CUST-DESC-PART-3                                 
W35618                                      TO PV-CUST-DESC-DFLT-CTG            
W35618             ELSE                                                         
W35618                 IF  PV-ATTR-HIER                                         
W35618                     MOVE PV-CUST-DESC-PART-3                             
W35618                                      TO PV-CUST-DESC-DFLT-HIER           
W35618                 END-IF                                                   
W35618             END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  EDIT THE CUSTOMER INTERFACE DESC TO REMOVE EXTRA SPACES.               
      ******************************************************************        
       2150-EDIT-CUST-DESC.                                                     
                                                                                
      **** ELIMINATE DUPLICATE SHORT DESCRIPTIONS WITHIN THE 26-CHAR            
      **** CUSTOMER INTERFACE DESCRIPTION.                                      
                                                                                
           IF  PV-CUST-DESC-PART-2 = PV-CUST-DESC-PART-3                        
               MOVE SPACES TO PV-CUST-DESC-PART-3                               
           END-IF.                                                              
                                                                                
           IF  PV-CUST-DESC-PART-1 = PV-CUST-DESC-PART-3                        
               MOVE SPACES TO PV-CUST-DESC-PART-3                               
           END-IF.                                                              
                                                                                
           IF  PV-CUST-DESC-PART-1 = PV-CUST-DESC-PART-2                        
               MOVE SPACES TO PV-CUST-DESC-PART-2                               
           END-IF.                                                              
                                                                                
      **** REFORMAT THE CUSTOMER DESCRIPTION TO ELIMINATE SPACES IN             
      **** PARTS 1 AND 2 OF THE 26-CHAR CUSTOMER INTERFACE DESCRIPTION.         
                                                                                
           IF  PV-CUST-DESC-PART-2 = SPACES                                     
               MOVE PV-CUST-DESC-PART-3 TO PV-CUST-DESC-PART-2                  
               MOVE SPACES              TO PV-CUST-DESC-PART-3                  
           END-IF.                                                              
                                                                                
           IF  PV-CUST-DESC-PART-1 = SPACES                                     
               MOVE PV-CUST-DESC-PART-2 TO PV-CUST-DESC-PART-1                  
               MOVE PV-CUST-DESC-PART-3 TO PV-CUST-DESC-PART-2                  
               MOVE SPACES              TO PV-CUST-DESC-PART-3                  
           END-IF.                                                              
                                                                                
      **** ELIMINATE EXTRA SPACES WITHIN THE 26-CHAR CUSTOMER INTERFACE         
      **** DESCRIPTION.                                                         
                                                                                
           IF PV-CUST-DESC-PART-2 = SPACES                                      
             AND PV-CUST-DESC-PART-3 = SPACES                                   
               PERFORM 2165-DEFAULT-BUS-GRP                                     
               MOVE PV-SHORT-DESC TO PV-CUST-DESC-EDITED                        
           ELSE                                                                 
               PERFORM 2155-ELIM-SPACES                                         
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  DELETE EXTRA SPACES FROM THE 26-CHAR CUSTOMER INTERFACE DESC           
      ******************************************************************        
       2155-ELIM-SPACES.                                                        
                                                                                
           INITIALIZE PV-END-SPACE-CNT                                          
                      PV-END-SPACE-CNT-1                                        
                      PV-END-SPACE-CNT-2                                        
                      PV-END-SPACE-CNT-3                                        
                      PV-CNT-TRAILING-SPACES                                    
                      PV-CUST-DESC-EDITED.                                      
                                                                                
           MOVE PV-CUST-DESC-PART-1 TO PV-CNT-TRAILING-SPACES.                  
           PERFORM 2157-COUNT-SPACES.                                           
           MOVE PV-END-SPACE-CNT    TO PV-END-SPACE-CNT-1.                      
                                                                                
           INITIALIZE PV-END-SPACE-CNT                                          
                      PV-CNT-TRAILING-SPACES.                                   
                                                                                
           MOVE PV-CUST-DESC-PART-2 TO PV-CNT-TRAILING-SPACES.                  
           PERFORM 2157-COUNT-SPACES.                                           
           MOVE PV-END-SPACE-CNT    TO PV-END-SPACE-CNT-2.                      
                                                                                
           INITIALIZE PV-END-SPACE-CNT                                          
                      PV-CNT-TRAILING-SPACES.                                   
                                                                                
           MOVE PV-CUST-DESC-PART-3 TO PV-CNT-TRAILING-SPACES.                  
           PERFORM 2157-COUNT-SPACES.                                           
           MOVE PV-END-SPACE-CNT    TO PV-END-SPACE-CNT-3.                      
                                                                                
           STRING PV-CUST-DESC-PART-1  (1 : 8 - PV-END-SPACE-CNT-1)             
                                       DELIMITED BY SIZE                        
                  SPACE                DELIMITED BY SIZE                        
                  PV-CUST-DESC-PART-2  (1 : 8 - PV-END-SPACE-CNT-2)             
                                       DELIMITED BY SIZE                        
                  SPACE                DELIMITED BY SIZE                        
                  PV-CUST-DESC-PART-3  (1 : 8 - PV-END-SPACE-CNT-3)             
                                       DELIMITED BY SIZE                        
                  INTO PV-CUST-DESC-EDITED                                      
           END-STRING.                                                          
                                                                                
                                                                                
      ******************************************************************        
      *  COUNT THE TRAILING SPACES IN EACH 8-CHAR SHORT DESCRIPTION             
      *  (PARTS 1, 2, AND 3 OF THE CUSTOMER INTERFACE DESCRIPTION).             
      ******************************************************************        
       2157-COUNT-SPACES.                                                       
                                                                                
           IF  PV-CNT-TRAILING-SPACES = SPACES                                  
               MOVE +8 TO PV-END-SPACE-CNT                                      
           ELSE                                                                 
               IF  PV-7-TRLNG-SPCS = SPACES                                     
                   MOVE +7 TO PV-END-SPACE-CNT                                  
               ELSE                                                             
                   IF  PV-6-TRLNG-SPCS = SPACES                                 
                       MOVE +6 TO PV-END-SPACE-CNT                              
                   ELSE                                                         
                       IF  PV-5-TRLNG-SPCS = SPACES                             
                           MOVE +5 TO PV-END-SPACE-CNT                          
                       ELSE                                                     
                           IF  PV-4-TRLNG-SPCS = SPACES                         
                               MOVE +4 TO PV-END-SPACE-CNT                      
                           ELSE                                                 
                               IF  PV-3-TRLNG-SPCS = SPACES                     
                                   MOVE +3 TO PV-END-SPACE-CNT                  
                               ELSE                                             
                                   IF  PV-2-TRLNG-SPCS = SPACES                 
                                       MOVE +2 TO PV-END-SPACE-CNT              
                                   ELSE                                         
                                       IF  PV-1-TRLNG-SPCS = SPACES             
                                           MOVE +1 TO PV-END-SPACE-CNT          
                                       END-IF                                   
                                   END-IF                                       
                               END-IF                                           
                           END-IF                                               
                       END-IF                                                   
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
W35681******************************************************************        
W35681*  TWO OF THE THREE PARTS THAT MAKE UP THE 26-CHAR CUSTOMER               
W35681*  INTERFACE DESCRIPTION ARE BLANK - USE BRAND/CATAGORY DEFAULT           
W35681*  DESCRIPTION OR BRAND/HIERARCHY DEFAULT OR BUSINESS GROUP               
W35681******************************************************************        
W35681 2160-APPLY-DEFAULTS.                                                     
W35681                                                                          
W35681** BRAND MUST BE PRESENT OR BUS GRP DEFAULT IS USED                       
W35681** IF CATAGORY IS PRESENT IT WILL BE USED WITH BRAND                      
W35681** IF CATAGORY IS NOT PRESENT, HIERARCHY WILL BE USED WITH BRAND          
W35681** IF NEITHER CATAGORY NOR HIERARCHY ARE PRESENT, BUS GRP DEFAULT         
W35681** WILL BE USED.                                                          
W35681                                                                          
W35681     PERFORM 2161-TRY-BRAND.                                              
W35681                                                                          
W35681     IF  PV-CUST-DESC-PART-1    = SPACES                                  
W35681         PERFORM 2165-DEFAULT-BUS-GRP                                     
W35681     ELSE                                                                 
W35681         PERFORM 2162-TRY-CTG                                             
W35681         IF  PV-CUST-DESC-PART-2    = SPACES                              
W35681             PERFORM 2163-TRY-HIER                                        
W35681             IF  PV-CUST-DESC-PART-2    = SPACES                          
W35681                 PERFORM 2165-DEFAULT-BUS-GRP                             
W35681              END-IF                                                      
W35681         END-IF                                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681                                                                          
W35681 2161-TRY-BRAND.                                                          
W35681                                                                          
W35681     IF PV-CUST-DESC-DFLT-BRND = SPACES                                   
W35681         MOVE PC-ATTR-BRAND TO PV-CHARTC-CDE                              
W35681                               PV-CHARTC-CDE-TYPE                         
W35681         PERFORM 2200-GET-SHORT-DESC                                      
W35681         MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-1                        
W35681     ELSE                                                                 
W35681         MOVE PV-CUST-DESC-DFLT-BRND TO PV-CUST-DESC-PART-1               
W35681                                                                          
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681 2162-TRY-CTG.                                                            
W35681                                                                          
W35681     IF PV-CUST-DESC-DFLT-CTG  = SPACES                                   
W35681         MOVE PC-ATTR-CTG   TO PV-CHARTC-CDE                              
W35681                               PV-CHARTC-CDE-TYPE                         
W35681         PERFORM 2200-GET-SHORT-DESC                                      
W35681         MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-2                        
W35861         MOVE SPACES                 TO PV-CUST-DESC-PART-3               
W35681     ELSE                                                                 
W35681         MOVE PV-CUST-DESC-DFLT-CTG  TO PV-CUST-DESC-PART-2               
W35861         MOVE SPACES                 TO PV-CUST-DESC-PART-3               
W35681     END-IF.                                                              
W35681                                                                          
W35681 2163-TRY-HIER.                                                           
W35681                                                                          
W35681     IF PV-CUST-DESC-DFLT-HIER = SPACES                                   
W35681         MOVE PC-ATTR-HIER  TO PV-CHARTC-CDE                              
W35681                               PV-CHARTC-CDE-TYPE                         
W35681         PERFORM 2200-GET-SHORT-DESC                                      
W35681         MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-2                        
W35861         MOVE SPACES                 TO PV-CUST-DESC-PART-3               
W35681     ELSE                                                                 
W35681         MOVE PV-CUST-DESC-DFLT-HIER TO PV-CUST-DESC-PART-2               
W35861         MOVE SPACES                 TO PV-CUST-DESC-PART-3               
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
                                                                                
      ******************************************************************        
      *  TWO OF THE THREE PARTS THAT MAKE UP THE 26-CHAR CUSTOMER               
      *  INTERFACE DESCRIPTION ARE BLANK - USE BRAND/HIERARCHY DEFAULT          
      *  DESCRIPTION.                                                           
      ******************************************************************        
    ***2160-DEFAULT-BRND-HIER.                                                  
    ***                                                                         
    ***    IF  PV-CUST-DESC-DFLT-BRND = SPACES                                  
    ***        MOVE PC-ATTR-BRAND TO PV-CHARTC-CDE                              
    ***                              PV-CHARTC-CDE-TYPE                         
    ***        PERFORM 2200-GET-SHORT-DESC                                      
    ***        MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-1                        
    ***    ELSE                                                                 
    ***        MOVE PV-CUST-DESC-DFLT-BRND TO PV-CUST-DESC-PART-1               
    ***    END-IF.                                                              
    ***                                                                         
    ***    IF  PV-CUST-DESC-PART-1 = SPACES                                     
    ***        PERFORM 2165-DEFAULT-BUS-GRP                                     
    ***    ELSE                                                                 
    ***        IF  PV-CUST-DESC-DFLT-HIER = SPACES                              
    ***            MOVE PC-ATTR-HIER TO PV-CHARTC-CDE                           
    ***                                 PV-CHARTC-CDE-TYPE                      
    ***            PERFORM 2200-GET-SHORT-DESC                                  
    ***            MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-2                    
    ***            IF  PV-CUST-DESC-PART-2 = SPACES                             
    ***                PERFORM 2165-DEFAULT-BUS-GRP                             
    ***            ELSE                                                         
    ***                MOVE SPACES TO PV-CUST-DESC-PART-3                       
    ***            END-IF                                                       
    ***        ELSE                                                             
    ***            MOVE PV-CUST-DESC-DFLT-HIER TO PV-CUST-DESC-PART-2           
    ***            MOVE SPACES                 TO PV-CUST-DESC-PART-3           
    ***        END-IF                                                           
    ***    END-IF.                                                              
    ***                                                                         
                                                                                
      ******************************************************************        
      *  BRAND/CTG  DEFAULT IS NOT COMPLETE -                                   
      *  BRAND/HIER DEFAULT IS NOT COMPLETE - USE BUSINESS GROUP                
      *  DEFAULT DESCRIPTION.                                                   
      ******************************************************************        
       2165-DEFAULT-BUS-GRP.                                                    
                                                                                
           IF  PV-CURR-DEPT = PV-PREV-BUSGP-DEPT                                
               MOVE PV-SAVED-BUS-GRP-DESC TO PV-CUST-DESC                       
                                             PV-SHORT-DESC                      
                                             PV-CUST-DESC-PART-1                
               MOVE SPACES                TO PV-CUST-DESC-PART-2                
                                             PV-CUST-DESC-PART-3                
           ELSE                                                                 
               PERFORM 5700-GET-BUS-GROUP                                       
               MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-1                        
               MOVE SPACES        TO PV-CUST-DESC-PART-2                        
                                     PV-CUST-DESC-PART-3                        
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  GET ONE OF THE 8-CHAR SHORT DESCRIPTIONS THAT WILL BE                  
      *  BE CONCATENATED TO BUILD THE 26-CHAR CUSTOMER INTERFACE                
      *  DESCRIPTION.                                                           
      ******************************************************************        
       2200-GET-SHORT-DESC.                                                     
                                                                                
           MOVE SPACES TO PV-SHORT-DESC.                                        
                                                                                
           IF  IM-CHARTC-CDE                                                    
               PERFORM 2210-GET-ITEM-ATTR                                       
           ELSE                                                                 
               IF  BG-CHARTC-CDE                                                
                   IF  PV-CURR-DEPT = PV-PREV-BUSGP-DEPT                        
                       MOVE PV-SAVED-BUS-GRP-DESC TO PV-SHORT-DESC              
                   ELSE                                                         
                       PERFORM 5700-GET-BUS-GROUP                               
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  GET THE ITEM ATTRIBUTE DESCRIPTION NEEDED TO BUILD THE                 
      *  26-CHARACTER CUSTOMER INTERFACE DESCRIPTION.                           
      ******************************************************************        
       2210-GET-ITEM-ATTR.                                                      
                                                                                
           MOVE PV-CHARTC-CDE TO VSCHVL-CHARTC-CDE.                             
                                                                                
W35681*   CHANGED IF - ELSE TO AN EVALUATE                                      
W35681                                                                          
W35681     EVALUATE TRUE                                                        
W35681                                                                          
W35681         WHEN PV-ATTR-BRAND                                               
W35681                  MOVE MDARVS-LBL-SEQ-NBR                                 
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-HIER                                                
W35681                  MOVE MDARVS-RPT-HIER-SEQ-NBR                            
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-FUNC                                                
W35681                  MOVE MDARVS-FUNC-SEQ-NBR                                
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-SILH                                                
W35681                  MOVE MDARVS-SLHTT-SEQ-NBR                               
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-BDYSTL                                              
W35681                  MOVE MDARVS-BDY-STYL-SEQ-NBR                            
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-GNDR                                                
W35681                  MOVE MDARVS-GNDR-SEQ-NBR                                
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-FABRICATION                                         
W35681                  MOVE MDARVS-FBRCN-SEQ-NBR                               
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-PATTERN                                             
W35681                  MOVE MDARVS-PATRN-SEQ-NBR                               
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-CTG                                                 
W35681                  MOVE MDARVS-CTG-SEQ-NBR                                 
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-MAJ-CTG                                             
W35681                  MOVE MDARVS-MAJ-CTG-SEQ-NBR                             
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-NW-SILH                                             
W35681                  MOVE MDARVS-NW-SLHTT-SEQ-NBR                            
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-MTRL                                                
W35681                  MOVE MDARVS-MTRL-SEQ-NBR                                
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-ATTR-1                                              
W35681                  MOVE MDARVS-ATTR-1-SEQ-NBR                              
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681         WHEN PV-ATTR-ATTR-2                                              
W35681                  MOVE MDARVS-ATTR-2-SEQ-NBR                              
W35681                             TO VSCHVL-CHARTC-SEQ-NBR                     
W35681     END-EVALUATE.                                                        
                                                                                
           PERFORM 5600-GET-ITEM-ATTR-TVSCHVL.                                  
                                                                                
                                                                                
      ******************************************************************        
      *  DETERMINE IF A VALID DEFAULT BRAND/HIERARCHY CUSTOMER INTERFACE        
      *  DESCRIPTION CAN BE CREATED FOR A STYLE THAT HAS NO BUSINESS            
      *  RULES.                                                                 
      ******************************************************************        
       2300-PROCESS-NO-RULES-STYLE.                                             
                                                                                
           MOVE SPACES TO  PV-CUST-DESC                                         
                           PV-CUST-DESC-PART-1                                  
                           PV-CUST-DESC-PART-2                                  
                           PV-CUST-DESC-PART-3                                  
                           PV-CUST-DESC-DFLT-BRND                               
W35681                     PV-CUST-DESC-DFLT-HIER                               
W35681                     PV-CUST-DESC-DFLT-CTG.                               
           MOVE ZERO   TO  PV-NBR-BLANK-ATTRS.                                  
           MOVE 'N'    TO  PS-DFLT-BRND-IS-BLANK-SW                             
W35681                     PS-DFLT-HIER-IS-BLANK-SW                             
W35681                     PS-DFLT-CTG-IS-BLANK-SW                              
                                                                                
           MOVE PC-ATTR-BRAND TO PV-CHARTC-CDE                                  
                                 PV-CHARTC-CDE-TYPE.                            
           PERFORM 2200-GET-SHORT-DESC.                                         
           MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-1.                           
                                                                                
W35861     IF  PV-CUST-DESC-PART-1 > SPACES                                     
W35681         MOVE PC-ATTR-CTG  TO PV-CHARTC-CDE                               
W35681                              PV-CHARTC-CDE-TYPE                          
W35681         PERFORM 2200-GET-SHORT-DESC                                      
W35681         MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-2                        
W35681         IF  PV-CUST-DESC-PART-2 > SPACES                                 
W35681             MOVE SPACES TO PV-CUST-DESC-PART-3                           
W35681             PERFORM 2150-EDIT-CUST-DESC                                  
W35681             SET PS-BRAND-CTG-HIER-DFLT-FND TO TRUE                       
W35681         ELSE                                                             
W35681             MOVE PC-ATTR-HIER TO PV-CHARTC-CDE                           
W35681                                  PV-CHARTC-CDE-TYPE                      
W35681             PERFORM 2200-GET-SHORT-DESC                                  
W35681             MOVE PV-SHORT-DESC TO PV-CUST-DESC-PART-2                    
W35681             IF  PV-CUST-DESC-PART-2 > SPACES                             
W35681                 MOVE SPACES TO PV-CUST-DESC-PART-3                       
W35681                 PERFORM 2150-EDIT-CUST-DESC                              
W35681                 SET PS-BRAND-CTG-HIER-DFLT-FND TO TRUE                   
W35681             END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      * WRITE CHARACTERISTIC CHANGES BACKUP FILE RECORD.                        
      ******************************************************************        
       4000-WRITE-CHARACTR-CHGS-REC.                                            
                                                                                
           MOVE IMT00023-CHARTC-CDE        TO WS-CCBR-CHARTC-CDE.               
           MOVE IMT00023-CHARTC-SEQ-NBR    TO WS-CCBR-CHARTC-SEQ-NBR.           
           MOVE IMT00023-CHARTC-SHRT-DESC  TO WS-CCBR-CHARTC-SHRT-DESC.         
           MOVE IMT00023-OLD-CHARSHRT-DESC TO WS-CCBR-OLD-CHARSHRT-DESC.        
                                                                                
           WRITE CHARACTR-CHGS-BKUP-REC                                         
                 FROM WS-CHAR-CHGS-BKUP-REC.                                    
           ADD +1 TO PA-CHARTC-CHGS-WRITE-COUNT.                                
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE CUSTOMER INTERFACE DESCRIPTION CHARACTERISTIC CHANGES         
      *  CURSOR                                                                 
      ******************************************************************        
       5000-OPEN-CHARTC-CHG-CSR.                                                
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN CHARTC_CHG_CSR                                          
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '5000-OPEN-CHARTC-CHG-CSR'                         
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON CHARTC_CHG_CSR CURSOR'                    
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5000-OPEN-CHARTC-CHG-CSR' TO PV-PARAGRAPH-NAME             
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  FETCH THE CUSTOMER INTERFACE DESCRIPTION CHARACTERISTIC CHANGES        
      *  CURSOR                                                                 
      ******************************************************************        
       5010-FETCH-CHARTC-CHG-CSR.                                               
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH CHARTC_CHG_CSR                                         
                   INTO :IMT00023-CHARTC-CDE                                    
                      , :IMT00023-CHARTC-SEQ-NBR                                
                      , :IMT00023-CHARTC-SHRT-DESC                              
                      , :IMT00023-OLD-CHARSHRT-DESC                             
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        CONTINUE                                                
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-CHARTC-CHG-CSR TO TRUE                    
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '5010-FETCH-CHARTC-CHG-CSR'                        
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON CHARTC_CHG_CSR CURSOR'                   
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5010-FETCH-CHARTC-CHG-CSR' TO PV-PARAGRAPH-NAME            
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE CUSTOMER INTERFACE DESCRIPTION CHARACTERISTIC CHANGES        
      *  CURSOR                                                                 
      ******************************************************************        
       5020-CLOSE-CHARTC-CHG-CSR.                                               
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE CHARTC_CHG_CSR                                         
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '5020-CLOSE-CHARTC-CHG-CSR'                        
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON CHARTC_CHG_CSR CURSOR'                   
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5020-CLOSE-CHARTC-CHG-CSR' TO PV-PARAGRAPH-NAME            
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE BUSINESS RULES CURSOR                                         
      ******************************************************************        
       5100-OPEN-BUS-RULE-CSR.                                                  
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN BUS_RULE_CSR                                            
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '5100-OPEN-BUS-RULE-CSR'                           
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON BUSINESS RULE CURSOR'                     
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5100-OPEN-BUS-RULE-CSR' TO PV-PARAGRAPH-NAME               
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  FETCH THE BUSINESS RULES CURSOR                                        
      ******************************************************************        
       5110-FETCH-BUS-RULE-CSR.                                                 
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH BUS_RULE_CSR                                           
                   INTO :MDSEAR-MDSELV-CDE                                      
                      , :MDSEAR-MAJ-CL-NBR                                      
                      , :MDSEAR-SUB-CL-NBR                                      
                      , :IMT00022-POS1-VS-CHARTC-CDE                            
                      , :IMT00022-POS2-VS-CHARTC-CDE                            
                      , :IMT00022-POS3-VS-CHARTC-CDE                            
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-BUS-RULES-PROCESSED                    
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-BUS-RULE-CSR TO TRUE                      
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '5110-FETCH-BUS-RULE-CSR'                          
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON BUSINESS RULE CURSOR'                    
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5110-FETCH-BUS-RULE-CSR' TO PV-PARAGRAPH-NAME              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE BUSINESS RULES CURSOR                                        
      ******************************************************************        
       5120-CLOSE-BUS-RULE-CSR.                                                 
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE BUS_RULE_CSR                                           
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '5120-CLOSE-BUS-RULE-CSR'                          
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON BUSINESS RULE CURSOR'                    
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5120-CLOSE-BUS-RULE-CSR' TO PV-PARAGRAPH-NAME              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  UPDATE THE CUSTOMER INTERFACE DESCRIPTION ON TMDARVS                   
      ******************************************************************        
       5500-UPDATE-CUST-DESC.                                                   
                                                                                
           MOVE PV-CUST-DESC-EDITED TO MDARVS-CUST-INTFC-DESC.                  
                                                                                
           PERFORM  WITH TEST AFTER                                             
                   UNTIL SQLCODE = +0                                           
                      OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                
                                                                                
               EXEC SQL                                                         
                   UPDATE TMDARVS                                               
                      SET CUST_INTFC_DESC  = :MDARVS-CUST-INTFC-DESC            
                    WHERE SUB_CL_MDSEAR_ID = :MDARVS-SUB-CL-MDSEAR-ID           
                      AND VS_ID            = :MDARVS-VS-ID                      
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-TMDARVS-UPDATES                        
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        ADD 1          TO PV-RETRY-COUNT                        
                   WHEN OTHER                                                   
                        MOVE '5500-UPDATE-CUST-DESC'                            
                                       TO PV-PARAGRAPH-NAME                     
                        MOVE 'UPDATE CUST DESC ON TMDARVS'                      
                                       TO PV-DB2-OPERATION-ATTEMPTED            
                        DISPLAY 'SUB_CL_MDSEAR_ID: '                            
                                MDARVS-SUB-CL-MDSEAR-ID                         
                                ' VS_ID: ' MDARVS-VS-ID                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5500-UPDATE-CUST-DESC'                                     
                                       TO PV-PARAGRAPH-NAME                     
               MOVE 'UPDATE CUST DESC ON TMDARVS'                               
                                       TO PV-DB2-OPERATION-ATTEMPTED            
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FINISH GETTING THE ITEM ATTRIBUTE FOR THIS STYLE                       
      ******************************************************************        
       5600-GET-ITEM-ATTR-TVSCHVL.                                              
                                                                                
           MOVE SPACES TO VSCHVL-SHRT-CHARTC-DESC.                              
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                  SELECT SHRT_CHARTC_DESC                                       
                    INTO :VSCHVL-SHRT-CHARTC-DESC                               
                    FROM TVSCHVL                                                
                   WHERE CHARTC_CDE     = :VSCHVL-CHARTC-CDE                    
                     AND CHARTC_SEQ_NBR = :VSCHVL-CHARTC-SEQ-NBR                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        CONTINUE                                                
                   WHEN SQLCODE = +100                                          
                        MOVE SPACES TO VSCHVL-SHRT-CHARTC-DESC                  
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        ADD 1        TO PV-RETRY-COUNT                          
                   WHEN OTHER                                                   
                        MOVE '5600-GET-ITEM-ATTR-TVSCHVL'                       
                                     TO PV-PARAGRAPH-NAME                       
                        MOVE 'SELECT ON TVSCHVL'                                
                                     TO PV-DB2-OPERATION-ATTEMPTED              
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5600-GET-ITEM-ATTR-TVSCHVL'                                
                                     TO PV-PARAGRAPH-NAME                       
               MOVE 'SELECT ON TVSCHVL'                                         
                                     TO PV-DB2-OPERATION-ATTEMPTED              
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
           IF  VSCHVL-SHRT-CHARTC-DESC = SPACES                                 
           OR  VSCHVL-SHRT-CHARTC-DESC = 'NONE'                                 
           OR  VSCHVL-SHRT-CHARTC-DESC = 'OTHER'                                
               MOVE SPACES TO PV-SHORT-DESC                                     
           ELSE                                                                 
               MOVE VSCHVL-SHRT-CHARTC-DESC TO PV-SHORT-DESC                    
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  GET THE BUSINESS GROUP DESCRIPTION FOR THIS STYLE                      
      ******************************************************************        
       5700-GET-BUS-GROUP.                                                      
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                  SELECT C.BUS_GP_SHRT_DESC                                     
                    INTO :MDSEBG-BUS-GP-SHRT-DESC                               
                    FROM TMDSEAR A                                              
                       , TMDSEDP B                                              
                       , TMDSEBG C                                              
                   WHERE A.OPERCO_NBR       = '03'                              
                     AND A.DEPT_NBR         = :MDSEAR-DEPT-NBR                  
                     AND CURRENT DATE BETWEEN A.STRT_DTE AND A.END_DTE          
                     AND A.MDSEAR_DKEY      = B.MDSEAR_DKEY                     
                     AND B.MDSEBG_NBR       = C.MDSEBG_NBR                      
                     AND A.MDSELV_CDE       = 'DPT'                             
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        MOVE MDSEBG-BUS-GP-SHRT-DESC                            
                                          TO PV-SHORT-DESC                      
                                             PV-SAVED-BUS-GRP-DESC              
                        MOVE PV-CURR-DEPT TO PV-PREV-BUSGP-DEPT                 
                   WHEN SQLCODE = +100                                          
                        MOVE SPACES                                             
                          TO PV-SHORT-DESC                                      
                             PV-SAVED-BUS-GRP-DESC                              
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -913                                          
                        ADD 1        TO PV-RETRY-COUNT                          
                   WHEN OTHER                                                   
                        MOVE '5700-GET-BUS-GROUP'                               
                                     TO PV-PARAGRAPH-NAME                       
                        MOVE 'SELECT BUS GRP FROM TMDSEBG'                      
                                     TO PV-DB2-OPERATION-ATTEMPTED              
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5700-GET-BUS-GROUP'                                        
                                     TO PV-PARAGRAPH-NAME                       
               MOVE 'SELECT BUS GRP FROM TMDSEBG'                               
                                     TO PV-DB2-OPERATION-ATTEMPTED              
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  DELETE THE CUSTOMER INTERFACE DESCRIPTION CHARACTERISTIC CHANGE        
      ******************************************************************        
       5800-DELETE-CHARTC-CHG.                                                  
                                                                                
           PERFORM  WITH TEST AFTER                                             
                   UNTIL SQLCODE = +0                                           
                      OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                
                                                                                
               EXEC SQL                                                         
                   DELETE FROM IMT_CHARTC_CHG                                   
                    WHERE CHARTC_CDE     = :IMT00023-CHARTC-CDE                 
                      AND CHARTC_SEQ_NBR = :IMT00023-CHARTC-SEQ-NBR             
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-CHARTC-CHG-DELETES                     
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        ADD 1          TO PV-RETRY-COUNT                        
                   WHEN OTHER                                                   
                        MOVE '5800-DELETE-CHARTC-CHG'                           
                                       TO PV-PARAGRAPH-NAME                     
                        MOVE 'DELETE IMT_CHARTC_CHG ROW'                        
                                       TO PV-DB2-OPERATION-ATTEMPTED            
                        DISPLAY 'CHARTC_CDE: ' IMT00023-CHARTC-CDE              
                                ' CHARTC_SEQ_NBR: '                             
                                IMT00023-CHARTC-SEQ-NBR                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '5800-DELETE-CHARTC-CHG'                                    
                                       TO PV-PARAGRAPH-NAME                     
               MOVE 'DELETE IMT_CHARTC_CHG ROW'                                 
                                       TO PV-DB2-OPERATION-ATTEMPTED            
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE FABRICATION STYLES CURSOR                                     
      ******************************************************************        
       6000-OPEN-FABRICTN-STYLES-CSR.                                           
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN FABRCTN_STYLES_CSR                                      
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6000-OPEN-FABRICTN-STYLES-CSR'                    
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON FABRICATION STYLES CURSOR'                
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6000-OPEN-FABRICTN-STYLES-CSR'                             
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE FABRICATION STYLES CURSOR                                    
      ******************************************************************        
       6010-FETCH-FABRICTN-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH FABRCTN_STYLES_CSR                                     
                   INTO :MDARVS-SUB-CL-MDSEAR-ID                                
                      , :MDARVS-VS-ID                                           
                      , :MDARVS-DEPT-NBR                                        
                      , :MDARVS-MAJ-CL-NBR                                      
                      , :MDARVS-SUB-CL-NBR                                      
                      , :MDARVS-LBL-SEQ-NBR                                     
                      , :MDARVS-RPT-HIER-SEQ-NBR                                
                      , :MDARVS-BDY-STYL-SEQ-NBR                                
                      , :MDARVS-SLHTT-SEQ-NBR                                   
                      , :MDARVS-FUNC-SEQ-NBR                                    
                      , :MDARVS-GNDR-SEQ-NBR                                    
                      , :MDARVS-FBRCN-SEQ-NBR                                   
                      , :MDARVS-PATRN-SEQ-NBR                                   
                      , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-STYLES-PROCESSED                       
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-STYLE-CSR TO TRUE                         
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6010-FETCH-FABRICTN-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON FABRICATION STYLES CURSOR'               
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6010-FETCH-FABRICTN-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE FABRICATION STYLES CURSOR                                    
      ******************************************************************        
       6020-CLOSE-FABRICTN-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE FABRCTN_STYLES_CSR                                     
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6020-CLOSE-FABRICTN-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON FABRICATION STYLES CURSOR'               
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6020-CLOSE-FABRICTN-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE BRAND STYLES CURSOR                                           
      ******************************************************************        
       6100-OPEN-BRAND-STYLES-CSR.                                              
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN BRAND_STYLES_CSR                                        
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6100-OPEN-BRAND-STYLES-CSR'                       
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON BRAND STYLES CURSOR'                      
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6100-OPEN-BRAND-STYLES-CSR'                                
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE BRAND STYLES CURSOR                                          
      ******************************************************************        
       6110-FETCH-BRAND-STYLES-CSR.                                             
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH BRAND_STYLES_CSR                                       
                   INTO :MDARVS-SUB-CL-MDSEAR-ID                                
                      , :MDARVS-VS-ID                                           
                      , :MDARVS-DEPT-NBR                                        
                      , :MDARVS-MAJ-CL-NBR                                      
                      , :MDARVS-SUB-CL-NBR                                      
                      , :MDARVS-LBL-SEQ-NBR                                     
                      , :MDARVS-RPT-HIER-SEQ-NBR                                
                      , :MDARVS-BDY-STYL-SEQ-NBR                                
                      , :MDARVS-SLHTT-SEQ-NBR                                   
                      , :MDARVS-FUNC-SEQ-NBR                                    
                      , :MDARVS-GNDR-SEQ-NBR                                    
                      , :MDARVS-FBRCN-SEQ-NBR                                   
                      , :MDARVS-PATRN-SEQ-NBR                                   
                      , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-STYLES-PROCESSED                       
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-STYLE-CSR TO TRUE                         
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6110-FETCH-BRAND-STYLES-CSR'                      
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON BRAND STYLES CURSOR'                     
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6110-FETCH-BRAND-STYLES-CSR'                               
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE BRAND STYLES CURSOR                                          
      ******************************************************************        
       6120-CLOSE-BRAND-STYLES-CSR.                                             
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE BRAND_STYLES_CSR                                       
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6120-CLOSE-BRAND-STYLES-CSR'                      
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON BRAND STYLES CURSOR'                     
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6120-CLOSE-BRAND-STYLES-CSR'                               
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE PATTERN STYLES CURSOR                                         
      ******************************************************************        
       6200-OPEN-PATTERN-STYLES-CSR.                                            
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN PATTERN_STYLES_CSR                                      
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6200-OPEN-PATTERN-STYLES-CSR'                     
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON PATTERN STYLES CURSOR'                    
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6200-OPEN-PATTERN-STYLES-CSR'                              
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE PATTERN STYLES CURSOR                                        
      ******************************************************************        
       6210-FETCH-PATTERN-STYLES-CSR.                                           
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH PATTERN_STYLES_CSR                                     
                   INTO :MDARVS-SUB-CL-MDSEAR-ID                                
                      , :MDARVS-VS-ID                                           
                      , :MDARVS-DEPT-NBR                                        
                      , :MDARVS-MAJ-CL-NBR                                      
                      , :MDARVS-SUB-CL-NBR                                      
                      , :MDARVS-LBL-SEQ-NBR                                     
                      , :MDARVS-RPT-HIER-SEQ-NBR                                
                      , :MDARVS-BDY-STYL-SEQ-NBR                                
                      , :MDARVS-SLHTT-SEQ-NBR                                   
                      , :MDARVS-FUNC-SEQ-NBR                                    
                      , :MDARVS-GNDR-SEQ-NBR                                    
                      , :MDARVS-FBRCN-SEQ-NBR                                   
                      , :MDARVS-PATRN-SEQ-NBR                                   
                      , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-STYLES-PROCESSED                       
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-STYLE-CSR TO TRUE                         
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6210-FETCH-PATTERN-STYLES-CSR'                    
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON PATTERN STYLES CURSOR'                   
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6210-FETCH-PATTERN-STYLES-CSR'                             
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE PATTERN STYLES CURSOR                                        
      ******************************************************************        
       6220-CLOSE-PATTERN-STYLES-CSR.                                           
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE PATTERN_STYLES_CSR                                     
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6220-CLOSE-PATTERN-STYLES-CSR'                    
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON PATTERN STYLES CURSOR'                   
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6220-CLOSE-PATTERN-STYLES-CSR'                             
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE HIERARCHY STYLES CURSOR                                       
      ******************************************************************        
       6300-OPEN-HIERACHY-STYLES-CSR.                                           
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN HIERCHY_STYLES_CSR                                      
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6300-OPEN-HIERACHY-STYLES-CSR'                    
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON HIERARCHY STYLES CURSOR'                  
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6300-OPEN-HIERACHY-STYLES-CSR'                             
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE HIERARCHY STYLES CURSOR                                      
      ******************************************************************        
       6310-FETCH-HIERACHY-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH HIERCHY_STYLES_CSR                                     
                   INTO :MDARVS-SUB-CL-MDSEAR-ID                                
                      , :MDARVS-VS-ID                                           
                      , :MDARVS-DEPT-NBR                                        
                      , :MDARVS-MAJ-CL-NBR                                      
                      , :MDARVS-SUB-CL-NBR                                      
                      , :MDARVS-LBL-SEQ-NBR                                     
                      , :MDARVS-RPT-HIER-SEQ-NBR                                
                      , :MDARVS-BDY-STYL-SEQ-NBR                                
                      , :MDARVS-SLHTT-SEQ-NBR                                   
                      , :MDARVS-FUNC-SEQ-NBR                                    
                      , :MDARVS-GNDR-SEQ-NBR                                    
                      , :MDARVS-FBRCN-SEQ-NBR                                   
                      , :MDARVS-PATRN-SEQ-NBR                                   
                      , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-STYLES-PROCESSED                       
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-STYLE-CSR TO TRUE                         
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6310-FETCH-HIERACHY-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON HIERARCHY STYLES CURSOR'                 
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6310-FETCH-HIERACHY-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE HIERARCHY STYLES CURSOR                                      
      ******************************************************************        
       6320-CLOSE-HIERACHY-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE HIERCHY_STYLES_CSR                                     
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6320-CLOSE-HIERACHY-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON HIERARCHY STYLES CURSOR'                 
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6320-CLOSE-HIERACHY-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE FUNCTION STYLES CURSOR                                        
      ******************************************************************        
       6400-OPEN-FUNCTION-STYLES-CSR.                                           
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN FUNCTN_STYLES_CSR                                       
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6400-OPEN-FUNCTION-STYLES-CSR'                    
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON FUNCTION STYLES CURSOR'                   
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6400-OPEN-FUNCTION-STYLES-CSR'                             
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE FUNCTION STYLES CURSOR                                       
      ******************************************************************        
       6410-FETCH-FUNCTION-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH FUNCTN_STYLES_CSR                                      
                   INTO :MDARVS-SUB-CL-MDSEAR-ID                                
                      , :MDARVS-VS-ID                                           
                      , :MDARVS-DEPT-NBR                                        
                      , :MDARVS-MAJ-CL-NBR                                      
                      , :MDARVS-SUB-CL-NBR                                      
                      , :MDARVS-LBL-SEQ-NBR                                     
                      , :MDARVS-RPT-HIER-SEQ-NBR                                
                      , :MDARVS-BDY-STYL-SEQ-NBR                                
                      , :MDARVS-SLHTT-SEQ-NBR                                   
                      , :MDARVS-FUNC-SEQ-NBR                                    
                      , :MDARVS-GNDR-SEQ-NBR                                    
                      , :MDARVS-FBRCN-SEQ-NBR                                   
                      , :MDARVS-PATRN-SEQ-NBR                                   
                      , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-STYLES-PROCESSED                       
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-STYLE-CSR TO TRUE                         
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6410-FETCH-FUNCTION-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON FUNCTION STYLES CURSOR'                  
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6410-FETCH-FUNCTION-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE FUNCTION STYLES CURSOR                                       
      ******************************************************************        
       6420-CLOSE-FUNCTION-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE FUNCTN_STYLES_CSR                                      
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6420-CLOSE-FUNCTION-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON FUNCTION STYLES CURSOR'                  
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6420-CLOSE-FUNCTION-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE SILHOUETTE STYLES CURSOR                                      
      ******************************************************************        
       6500-OPEN-SILHOUET-STYLES-CSR.                                           
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN SILHTT_STYLES_CSR                                       
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6500-OPEN-SILHOUET-STYLES-CSR'                    
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON SILHOUETTE STYLES CURSOR'                 
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6500-OPEN-SILHOUET-STYLES-CSR'                             
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE SILHOUETTE STYLES CURSOR                                     
      ******************************************************************        
       6510-FETCH-SILHOUET-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH SILHTT_STYLES_CSR                                      
                   INTO :MDARVS-SUB-CL-MDSEAR-ID                                
                      , :MDARVS-VS-ID                                           
                      , :MDARVS-DEPT-NBR                                        
                      , :MDARVS-MAJ-CL-NBR                                      
                      , :MDARVS-SUB-CL-NBR                                      
                      , :MDARVS-LBL-SEQ-NBR                                     
                      , :MDARVS-RPT-HIER-SEQ-NBR                                
                      , :MDARVS-BDY-STYL-SEQ-NBR                                
                      , :MDARVS-SLHTT-SEQ-NBR                                   
                      , :MDARVS-FUNC-SEQ-NBR                                    
                      , :MDARVS-GNDR-SEQ-NBR                                    
                      , :MDARVS-FBRCN-SEQ-NBR                                   
                      , :MDARVS-PATRN-SEQ-NBR                                   
                      , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-STYLES-PROCESSED                       
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-STYLE-CSR TO TRUE                         
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6510-FETCH-SILHOUET-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON SILHOUETTE STYLES CURSOR'                
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6510-FETCH-SILHOUET-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE SILHOUETTE STYLES CURSOR                                     
      ******************************************************************        
       6520-CLOSE-SILHOUET-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE SILHTT_STYLES_CSR                                      
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6520-CLOSE-SILHOUET-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON SILHOUETTE STYLES CURSOR'                
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6520-CLOSE-SILHOUET-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE BODYSTYLE STYLES CURSOR                                       
      ******************************************************************        
       6600-OPEN-BODYSTYL-STYLES-CSR.                                           
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN BODYSTY_STYLES_CSR                                      
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6600-OPEN-BODYSTYL-STYLES-CSR'                    
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON BODYSTYLE STYLES CURSOR'                  
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6600-OPEN-BODYSTYL-STYLES-CSR'                             
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE BODYSTYLE STYLES CURSOR                                      
      ******************************************************************        
       6610-FETCH-BODYSTYL-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH BODYSTY_STYLES_CSR                                     
                   INTO :MDARVS-SUB-CL-MDSEAR-ID                                
                      , :MDARVS-VS-ID                                           
                      , :MDARVS-DEPT-NBR                                        
                      , :MDARVS-MAJ-CL-NBR                                      
                      , :MDARVS-SUB-CL-NBR                                      
                      , :MDARVS-LBL-SEQ-NBR                                     
                      , :MDARVS-RPT-HIER-SEQ-NBR                                
                      , :MDARVS-BDY-STYL-SEQ-NBR                                
                      , :MDARVS-SLHTT-SEQ-NBR                                   
                      , :MDARVS-FUNC-SEQ-NBR                                    
                      , :MDARVS-GNDR-SEQ-NBR                                    
                      , :MDARVS-FBRCN-SEQ-NBR                                   
                      , :MDARVS-PATRN-SEQ-NBR                                   
                      , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-STYLES-PROCESSED                       
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-STYLE-CSR TO TRUE                         
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6610-FETCH-BODYSTYL-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON BODYSTYLE STYLES CURSOR'                 
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6610-FETCH-BODYSTYL-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE BODYSTYLE STYLES CURSOR                                      
      ******************************************************************        
       6620-CLOSE-BODYSTYL-STYLES-CSR.                                          
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE BODYSTY_STYLES_CSR                                     
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6620-CLOSE-BODYSTYL-STYLES-CSR'                   
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON BODYSTYLE STYLES CURSOR'                 
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6620-CLOSE-BODYSTYL-STYLES-CSR'                            
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN THE GENDER STYLES CURSOR                                          
      ******************************************************************        
       6700-OPEN-GENDER-STYLES-CSR.                                             
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   OPEN GENDER_STYLES_CSR                                       
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6700-OPEN-GENDER-STYLES-CSR'                      
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'OPEN ON GENDER STYLES CURSOR'                     
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6700-OPEN-GENDER-STYLES-CSR'                               
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  FETCH THE GENDER STYLES CURSOR                                         
      ******************************************************************        
       6710-FETCH-GENDER-STYLES-CSR.                                            
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR SQLCODE = +100                                             
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   FETCH GENDER_STYLES_CSR                                      
                   INTO :MDARVS-SUB-CL-MDSEAR-ID                                
                      , :MDARVS-VS-ID                                           
                      , :MDARVS-DEPT-NBR                                        
                      , :MDARVS-MAJ-CL-NBR                                      
                      , :MDARVS-SUB-CL-NBR                                      
                      , :MDARVS-LBL-SEQ-NBR                                     
                      , :MDARVS-RPT-HIER-SEQ-NBR                                
                      , :MDARVS-BDY-STYL-SEQ-NBR                                
                      , :MDARVS-SLHTT-SEQ-NBR                                   
                      , :MDARVS-FUNC-SEQ-NBR                                    
                      , :MDARVS-GNDR-SEQ-NBR                                    
                      , :MDARVS-FBRCN-SEQ-NBR                                   
                      , :MDARVS-PATRN-SEQ-NBR                                   
                      , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        ADD +1 TO PA-NBR-STYLES-PROCESSED                       
                   WHEN SQLCODE = +100                                          
                        SET PS-END-OF-STYLE-CSR TO TRUE                         
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6710-FETCH-GENDER-STYLES-CSR'                     
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'FETCH ON GENDER STYLES CURSOR'                    
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6710-FETCH-GENDER-STYLES-CSR'                              
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  CLOSE THE GENDER STYLES CURSOR                                         
      ******************************************************************        
       6720-CLOSE-GENDER-STYLES-CSR.                                            
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                   CLOSE GENDER_STYLES_CSR                                      
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        CONTINUE                                                
                   WHEN SQLWARN NOT = SPACES                                    
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE '6720-CLOSE-GENDER-STYLES-CSR'                     
                              TO PV-PARAGRAPH-NAME                              
                        MOVE 'CLOSE ON GENDER STYLES CURSOR'                    
                              TO PV-DB2-OPERATION-ATTEMPTED                     
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '6720-CLOSE-GENDER-STYLES-CSR'                              
                              TO PV-PARAGRAPH-NAME                              
               MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
                              TO PV-DB2-OPERATION-ATTEMPTED                     
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  OPEN THE CTG_CSR        CURSOR                                         
W35681******************************************************************        
W35681 6810-OPEN-CTG-CSR.                                                       
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             OPEN CTG_CSR                                                 
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6810-OPEN-CTG-CSR'                                
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'OPEN ON CTG_CSR CURSOR'                           
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6810-OPEN-CTG-CSR   '                                      
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  FETCH THE CTG_CSR CURSOR                                               
W35681******************************************************************        
W35681 6815-FETCH-CTG-CSR.                                                      
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR SQLCODE = +100                                             
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             FETCH CTG_CSR                                                
W35681             INTO :MDARVS-SUB-CL-MDSEAR-ID                                
W35681                , :MDARVS-VS-ID                                           
W35681                , :MDARVS-DEPT-NBR                                        
W35681                , :MDARVS-MAJ-CL-NBR                                      
W35681                , :MDARVS-SUB-CL-NBR                                      
W35681                , :MDARVS-LBL-SEQ-NBR                                     
W35681                , :MDARVS-RPT-HIER-SEQ-NBR                                
W35681                , :MDARVS-BDY-STYL-SEQ-NBR                                
W35681                , :MDARVS-SLHTT-SEQ-NBR                                   
W35681                , :MDARVS-FUNC-SEQ-NBR                                    
W35681                , :MDARVS-GNDR-SEQ-NBR                                    
W35681                , :MDARVS-FBRCN-SEQ-NBR                                   
W35681                , :MDARVS-PATRN-SEQ-NBR                                   
W35681                , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = +0                                            
W35681                  ADD +1 TO PA-NBR-STYLES-PROCESSED                       
W35681             WHEN SQLCODE = +100                                          
W35681                  SET PS-END-OF-STYLE-CSR TO TRUE                         
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6815-FETCH-CTG-CSR   '                            
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'FETCH ON CTG_CSR      '                           
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6815-FETCH-CTG-CSR'                                        
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CLOSE THE CTG_CSR                                                      
W35681******************************************************************        
W35681 6816-CLOSE-CTG-CSR.                                                      
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             CLOSE CTG_CSR                                                
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6816-CLOSE-CTG-CSR   '                            
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'CLOSE ON CTG_CSR CURSOR'                          
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6816-CLOSE-CTG-CSR   '                                     
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  OPEN THE MAJ_CTG_CSR    CURSOR                                         
W35681******************************************************************        
W35681 6820-OPEN-MAJ-CTG-CSR.                                                   
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             OPEN MAJ_CTG_CSR                                             
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6820-OPEN-MAJ-CTG-CSR'                            
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'OPEN ON MAJ_CTG_CSR   CURSOR'                     
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6820-OPEN-MAJ-CTG-CSR     '                                
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  FETCH THE MAJ_CTG_CSR    CURSOR                                        
W35681******************************************************************        
W35681 6825-FETCH-MAJ-CTG-CSR.                                                  
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR SQLCODE = +100                                             
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             FETCH MAJ_CTG_CSR                                            
W35681             INTO :MDARVS-SUB-CL-MDSEAR-ID                                
W35681                , :MDARVS-VS-ID                                           
W35681                , :MDARVS-DEPT-NBR                                        
W35681                , :MDARVS-MAJ-CL-NBR                                      
W35681                , :MDARVS-SUB-CL-NBR                                      
W35681                , :MDARVS-LBL-SEQ-NBR                                     
W35681                , :MDARVS-RPT-HIER-SEQ-NBR                                
W35681                , :MDARVS-BDY-STYL-SEQ-NBR                                
W35681                , :MDARVS-SLHTT-SEQ-NBR                                   
W35681                , :MDARVS-FUNC-SEQ-NBR                                    
W35681                , :MDARVS-GNDR-SEQ-NBR                                    
W35681                , :MDARVS-FBRCN-SEQ-NBR                                   
W35681                , :MDARVS-PATRN-SEQ-NBR                                   
W35681                , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = +0                                            
W35681                  ADD +1 TO PA-NBR-STYLES-PROCESSED                       
W35681             WHEN SQLCODE = +100                                          
W35681                  SET PS-END-OF-STYLE-CSR TO TRUE                         
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6825-FETCH-MAJ-CTG-CSR   '                        
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'FETCH ON MAJ_CTG_CSR         '                    
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6825-FETCH-MAJ-CTG-CSR   '                                 
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CLOSE THE MAJ_CTG_CSR    CURSOR                                        
W35681******************************************************************        
W35681 6826-CLOSE-MAJ-CTG-CSR.                                                  
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             CLOSE MAJ_CTG_CSR                                            
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6826-CLOSE-MAJ-CTG-CSR      '                     
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'CLOSE ON MAJ_CTG_CSR    CURSOR'                   
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6826-CLOSE-MAJ-CTG-CSR      '                              
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  OPEN THE NW_SILH_CSR    CURSOR                                         
W35681******************************************************************        
W35681 6830-OPEN-NW-SILH-CSR.                                                   
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             OPEN NW_SILH_CSR                                             
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6830-OPEN-NW-SILH-CSR'                            
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'OPEN ON NW_SILH_CSR   CURSOR'                     
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6830-OPEN-NW-SILH-CSR     '                                
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  FETCH THE NW_SILH_CSR    CURSOR                                        
W35681******************************************************************        
W35681 6835-FETCH-NW-SILH-CSR.                                                  
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR SQLCODE = +100                                             
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             FETCH NW_SILH_CSR                                            
W35681             INTO :MDARVS-SUB-CL-MDSEAR-ID                                
W35681                , :MDARVS-VS-ID                                           
W35681                , :MDARVS-DEPT-NBR                                        
W35681                , :MDARVS-MAJ-CL-NBR                                      
W35681                , :MDARVS-SUB-CL-NBR                                      
W35681                , :MDARVS-LBL-SEQ-NBR                                     
W35681                , :MDARVS-RPT-HIER-SEQ-NBR                                
W35681                , :MDARVS-BDY-STYL-SEQ-NBR                                
W35681                , :MDARVS-SLHTT-SEQ-NBR                                   
W35681                , :MDARVS-FUNC-SEQ-NBR                                    
W35681                , :MDARVS-GNDR-SEQ-NBR                                    
W35681                , :MDARVS-FBRCN-SEQ-NBR                                   
W35681                , :MDARVS-PATRN-SEQ-NBR                                   
W35681                , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = +0                                            
W35681                  ADD +1 TO PA-NBR-STYLES-PROCESSED                       
W35681             WHEN SQLCODE = +100                                          
W35681                  SET PS-END-OF-STYLE-CSR TO TRUE                         
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6835-FETCH-NW-SILH-CSR '                          
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'FETCH ON NW_SILH_CSR      '                       
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6835-FETCH-NW-SILH-CSR '                                   
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CLOSE THE NW_SILH_CSR    CURSOR                                        
W35681******************************************************************        
W35681 6836-CLOSE-NW-SILH-CSR.                                                  
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             CLOSE NW_SILH_CSR                                            
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6836-CLOSE-NW-SILH-CSR   '                        
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'CLOSE ON NW_SILH_CSR CURSOR'                      
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6836-CLOSE-NW-SILH-CSR   '                                 
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  OPEN THE MTRL_CSR       CURSOR                                         
W35681******************************************************************        
W35681 6840-OPEN-MTRL-CSR.                                                      
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             OPEN MTRL_CSR                                                
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6840-OPEN-MTRL-CSR'                               
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'OPEN ON MTRL_CSR   CURSOR'                        
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6840-OPEN-MTRL-CSR     '                                   
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  FETCH THE MTRL_CSR       CURSOR                                        
W35681******************************************************************        
W35681 6845-FETCH-MTRL-CSR.                                                     
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR SQLCODE = +100                                             
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             FETCH MTRL_CSR                                               
W35681             INTO :MDARVS-SUB-CL-MDSEAR-ID                                
W35681                , :MDARVS-VS-ID                                           
W35681                , :MDARVS-DEPT-NBR                                        
W35681                , :MDARVS-MAJ-CL-NBR                                      
W35681                , :MDARVS-SUB-CL-NBR                                      
W35681                , :MDARVS-LBL-SEQ-NBR                                     
W35681                , :MDARVS-RPT-HIER-SEQ-NBR                                
W35681                , :MDARVS-BDY-STYL-SEQ-NBR                                
W35681                , :MDARVS-SLHTT-SEQ-NBR                                   
W35681                , :MDARVS-FUNC-SEQ-NBR                                    
W35681                , :MDARVS-GNDR-SEQ-NBR                                    
W35681                , :MDARVS-FBRCN-SEQ-NBR                                   
W35681                , :MDARVS-PATRN-SEQ-NBR                                   
W35681                , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = +0                                            
W35681                  ADD +1 TO PA-NBR-STYLES-PROCESSED                       
W35681             WHEN SQLCODE = +100                                          
W35681                  SET PS-END-OF-STYLE-CSR TO TRUE                         
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6845-FETCH-MTRL-CSR   '                           
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'FETCH ON MTRL_CSR         '                       
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6845-FETCH-MTRL-CSR   '                                    
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CLOSE THE MTRL_CSR       CURSOR                                        
W35681******************************************************************        
W35681 6846-CLOSE-MTRL-CSR.                                                     
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             CLOSE MTRL_CSR                                               
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6846-CLOSE-MTRL-CSR      '                        
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'CLOSE ON MTRL_CSR    CURSOR'                      
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6846-CLOSE-MTRL-CSR      '                                 
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  OPEN THE ATTR_1_CSR     CURSOR                                         
W35681******************************************************************        
W35681 6870-OPEN-ATTR-1-CSR.                                                    
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             OPEN ATTR_1_CSR                                              
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6870-OPEN-ATTR-1-CSR'                             
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'OPEN ON ATTR_1_CSR   CURSOR'                      
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6870-OPEN-ATTR-1-CSR     '                                 
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  FETCH THE ATTR_1_CSR     CURSOR                                        
W35681******************************************************************        
W35681 6875-FETCH-ATTR-1-CSR.                                                   
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR SQLCODE = +100                                             
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             FETCH ATTR_1_CSR                                             
W35681             INTO :MDARVS-SUB-CL-MDSEAR-ID                                
W35681                , :MDARVS-VS-ID                                           
W35681                , :MDARVS-DEPT-NBR                                        
W35681                , :MDARVS-MAJ-CL-NBR                                      
W35681                , :MDARVS-SUB-CL-NBR                                      
W35681                , :MDARVS-LBL-SEQ-NBR                                     
W35681                , :MDARVS-RPT-HIER-SEQ-NBR                                
W35681                , :MDARVS-BDY-STYL-SEQ-NBR                                
W35681                , :MDARVS-SLHTT-SEQ-NBR                                   
W35681                , :MDARVS-FUNC-SEQ-NBR                                    
W35681                , :MDARVS-GNDR-SEQ-NBR                                    
W35681                , :MDARVS-FBRCN-SEQ-NBR                                   
W35681                , :MDARVS-PATRN-SEQ-NBR                                   
W35681                , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = +0                                            
W35681                  ADD +1 TO PA-NBR-STYLES-PROCESSED                       
W35681             WHEN SQLCODE = +100                                          
W35681                  SET PS-END-OF-STYLE-CSR TO TRUE                         
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6875-FETCH-ATTR-1-CSR   '                         
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'FETCH ON ATTR_1_CSR         '                     
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6875-FETCH-ATTR-1-CSR   '                                  
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CLOSE THE ATTR_1_CSR     CURSOR                                        
W35681******************************************************************        
W35681 6876-CLOSE-ATTR-1-CSR.                                                   
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             CLOSE ATTR_1_CSR                                             
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6876-CLOSE-ATTR-1-CSR      '                      
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'CLOSE ON ATTR_1_CSR CURSOR'                       
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6876-CLOSE-ATTR-1-CSR      '                               
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  OPEN THE ATTR_2_CSR     CURSOR                                         
W35681******************************************************************        
W35681 6880-OPEN-ATTR-2-CSR.                                                    
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             OPEN ATTR_2_CSR                                              
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6880-OPEN-ATTR-2-CSR'                             
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'OPEN ON ATTR_2_CSR   CURSOR'                      
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6880-OPEN-ATTR-2-CSR     '                                 
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'OPEN CURSOR RETRIES EXCEEDED'                              
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  FETCH THE ATTR_2_CSR     CURSOR                                        
W35681******************************************************************        
W35681 6885-FETCH-ATTR-2-CSR.                                                   
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR SQLCODE = +100                                             
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             FETCH ATTR_2_CSR                                             
W35681             INTO :MDARVS-SUB-CL-MDSEAR-ID                                
W35681                , :MDARVS-VS-ID                                           
W35681                , :MDARVS-DEPT-NBR                                        
W35681                , :MDARVS-MAJ-CL-NBR                                      
W35681                , :MDARVS-SUB-CL-NBR                                      
W35681                , :MDARVS-LBL-SEQ-NBR                                     
W35681                , :MDARVS-RPT-HIER-SEQ-NBR                                
W35681                , :MDARVS-BDY-STYL-SEQ-NBR                                
W35681                , :MDARVS-SLHTT-SEQ-NBR                                   
W35681                , :MDARVS-FUNC-SEQ-NBR                                    
W35681                , :MDARVS-GNDR-SEQ-NBR                                    
W35681                , :MDARVS-FBRCN-SEQ-NBR                                   
W35681                , :MDARVS-PATRN-SEQ-NBR                                   
W35681                , :MDARVS-CUST-INTFC-DESC                                 
W35681                , :MDARVS-CTG-SEQ-NBR                                     
W35681                , :MDARVS-MAJ-CTG-SEQ-NBR                                 
W35681                , :MDARVS-MTRL-SEQ-NBR                                    
W35681                , :MDARVS-ATTR-1-SEQ-NBR                                  
W35681                , :MDARVS-ATTR-2-SEQ-NBR                                  
W35681                , :MDARVS-NW-SLHTT-SEQ-NBR                                
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = +0                                            
W35681                  ADD +1 TO PA-NBR-STYLES-PROCESSED                       
W35681             WHEN SQLCODE = +100                                          
W35681                  SET PS-END-OF-STYLE-CSR TO TRUE                         
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6885-FETCH-ATTR-2-CSR   '                         
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'FETCH ON ATTR_2_CSR         '                     
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6885-FETCH-ATTR-2-CSR   '                                  
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'FETCH CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
W35681******************************************************************        
W35681*  CLOSE THE ATTR_2_CSR     CURSOR                                        
W35681******************************************************************        
W35681 6886-CLOSE-ATTR-2-CSR.                                                   
W35681                                                                          
W35681     PERFORM  WITH TEST AFTER                                             
W35681       VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
W35681         UNTIL SQLCODE = +0                                               
W35681            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
W35681                                                                          
W35681         EXEC SQL                                                         
W35681             CLOSE ATTR_2_CSR                                             
W35681         END-EXEC                                                         
W35681                                                                          
W35681         EVALUATE TRUE                                                    
W35681             WHEN SQLCODE = 0                                             
W35681             WHEN SQLCODE = -911                                          
W35681             WHEN SQLCODE = -904                                          
W35681                  CONTINUE                                                
W35681             WHEN SQLWARN NOT = SPACES                                    
W35681             WHEN SQLCODE NOT = ZERO                                      
W35681                  MOVE '6886-CLOSE-ATTR-2-CSR      '                      
W35681                        TO PV-PARAGRAPH-NAME                              
W35681                  MOVE 'CLOSE ON ATTR_2_CSR CURSOR'                       
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681                  PERFORM 9999-SQL-ABEND                                  
W35681         END-EVALUATE                                                     
W35681     END-PERFORM.                                                         
W35681                                                                          
W35681     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
W35681         MOVE '6886-CLOSE-ATTR-2-CSR      '                               
W35681                        TO PV-PARAGRAPH-NAME                              
W35681         MOVE 'CLOSE CURSOR RETRIES EXCEEDED'                             
W35681                        TO PV-DB2-OPERATION-ATTEMPTED                     
W35681         PERFORM 9999-SQL-ABEND                                           
W35681     END-IF.                                                              
W35681                                                                          
W35681                                                                          
      ******************************************************************        
      * 7300-GET-COMMIT-TIMESTAMP.                                     *        
      * PROCESSES: GET THE COMMIT TIMESTAMP FROM THE CHECKPOINT        *        
      *            CONTROL TABLE                                       *        
      ******************************************************************        
       7300-GET-COMMIT-TIMESTAMP.                                               
                                                                                
           PERFORM  WITH TEST AFTER                                             
             VARYING PV-RETRY-COUNT FROM 1 BY 1                                 
               UNTIL SQLCODE = +0                                               
                  OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                    
                                                                                
               EXEC SQL                                                         
                 SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)           
                       ,CKPT_FRQNCY_QTY                                         
                   INTO :PV-COMMIT-TIMESTAMP                                    
                       ,:TCKRSTCNTL-CKPT-FRQNCY-QTY                             
                   FROM TCKRSTCNTL                                              
                  WHERE JOB_NAME  = :PC-JOB-NAME                                
                    AND PLAN_NAME = :PC-PROGRAM-NAME                            
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        CONTINUE                                                
                   WHEN SQLCODE = -911                                          
                   WHEN SQLCODE = -904                                          
                        ADD 1        TO PV-RETRY-COUNT                          
                   WHEN OTHER                                                   
                        MOVE '7300-GET-COMMIT-TIMESTAMP'                        
                                     TO PV-PARAGRAPH-NAME                       
                        MOVE 'SELECT ON TCKRSTCNTL'                             
                                     TO PV-DB2-OPERATION-ATTEMPTED              
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                          
               MOVE '7300-GET-COMMIT-TIMESTAMP'                                 
                                     TO PV-PARAGRAPH-NAME                       
               MOVE 'SELECT ON TCKRSTCNTL'                                      
                                     TO PV-DB2-OPERATION-ATTEMPTED              
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
      *                                                                         
      *                                                                         
      ******************************************************************        
      * 7600-SET-CURRENT-TIMESTAMP.                                    *        
      * PROCESSES: GET THE CURRENT TIMESTAMP FROM DB2.                 *        
      ******************************************************************        
       7600-SET-CURRENT-TIMESTAMP.                                              
                                                                                
           EXEC SQL                                                             
                SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP                   
           END-EXEC.                                                            
                                                                                
           IF SQLCODE = 0                                                       
               CONTINUE                                                         
           ELSE                                                                 
               MOVE '7600-SET-CURRENT-TIMESTAMP' TO PV-PARAGRAPH-NAME           
               MOVE 'SET CURRENT TIMESTAMP'                                     
                     TO PV-DB2-OPERATION-ATTEMPTED                              
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
      *                                                                         
      *                                                                         
      ******************************************************************        
      * 7700-COMMIT-PROCESSING.                                        *        
      * PROCESSES: CHECK IF WE NEED TO TAKE A COMMIT.                  *        
      *          PREPARE CHECKPOINT RECORD FOR UPDATE OF WORK_STRG_DESC*        
      ******************************************************************        
       7700-COMMIT-PROCESSING.                                                  
           MOVE '7700-COMMIT-PROCESSING'      TO PV-PARAGRAPH-NAME.             
                                                                                
           PERFORM 7600-SET-CURRENT-TIMESTAMP.                                  
                                                                                
      * PREPARE COMMIT RECORD FOR UPDATE                                        
           IF PV-CURRENT-TIMESTAMP > PV-COMMIT-TIMESTAMP                        
               PERFORM 7800-COMMIT-CHANGES                                      
               PERFORM 7300-GET-COMMIT-TIMESTAMP                                
           END-IF.                                                              
      *                                                                         
      *                                                                         
      ******************************************************************        
      * 7800-COMMIT-CHANGES.                                                    
      * PROCESSES: PERFORM UPDATE OF CHECKPOINT INFORMATION TABLE.              
      *            TAKE A COMMIT.                                               
      *  ==> PERFORMED FROM: 7700-COMMIT-PROCESSING, 9000-EOJ-ROUTINE           
      ******************************************************************        
       7800-COMMIT-CHANGES.                                                     
                                                                                
           EXEC SQL                                                             
               COMMIT                                                           
           END-EXEC.                                                            
                                                                                
           IF SQLCODE = 0                                                       
               ADD +1 TO PA-NBR-COMMITS-TAKEN                                   
           ELSE                                                                 
               MOVE '7800-COMMIT-CHANGES' TO PV-PARAGRAPH-NAME                  
               MOVE 'COMMIT' TO PV-DB2-OPERATION-ATTEMPTED                      
               PERFORM 9999-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  PERFORMS END-OF-JOB PROCESSING                                         
      ******************************************************************        
                                                                                
       9000-EOJ-ROUTINE.                                                        
                                                                                
           PERFORM 5020-CLOSE-CHARTC-CHG-CSR.                                   
           PERFORM 7800-COMMIT-CHANGES.                                         
                                                                                
           CLOSE CHARACTR-CHGS-BKUP-FILE.                                       
                                                                                
           PERFORM 9300-DISPLAY-TOTALS.                                         
                                                                                
                                                                                
      ******************************************************************        
      *  DISPLAYS PROGRAM TOTALS                                                
      ******************************************************************        
                                                                                
       9300-DISPLAY-TOTALS.                                                     
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '*********************************************'.             
           DISPLAY '***** TOTAL COUNTS FOR PROGRAM IMKUP068 *****'.             
           DISPLAY '*********************************************'.             
                                                                                
           MOVE PA-CHARTC-CHGS-WRITE-COUNT   TO PV-DISPLAY-COUNT.               
           DISPLAY 'CHARACTERISTIC CHANGES PROCESSED = '                        
                                                     PV-DISPLAY-COUNT.          
                                                                                
           MOVE PA-NBR-CHARTC-CHG-DELETES    TO PV-DISPLAY-COUNT.               
           DISPLAY 'CHARACTERISTIC CHANGES DELETED   = '                        
                                                     PV-DISPLAY-COUNT.          
                                                                                
           MOVE PA-NBR-BUS-RULES-PROCESSED   TO PV-DISPLAY-COUNT.               
           DISPLAY 'TOT NBR OF BUS RULES PROCESSED   = '                        
                                                     PV-DISPLAY-COUNT.          
                                                                                
           MOVE PA-NBR-STYLES-PROCESSED      TO PV-DISPLAY-COUNT.               
           DISPLAY 'TOT NBR OF STYLES PROCESSED      = '                        
                                                     PV-DISPLAY-COUNT.          
                                                                                
           MOVE PA-NBR-TMDARVS-UPDATES       TO PV-DISPLAY-COUNT.               
           DISPLAY 'TOT NBR OF UPDATES TO TMDARVS    = '                        
                                                     PV-DISPLAY-COUNT.          
                                                                                
           MOVE PA-NBR-COMMITS-TAKEN         TO PV-DISPLAY-COUNT.               
           DISPLAY 'TOT NBR OF COMMITS               = '                        
                                                     PV-DISPLAY-COUNT.          
           DISPLAY SPACES.                                                      
                                                                                
      ******************************************************************        
      *  PERFORMS ABEND PROCESSING FOR SQL ERRORS.                              
      ******************************************************************        
                                                                                
       9999-SQL-ABEND.                                                          
                                                                                
           PERFORM 9300-DISPLAY-TOTALS.                                         
           DISPLAY ' '.                                                         
           DISPLAY '9999-SQL-ABEND'                                             
           DISPLAY '** ABEND     **'.                                           
           DISPLAY '** PROGRAM   ** = IMKUP068'.                                
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.             
           MOVE SQLCODE TO PV-DISPLAY-SQLCODE.                                  
           DISPLAY '** SQLCODE   ** = ' PV-DISPLAY-SQLCODE.                     
                                                                                
      ******************************************************************        
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
      * MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
      * 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
      * FORMAT.                                                                 
      ******************************************************************        
           COPY DPPD004.                                                        
                                                                                
           MOVE +4013 TO ABEND-CODE.                                            
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
                                                                                
